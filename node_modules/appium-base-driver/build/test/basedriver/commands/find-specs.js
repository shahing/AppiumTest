"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _chai = _interopRequireDefault(require("chai"));

var _path = _interopRequireDefault(require("path"));

var _chaiAsPromised = _interopRequireDefault(require("chai-as-promised"));

var _sinon = _interopRequireDefault(require("sinon"));

var _ = require("../../..");

var _find = require("../../../lib/basedriver/commands/find");

var _appiumSupport = require("appium-support");

_chai.default.should();

_chai.default.use(_chaiAsPromised.default);

class TestDriver extends _.BaseDriver {
  async getWindowSize() {}

  async getScreenshot() {}

}

const CUSTOM_FIND_MODULE = _path.default.resolve(__dirname, '..', '..', '..', '..', 'test', 'basedriver', 'fixtures', 'custom-element-finder');

const BAD_CUSTOM_FIND_MODULE = _path.default.resolve(__dirname, '..', '..', '..', '..', 'test', 'basedriver', 'fixtures', 'custom-element-finder-bad');

const TINY_PNG = 'iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0NDMDM4MDM4N0U2MTFFOEEzMzhGMTRFNUUwNzIwNUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0NDMDM4MDQ4N0U2MTFFOEEzMzhGMTRFNUUwNzIwNUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3Q0MwMzgwMTg3RTYxMUU4QTMzOEYxNEU1RTA3MjA1QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3Q0MwMzgwMjg3RTYxMUU4QTMzOEYxNEU1RTA3MjA1QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpdvJjQAAAAlSURBVHjaJInBEQAACIKw/Xe2Ul5wYBtwmJqkk4+zfvUQVoABAEg0EfrZwc0hAAAAAElFTkSuQmCC';
const TINY_PNG_DIMS = [4, 4];
describe('finding elements by image', function () {
  describe('findElement', function () {
    it('should use a different special method to find element by image', async function () {
      const d = new TestDriver();

      _sinon.default.stub(d, 'findByImage').returns(true);

      _sinon.default.stub(d, 'findElOrElsWithProcessing').returns(false);

      await d.findElement(_find.IMAGE_STRATEGY, 'foo').should.eventually.be.true;
      await d.findElements(_find.IMAGE_STRATEGY, 'foo').should.eventually.be.true;
    });
    it('should not be able to find image element from any other element', async function () {
      const d = new TestDriver();
      await d.findElementFromElement(_find.IMAGE_STRATEGY, 'foo', 'elId').should.eventually.be.rejectedWith(/Locator Strategy.+is not supported/);
      await d.findElementsFromElement(_find.IMAGE_STRATEGY, 'foo', 'elId').should.eventually.be.rejectedWith(/Locator Strategy.+is not supported/);
    });
  });
  describe('findByImage', function () {
    const rect = {
      x: 10,
      y: 20,
      width: 30,
      height: 40
    };
    const size = {
      width: 100,
      height: 200
    };
    const screenshot = 'iVBORfoo';
    const template = 'iVBORbar';

    function basicStub(driver) {
      const sizeStub = _sinon.default.stub(driver, 'getWindowSize').returns(size);

      const screenStub = _sinon.default.stub(driver, 'getScreenshotForImageFind').returns(screenshot);

      const compareStub = _sinon.default.stub(driver, 'compareImages').returns({
        rect
      });

      return {
        sizeStub,
        screenStub,
        compareStub
      };
    }

    function basicImgElVerify(imgElProto, driver) {
      const imgElId = imgElProto.ELEMENT;
      driver._imgElCache.has(imgElId).should.be.true;

      const imgEl = driver._imgElCache.get(imgElId);

      (imgEl instanceof _.ImageElement).should.be.true;
      imgEl.rect.should.eql(rect);
      return imgEl;
    }

    it('should find an image element happypath', async function () {
      const d = new TestDriver();
      basicStub(d);
      const imgElProto = await d.findByImage(template, {
        multiple: false
      });
      basicImgElVerify(imgElProto, d);
    });
    it('should find image elements happypath', async function () {
      const d = new TestDriver();
      basicStub(d);
      const els = await d.findByImage(template, {
        multiple: true
      });
      els.should.have.length(1);
      basicImgElVerify(els[0], d);
    });
    it('should fail if driver does not support getWindowSize', async function () {
      const d = new _.BaseDriver();
      await d.findByImage(template, {
        multiple: false
      }).should.eventually.be.rejectedWith(/driver does not support/);
    });
    it('should fix template size if requested', async function () {
      const d = new TestDriver();
      const newTemplate = 'iVBORbaz';
      const {
        compareStub
      } = basicStub(d);
      await d.settings.update({
        fixImageTemplateSize: true
      });

      _sinon.default.stub(d, 'ensureTemplateSize').returns(newTemplate);

      const imgElProto = await d.findByImage(template, {
        multiple: false
      });
      const imgEl = basicImgElVerify(imgElProto, d);
      imgEl.template.should.eql(newTemplate);
      compareStub.args[0][2].should.eql(newTemplate);
    });
    it('should throw an error if template match fails', async function () {
      const d = new TestDriver();
      const {
        compareStub
      } = basicStub(d);
      compareStub.throws(new Error('Cannot find any occurrences'));
      await d.findByImage(template, {
        multiple: false
      }).should.eventually.be.rejectedWith(/element could not be located/);
    });
    it('should return empty array for multiple elements if template match fails', async function () {
      const d = new TestDriver();
      const {
        compareStub
      } = basicStub(d);
      compareStub.throws(new Error('Cannot find any occurrences'));
      await d.findByImage(template, {
        multiple: true
      }).should.eventually.eql([]);
    });
    it('should respect implicit wait', async function () {
      const d = new TestDriver();
      d.setImplicitWait(10);
      const {
        compareStub
      } = basicStub(d);
      compareStub.onCall(0).throws(new Error('Cannot find any occurrences'));
      const imgElProto = await d.findByImage(template, {
        multiple: false
      });
      basicImgElVerify(imgElProto, d);
      compareStub.callCount.should.eql(2);
    });
    it('should not add element to cache and return it directly when checking staleness', async function () {
      const d = new TestDriver();
      basicStub(d);
      const imgEl = await d.findByImage(template, {
        multiple: false,
        shouldCheckStaleness: true
      });
      (imgEl instanceof _.ImageElement).should.be.true;
      d._imgElCache.has(imgEl.id).should.be.false;
      imgEl.rect.should.eql(rect);
    });
  });
  describe('ensureTemplateSize', function () {
    it('should not resize the template if it is smaller than the screen', async function () {
      const screen = TINY_PNG_DIMS.map(n => n * 2);
      const d = new TestDriver();
      await d.ensureTemplateSize(TINY_PNG, ...screen).should.eventually.eql(TINY_PNG);
    });
    it('should not resize the template if it is the same size as the screen', async function () {
      const d = new TestDriver();
      await d.ensureTemplateSize(TINY_PNG, ...TINY_PNG_DIMS).should.eventually.eql(TINY_PNG);
    });
    it('should resize the template if it is bigger than the screen', async function () {
      const d = new TestDriver();
      const screen = TINY_PNG_DIMS.map(n => n / 2);
      const newTemplate = await d.ensureTemplateSize(TINY_PNG, ...screen);
      newTemplate.should.not.eql(TINY_PNG);
      newTemplate.length.should.be.below(TINY_PNG.length);
    });
  });
  describe('getScreenshotForImageFind', function () {
    it('should fail if driver does not support getScreenshot', async function () {
      const d = new _.BaseDriver();
      await d.getScreenshotForImageFind().should.eventually.be.rejectedWith(/driver does not support/);
    });
    it('should not adjust or verify screenshot if asked not to by settings', async function () {
      const d = new TestDriver();

      _sinon.default.stub(d, 'getScreenshot').returns(TINY_PNG);

      d.settings.update({
        fixImageFindScreenshotDims: false
      });
      const screen = TINY_PNG_DIMS.map(n => n + 1);
      await d.getScreenshotForImageFind(...screen).should.eventually.eql(TINY_PNG);
    });
    it('should return screenshot without adjustment if it matches screen size', async function () {
      const d = new TestDriver();

      _sinon.default.stub(d, 'getScreenshot').returns(TINY_PNG);

      await d.getScreenshotForImageFind(...TINY_PNG_DIMS).should.eventually.eql(TINY_PNG);
    });
    it('should return scaled screenshot with same aspect ratio if matching screen aspect ratio', async function () {
      const d = new TestDriver();

      _sinon.default.stub(d, 'getScreenshot').returns(TINY_PNG);

      const screen = TINY_PNG_DIMS.map(n => n * 1.5);
      const newScreenshot = await d.getScreenshotForImageFind(...screen);
      newScreenshot.should.not.eql(TINY_PNG);
      const screenshotObj = await _appiumSupport.imageUtil.getJimpImage(newScreenshot);
      screenshotObj.bitmap.width.should.eql(screen[0]);
      screenshotObj.bitmap.height.should.eql(screen[1]);
    });
    it('should return scaled screenshot with different aspect ratio if not matching screen aspect ratio', async function () {
      const d = new TestDriver();

      _sinon.default.stub(d, 'getScreenshot').returns(TINY_PNG);

      let screen = [TINY_PNG_DIMS[0] * 2, TINY_PNG_DIMS[1] * 3];
      let newScreenshot = await d.getScreenshotForImageFind(...screen);
      newScreenshot.should.not.eql(TINY_PNG);
      let screenshotObj = await _appiumSupport.imageUtil.getJimpImage(newScreenshot);
      screenshotObj.bitmap.width.should.eql(screen[0]);
      screenshotObj.bitmap.height.should.eql(screen[1]);
      screen = [TINY_PNG_DIMS[0] * 3, TINY_PNG_DIMS[1] * 2];
      newScreenshot = await d.getScreenshotForImageFind(...screen);
      newScreenshot.should.not.eql(TINY_PNG);
      screenshotObj = await _appiumSupport.imageUtil.getJimpImage(newScreenshot);
      screenshotObj.bitmap.width.should.eql(screen[0]);
      screenshotObj.bitmap.height.should.eql(screen[1]);
    });
  });
});
describe('custom element finding plugins', function () {
  it('should find a single element using a custom finder', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.eql('bar');
  });
  it('should not require selector prefix if only one find plugin is registered', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'foo').should.eventually.eql('bar');
  });
  it('should find multiple elements using a custom finder', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElements(_find.CUSTOM_STRATEGY, 'f:foos').should.eventually.eql(['baz1', 'baz2']);
  });
  it('should give a hint to the plugin about whether multiple are requested', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foos').should.eventually.eql('bar1');
  });
  it('should be able to use multiple find modules', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE,
      g: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.eql('bar');
    await d.findElement(_find.CUSTOM_STRATEGY, 'g:foo').should.eventually.eql('bar');
  });
  it('should throw an error if customFindModules is not set', async function () {
    const d = new _.BaseDriver();
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.be.rejectedWith(/customFindModules/);
  });
  it('should throw an error if customFindModules is the wrong shape', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = CUSTOM_FIND_MODULE;
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.be.rejectedWith(/customFindModules/);
  });
  it('should throw an error if customFindModules is size > 1 and no selector prefix is used', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE,
      g: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'foo').should.eventually.be.rejectedWith(/multiple element finding/i);
  });
  it('should throw an error in attempt to use unregistered plugin', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE,
      g: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'z:foo').should.eventually.be.rejectedWith(/was not registered/);
  });
  it('should throw an error if plugin cannot be loaded', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: './foo.js'
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.be.rejectedWith(/could not load/i);
  });
  it('should throw an error if plugin is not the right shape', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: BAD_CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:foo').should.eventually.be.rejectedWith(/constructed correctly/i);
  });
  it('should pass on an error thrown by the finder itself', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:error').should.eventually.be.rejectedWith(/plugin error/i);
  });
  it('should throw no such element error if element not found', async function () {
    const d = new _.BaseDriver();
    d.opts.customFindModules = {
      f: CUSTOM_FIND_MODULE
    };
    await d.findElement(_find.CUSTOM_STRATEGY, 'f:nope').should.eventually.be.rejectedWith(/could not be located/);
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvYmFzZWRyaXZlci9jb21tYW5kcy9maW5kLXNwZWNzLmpzIl0sIm5hbWVzIjpbImNoYWkiLCJzaG91bGQiLCJ1c2UiLCJjaGFpQXNQcm9taXNlZCIsIlRlc3REcml2ZXIiLCJCYXNlRHJpdmVyIiwiZ2V0V2luZG93U2l6ZSIsImdldFNjcmVlbnNob3QiLCJDVVNUT01fRklORF9NT0RVTEUiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkJBRF9DVVNUT01fRklORF9NT0RVTEUiLCJUSU5ZX1BORyIsIlRJTllfUE5HX0RJTVMiLCJkZXNjcmliZSIsIml0IiwiZCIsInNpbm9uIiwic3R1YiIsInJldHVybnMiLCJmaW5kRWxlbWVudCIsIklNQUdFX1NUUkFURUdZIiwiZXZlbnR1YWxseSIsImJlIiwidHJ1ZSIsImZpbmRFbGVtZW50cyIsImZpbmRFbGVtZW50RnJvbUVsZW1lbnQiLCJyZWplY3RlZFdpdGgiLCJmaW5kRWxlbWVudHNGcm9tRWxlbWVudCIsInJlY3QiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0Iiwic2l6ZSIsInNjcmVlbnNob3QiLCJ0ZW1wbGF0ZSIsImJhc2ljU3R1YiIsImRyaXZlciIsInNpemVTdHViIiwic2NyZWVuU3R1YiIsImNvbXBhcmVTdHViIiwiYmFzaWNJbWdFbFZlcmlmeSIsImltZ0VsUHJvdG8iLCJpbWdFbElkIiwiRUxFTUVOVCIsIl9pbWdFbENhY2hlIiwiaGFzIiwiaW1nRWwiLCJnZXQiLCJJbWFnZUVsZW1lbnQiLCJlcWwiLCJmaW5kQnlJbWFnZSIsIm11bHRpcGxlIiwiZWxzIiwiaGF2ZSIsImxlbmd0aCIsIm5ld1RlbXBsYXRlIiwic2V0dGluZ3MiLCJ1cGRhdGUiLCJmaXhJbWFnZVRlbXBsYXRlU2l6ZSIsImFyZ3MiLCJ0aHJvd3MiLCJFcnJvciIsInNldEltcGxpY2l0V2FpdCIsIm9uQ2FsbCIsImNhbGxDb3VudCIsInNob3VsZENoZWNrU3RhbGVuZXNzIiwiaWQiLCJmYWxzZSIsInNjcmVlbiIsIm1hcCIsIm4iLCJlbnN1cmVUZW1wbGF0ZVNpemUiLCJub3QiLCJiZWxvdyIsImdldFNjcmVlbnNob3RGb3JJbWFnZUZpbmQiLCJmaXhJbWFnZUZpbmRTY3JlZW5zaG90RGltcyIsIm5ld1NjcmVlbnNob3QiLCJzY3JlZW5zaG90T2JqIiwiaW1hZ2VVdGlsIiwiZ2V0SmltcEltYWdlIiwiYml0bWFwIiwib3B0cyIsImN1c3RvbUZpbmRNb2R1bGVzIiwiZiIsIkNVU1RPTV9TVFJBVEVHWSIsImciXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBQSxjQUFLQyxNQUFMOztBQUNBRCxjQUFLRSxHQUFMLENBQVNDLHVCQUFUOztBQUVBLE1BQU1DLFVBQU4sU0FBeUJDLFlBQXpCLENBQW9DO0FBQ2xDLFFBQU1DLGFBQU4sR0FBdUIsQ0FBRTs7QUFDekIsUUFBTUMsYUFBTixHQUF1QixDQUFFOztBQUZTOztBQUtwQyxNQUFNQyxrQkFBa0IsR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLElBQXhCLEVBQThCLElBQTlCLEVBQW9DLElBQXBDLEVBQTBDLElBQTFDLEVBQ3pCLE1BRHlCLEVBQ2pCLFlBRGlCLEVBQ0gsVUFERyxFQUNTLHVCQURULENBQTNCOztBQUVBLE1BQU1DLHNCQUFzQixHQUFHSCxjQUFLQyxPQUFMLENBQWFDLFNBQWIsRUFBd0IsSUFBeEIsRUFBOEIsSUFBOUIsRUFBb0MsSUFBcEMsRUFBMEMsSUFBMUMsRUFDN0IsTUFENkIsRUFDckIsWUFEcUIsRUFDUCxVQURPLEVBQ0ssMkJBREwsQ0FBL0I7O0FBR0EsTUFBTUUsUUFBUSxHQUFHLHN2Q0FBakI7QUFDQSxNQUFNQyxhQUFhLEdBQUcsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUF0QjtBQUVBQyxRQUFRLENBQUMsMkJBQUQsRUFBOEIsWUFBWTtBQUNoREEsRUFBQUEsUUFBUSxDQUFDLGFBQUQsRUFBZ0IsWUFBWTtBQUNsQ0MsSUFBQUEsRUFBRSxDQUFDLGdFQUFELEVB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LENBQTREQyxFQUE1RCxDQUErREksWUFBL0QsQ0FBNEUsZUFBNUUsQ0FBTjtBQUNELEdBSkMsQ0FBRjtBQUtBWixFQUFBQSxFQUFFLENBQUMseURBQUQsRUFBNEQsa0JBQWtCO0FBQzlFLFVBQU1DLENBQUMsR0FBRyxJQUFJWixZQUFKLEVBQVY7QUFDQVksSUFBQUEsQ0FBQyxDQUFDbUUsSUFBRixDQUFPQyxpQkFBUCxHQUEyQjtBQUFDQyxNQUFBQSxDQUFDLEVBQUU5RTtBQUFKLEtBQTNCO0FBQ0EsVUFBTVMsQ0FBQyxDQUFDSSxXQUFGLENBQWNrRSxxQkFBZCxFQUErQixRQUEvQixFQUF5Q3RGLE1BQXpDLENBQWdEc0IsVUFBaEQsQ0FBMkRDLEVBQTNELENBQThESSxZQUE5RCxDQUEyRSxzQkFBM0UsQ0FBTjtBQUNELEdBSkMsQ0FBRjtBQUtELENBckVPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IHNpbm9uIGZyb20gJ3Npbm9uJztcbmltcG9ydCB7IEJhc2VEcml2ZXIsIEltYWdlRWxlbWVudCB9IGZyb20gJy4uLy4uLy4uJztcbmltcG9ydCB7IElNQUdFX1NUUkFURUdZLCBDVVNUT01fU1RSQVRFR1kgfSBmcm9tICcuLi8uLi8uLi9saWIvYmFzZWRyaXZlci9jb21tYW5kcy9maW5kJztcbmltcG9ydCB7IGltYWdlVXRpbCB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcblxuXG5jaGFpLnNob3VsZCgpO1xuY2hhaS51c2UoY2hhaUFzUHJvbWlzZWQpO1xuXG5jbGFzcyBUZXN0RHJpdmVyIGV4dGVuZHMgQmFzZURyaXZlciB7XG4gIGFzeW5jIGdldFdpbmRvd1NpemUgKCkge31cbiAgYXN5bmMgZ2V0U2NyZWVuc2hvdCAoKSB7fVxufVxuXG5jb25zdCBDVVNUT01fRklORF9NT0RVTEUgPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4nLCAnLi4nLCAnLi4nLCAnLi4nLFxuICAndGVzdCcsICdiYXNlZHJpdmVyJywgJ2ZpeHR1cmVzJywgJ2N1c3RvbS1lbGVtZW50LWZpbmRlcicpO1xuY29uc3QgQkFEX0NVU1RPTV9GSU5EX01PRFVMRSA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLicsICcuLicsICcuLicsICcuLicsXG4gICd0ZXN0JywgJ2Jhc2Vkcml2ZXInLCAnZml4dHVyZXMnLCAnY3VzdG9tLWVsZW1lbnQtZmluZGVyLWJhZCcpO1xuXG5jb25zdCBUSU5ZX1BORyA9ICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQVFBQUFBRUNBSUFBQUFta3drcEFBQUFHWFJGV0hSVGIyWjBkMkZ5WlFCQlpHOWlaU0JKYldGblpWSmxZV1I1Y2NsbFBBQUFBeWhwVkZoMFdFMU1PbU52YlM1aFpHOWlaUzU0YlhBQUFBQUFBRHcvZUhCaFkydGxkQ0JpWldkcGJqMGk3N3UvSWlCcFpEMGlWelZOTUUxd1EyVm9hVWg2Y21WVGVrNVVZM3ByWXpsa0lqOCtJRHg0T25odGNHMWxkR0VnZUcxc2JuTTZlRDBpWVdSdlltVTZibk02YldWMFlTOGlJSGc2ZUcxd2RHczlJa0ZrYjJKbElGaE5VQ0JEYjNKbElEVXVOaTFqTVRRd0lEYzVMakUyTURRMU1Td2dNakF4Tnk4d05TOHdOaTB3TVRvd09Eb3lNU0FnSUNBZ0lDQWdJajRnUEhKa1pqcFNSRVlnZUcxc2JuTTZjbVJtUFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eE9UazVMekF5THpJeUxYSmtaaTF6ZVc1MFlYZ3Ribk1qSWo0Z1BISmtaanBFWlhOamNtbHdkR2x2YmlCeVpHWTZZV0p2ZFhROUlpSWdlRzFzYm5NNmVHMXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNoaGNDOHhMakF2SWlCNGJXeHVjenA0YlhCTlRUMGlhSFIwY0RvdkwyNXpMbUZrYjJKbExtTnZiUzk0WVhBdk1TNHdMMjF0THlJZ2VHMXNibk02YzNSU1pXWTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzl6Vkhsd1pTOVNaWE52ZFhKalpWSmxaaU1pSUhodGNEcERjbVZoZEc5eVZHOXZiRDBpUVdSdlltVWdVR2h2ZEc5emFHOXdJRU5ESURJd01UZ2dLRTFoWTJsdWRHOXphQ2tpSUhodGNFMU5Pa2x1YzNSaGJtTmxTVVE5SW5odGNDNXBhV1E2TjBORE1ETTRNRE00TjBVMk1URkZPRUV6TXpoR01UUkZOVVV3TnpJd05VSWlJSGh0Y0UxTk9rUnZZM1Z0Wlc1MFNVUTlJbmh0Y0M1a2FXUTZOME5ETURNNE1EUTROMFUyTVRGRk9FRXpNemhHTVRSRk5VVXdOekl3TlVJaVBpQThlRzF3VFUwNlJHVnlhWFpsWkVaeWIyMGdjM1JTWldZNmFXNXpkR0Z1WTJWSlJEMGllRzF3TG1scFpEbzNRME13TXpnd01UZzNSVFl4TVVVNFFUTXpPRVl4TkVVMVJUQTNNakExUWlJZ2MzUlNaV1k2Wkc5amRXMWxiblJKUkQwaWVHMXdMbVJwWkRvM1EwTXdNemd3TWpnM1JUWXhNVVU0UVRNek9FWXhORVUxUlRBM01qQTFRaUl2UGlBOEwzSmtaanBFWlhOamNtbHdkR2x2Ymo0Z1BDOXlaR1k2VWtSR1BpQThMM2c2ZUcxd2JXVjBZVDRnUEQ5NGNHRmphMlYwSUdWdVpEMGljaUkvUHBkdkpqUUFBQUFsU1VSQlZIamFKSW5CRVFBQUNJS3cvWGUyVWw1d1lCdHdtSnFrazQremZ2VVFWb0FCQUVnMEVmclp3YzBoQUFBQUFFbEZUa1N1UW1DQyc7XG5jb25zdCBUSU5ZX1BOR19ESU1TID0gWzQsIDRdO1xuXG5kZXNjcmliZSgnZmluZGluZyBlbGVtZW50cyBieSBpbWFnZScsIGZ1bmN0aW9uICgpIHtcbiAgZGVzY3JpYmUoJ2ZpbmRFbGVtZW50JywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgdXNlIGEgZGlmZmVyZW50IHNwZWNpYWwgbWV0aG9kIHRvIGZpbmQgZWxlbWVudCBieSBpbWFnZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgc2lub24uc3R1YihkLCAnZmluZEJ5SW1hZ2UnKS5yZXR1cm5zKHRydWUpO1xuICAgICAgc2lub24uc3R1YihkLCAnZmluZEVsT3JFbHNXaXRoUHJvY2Vzc2luZycpLnJldHVybnMoZmFsc2UpO1xuICAgICAgYXdhaXQgZC5maW5kRWxlbWVudChJTUFHRV9TVFJBVEVHWSwgJ2ZvbycpLnNob3VsZC5ldmVudHVhbGx5LmJlLnRydWU7XG4gICAgICBhd2FpdCBkLmZpbmRFbGVtZW50cyhJTUFHRV9TVFJBVEVHWSwgJ2ZvbycpLnNob3VsZC5ldmVudHVhbGx5LmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBub3QgYmUgYWJsZSB0byBmaW5kIGltYWdlIGVsZW1lbnQgZnJvbSBhbnkgb3RoZXIgZWxlbWVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgYXdhaXQgZC5maW5kRWxlbWVudEZyb21FbGVtZW50KElNQUdFX1NUUkFURUdZLCAnZm9vJywgJ2VsSWQnKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9Mb2NhdG9yIFN0cmF0ZWd5LitpcyBub3Qgc3VwcG9ydGVkLyk7XG4gICAgICBhd2FpdCBkLmZpbmRFbGVtZW50c0Zyb21FbGVtZW50KElNQUdFX1NUUkFURUdZLCAnZm9vJywgJ2VsSWQnKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9Mb2NhdG9yIFN0cmF0ZWd5LitpcyBub3Qgc3VwcG9ydGVkLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlJbWFnZScsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCByZWN0ID0ge3g6IDEwLCB5OiAyMCwgd2lkdGg6IDMwLCBoZWlnaHQ6IDQwfTtcbiAgICBjb25zdCBzaXplID0ge3dpZHRoOiAxMDAsIGhlaWdodDogMjAwfTtcbiAgICBjb25zdCBzY3JlZW5zaG90ID0gJ2lWQk9SZm9vJztcbiAgICBjb25zdCB0ZW1wbGF0ZSA9ICdpVkJPUmJhcic7XG5cbiAgICBmdW5jdGlvbiBiYXNpY1N0dWIgKGRyaXZlcikge1xuICAgICAgY29uc3Qgc2l6ZVN0dWIgPSBzaW5vbi5zdHViKGRyaXZlciwgJ2dldFdpbmRvd1NpemUnKS5yZXR1cm5zKHNpemUpO1xuICAgICAgY29uc3Qgc2NyZWVuU3R1YiA9IHNpbm9uLnN0dWIoZHJpdmVyLCAnZ2V0U2NyZWVuc2hvdEZvckltYWdlRmluZCcpLnJldHVybnMoc2NyZWVuc2hvdCk7XG4gICAgICBjb25zdCBjb21wYXJlU3R1YiA9IHNpbm9uLnN0dWIoZHJpdmVyLCAnY29tcGFyZUltYWdlcycpLnJldHVybnMoe3JlY3R9KTtcbiAgICAgIHJldHVybiB7c2l6ZVN0dWIsIHNjcmVlblN0dWIsIGNvbXBhcmVTdHVifTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBiYXNpY0ltZ0VsVmVyaWZ5IChpbWdFbFByb3RvLCBkcml2ZXIpIHtcbiAgICAgIGNvbnN0IGltZ0VsSWQgPSBpbWdFbFByb3RvLkVMRU1FTlQ7XG4gICAgICBkcml2ZXIuX2ltZ0VsQ2FjaGUuaGFzKGltZ0VsSWQpLnNob3VsZC5iZS50cnVlO1xuICAgICAgY29uc3QgaW1nRWwgPSBkcml2ZXIuX2ltZ0VsQ2FjaGUuZ2V0KGltZ0VsSWQpO1xuICAgICAgKGltZ0VsIGluc3RhbmNlb2YgSW1hZ2VFbGVtZW50KS5zaG91bGQuYmUudHJ1ZTtcbiAgICAgIGltZ0VsLnJlY3Quc2hvdWxkLmVxbChyZWN0KTtcbiAgICAgIHJldHVybiBpbWdFbDtcbiAgICB9XG5cbiAgICBpdCgnc2hvdWxkIGZpbmQgYW4gaW1hZ2UgZWxlbWVudCBoYXBweXBhdGgnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IFRlc3REcml2ZXIoKTtcbiAgICAgIGJhc2ljU3R1YihkKTtcbiAgICAgIGNvbnN0IGltZ0VsUHJvdG8gPSBhd2FpdCBkLmZpbmRCeUltYWdlKHRlbXBsYXRlLCB7bXVsdGlwbGU6IGZhbHNlfSk7XG4gICAgICBiYXNpY0ltZ0VsVmVyaWZ5KGltZ0VsUHJvdG8sIGQpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZmluZCBpbWFnZSBlbGVtZW50cyBoYXBweXBhdGgnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IFRlc3REcml2ZXIoKTtcbiAgICAgIGJhc2ljU3R1YihkKTtcbiAgICAgIGNvbnN0IGVscyA9IGF3YWl0IGQuZmluZEJ5SW1hZ2UodGVtcGxhdGUsIHttdWx0aXBsZTogdHJ1ZX0pO1xuICAgICAgZWxzLnNob3VsZC5oYXZlLmxlbmd0aCgxKTtcbiAgICAgIGJhc2ljSW1nRWxWZXJpZnkoZWxzWzBdLCBkKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGZhaWwgaWYgZHJpdmVyIGRvZXMgbm90IHN1cHBvcnQgZ2V0V2luZG93U2l6ZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgICAgYXdhaXQgZC5maW5kQnlJbWFnZSh0ZW1wbGF0ZSwge211bHRpcGxlOiBmYWxzZX0pXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL2RyaXZlciBkb2VzIG5vdCBzdXBwb3J0Lyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBmaXggdGVtcGxhdGUgc2l6ZSBpZiByZXF1ZXN0ZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IFRlc3REcml2ZXIoKTtcbiAgICAgIGNvbnN0IG5ld1RlbXBsYXRlID0gJ2lWQk9SYmF6JztcbiAgICAgIGNvbnN0IHtjb21wYXJlU3R1Yn0gPSBiYXNpY1N0dWIoZCk7XG4gICAgICBhd2FpdCBkLnNldHRpbmdzLnVwZGF0ZSh7Zml4SW1hZ2VUZW1wbGF0ZVNpemU6IHRydWV9KTtcbiAgICAgIHNpbm9uLnN0dWIoZCwgJ2Vuc3VyZVRlbXBsYXRlU2l6ZScpLnJldHVybnMobmV3VGVtcGxhdGUpO1xuICAgICAgY29uc3QgaW1nRWxQcm90byA9IGF3YWl0IGQuZmluZEJ5SW1hZ2UodGVtcGxhdGUsIHttdWx0aXBsZTogZmFsc2V9KTtcbiAgICAgIGNvbnN0IGltZ0VsID0gYmFzaWNJbWdFbFZlcmlmeShpbWdFbFByb3RvLCBkKTtcbiAgICAgIGltZ0VsLnRlbXBsYXRlLnNob3VsZC5lcWwobmV3VGVtcGxhdGUpO1xuICAgICAgY29tcGFyZVN0dWIuYXJnc1swXVsyXS5zaG91bGQuZXFsKG5ld1RlbXBsYXRlKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHRlbXBsYXRlIG1hdGNoIGZhaWxzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBUZXN0RHJpdmVyKCk7XG4gICAgICBjb25zdCB7Y29tcGFyZVN0dWJ9ID0gYmFzaWNTdHViKGQpO1xuICAgICAgY29tcGFyZVN0dWIudGhyb3dzKG5ldyBFcnJvcignQ2Fubm90IGZpbmQgYW55IG9jY3VycmVuY2VzJykpO1xuICAgICAgYXdhaXQgZC5maW5kQnlJbWFnZSh0ZW1wbGF0ZSwge211bHRpcGxlOiBmYWxzZX0pXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL2VsZW1lbnQgY291bGQgbm90IGJlIGxvY2F0ZWQvKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3IgbXVsdGlwbGUgZWxlbWVudHMgaWYgdGVtcGxhdGUgbWF0Y2ggZmFpbHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IFRlc3REcml2ZXIoKTtcbiAgICAgIGNvbnN0IHtjb21wYXJlU3R1Yn0gPSBiYXNpY1N0dWIoZCk7XG4gICAgICBjb21wYXJlU3R1Yi50aHJvd3MobmV3IEVycm9yKCdDYW5ub3QgZmluZCBhbnkgb2NjdXJyZW5jZXMnKSk7XG4gICAgICBhd2FpdCBkLmZpbmRCeUltYWdlKHRlbXBsYXRlLCB7bXVsdGlwbGU6IHRydWV9KS5zaG91bGQuZXZlbnR1YWxseS5lcWwoW10pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmVzcGVjdCBpbXBsaWNpdCB3YWl0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBUZXN0RHJpdmVyKCk7XG4gICAgICBkLnNldEltcGxpY2l0V2FpdCgxMCk7XG4gICAgICBjb25zdCB7Y29tcGFyZVN0dWJ9ID0gYmFzaWNTdHViKGQpO1xuICAgICAgY29tcGFyZVN0dWIub25DYWxsKDApLnRocm93cyhuZXcgRXJyb3IoJ0Nhbm5vdCBmaW5kIGFueSBvY2N1cnJlbmNlcycpKTtcbiAgICAgIGNvbnN0IGltZ0VsUHJvdG8gPSBhd2FpdCBkLmZpbmRCeUltYWdlKHRlbXBsYXRlLCB7bXVsdGlwbGU6IGZhbHNlfSk7XG4gICAgICBiYXNpY0ltZ0VsVmVyaWZ5KGltZ0VsUHJvdG8sIGQpO1xuICAgICAgY29tcGFyZVN0dWIuY2FsbENvdW50LnNob3VsZC5lcWwoMik7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBub3QgYWRkIGVsZW1lbnQgdG8gY2FjaGUgYW5kIHJldHVybiBpdCBkaXJlY3RseSB3aGVuIGNoZWNraW5nIHN0YWxlbmVzcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgYmFzaWNTdHViKGQpO1xuICAgICAgY29uc3QgaW1nRWwgPSBhd2FpdCBkLmZpbmRCeUltYWdlKHRlbXBsYXRlLCB7bXVsdGlwbGU6IGZhbHNlLCBzaG91bGRDaGVja1N0YWxlbmVzczogdHJ1ZX0pO1xuICAgICAgKGltZ0VsIGluc3RhbmNlb2YgSW1hZ2VFbGVtZW50KS5zaG91bGQuYmUudHJ1ZTtcbiAgICAgIGQuX2ltZ0VsQ2FjaGUuaGFzKGltZ0VsLmlkKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgICBpbWdFbC5yZWN0LnNob3VsZC5lcWwocmVjdCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlbnN1cmVUZW1wbGF0ZVNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBub3QgcmVzaXplIHRoZSB0ZW1wbGF0ZSBpZiBpdCBpcyBzbWFsbGVyIHRoYW4gdGhlIHNjcmVlbicsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IHNjcmVlbiA9IFRJTllfUE5HX0RJTVMubWFwKG4gPT4gbiAqIDIpO1xuICAgICAgY29uc3QgZCA9IG5ldyBUZXN0RHJpdmVyKCk7XG4gICAgICBhd2FpdCBkLmVuc3VyZVRlbXBsYXRlU2l6ZShUSU5ZX1BORywgLi4uc2NyZWVuKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXFsKFRJTllfUE5HKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIG5vdCByZXNpemUgdGhlIHRlbXBsYXRlIGlmIGl0IGlzIHRoZSBzYW1lIHNpemUgYXMgdGhlIHNjcmVlbicsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgYXdhaXQgZC5lbnN1cmVUZW1wbGF0ZVNpemUoVElOWV9QTkcsIC4uLlRJTllfUE5HX0RJTVMpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5lcWwoVElOWV9QTkcpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmVzaXplIHRoZSB0ZW1wbGF0ZSBpZiBpdCBpcyBiaWdnZXIgdGhhbiB0aGUgc2NyZWVuJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBUZXN0RHJpdmVyKCk7XG4gICAgICBjb25zdCBzY3JlZW4gPSBUSU5ZX1BOR19ESU1TLm1hcChuID0+IG4gLyAyKTtcbiAgICAgIGNvbnN0IG5ld1RlbXBsYXRlID0gYXdhaXQgZC5lbnN1cmVUZW1wbGF0ZVNpemUoVElOWV9QTkcsIC4uLnNjcmVlbik7XG4gICAgICBuZXdUZW1wbGF0ZS5zaG91bGQubm90LmVxbChUSU5ZX1BORyk7XG4gICAgICBuZXdUZW1wbGF0ZS5sZW5ndGguc2hvdWxkLmJlLmJlbG93KFRJTllfUE5HLmxlbmd0aCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRTY3JlZW5zaG90Rm9ySW1hZ2VGaW5kJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZmFpbCBpZiBkcml2ZXIgZG9lcyBub3Qgc3VwcG9ydCBnZXRTY3JlZW5zaG90JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgICBhd2FpdCBkLmdldFNjcmVlbnNob3RGb3JJbWFnZUZpbmQoKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9kcml2ZXIgZG9lcyBub3Qgc3VwcG9ydC8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgbm90IGFkanVzdCBvciB2ZXJpZnkgc2NyZWVuc2hvdCBpZiBhc2tlZCBub3QgdG8gYnkgc2V0dGluZ3MnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IFRlc3REcml2ZXIoKTtcbiAgICAgIHNpbm9uLnN0dWIoZCwgJ2dldFNjcmVlbnNob3QnKS5yZXR1cm5zKFRJTllfUE5HKTtcbiAgICAgIGQuc2V0dGluZ3MudXBkYXRlKHtmaXhJbWFnZUZpbmRTY3JlZW5zaG90RGltczogZmFsc2V9KTtcbiAgICAgIGNvbnN0IHNjcmVlbiA9IFRJTllfUE5HX0RJTVMubWFwKG4gPT4gbiArIDEpO1xuICAgICAgYXdhaXQgZC5nZXRTY3JlZW5zaG90Rm9ySW1hZ2VGaW5kKC4uLnNjcmVlbilcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmVxbChUSU5ZX1BORyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc2NyZWVuc2hvdCB3aXRob3V0IGFkanVzdG1lbnQgaWYgaXQgbWF0Y2hlcyBzY3JlZW4gc2l6ZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgc2lub24uc3R1YihkLCAnZ2V0U2NyZWVuc2hvdCcpLnJldHVybnMoVElOWV9QTkcpO1xuICAgICAgYXdhaXQgZC5nZXRTY3JlZW5zaG90Rm9ySW1hZ2VGaW5kKC4uLlRJTllfUE5HX0RJTVMpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5lcWwoVElOWV9QTkcpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHNjYWxlZCBzY3JlZW5zaG90IHdpdGggc2FtZSBhc3BlY3QgcmF0aW8gaWYgbWF0Y2hpbmcgc2NyZWVuIGFzcGVjdCByYXRpbycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgc2lub24uc3R1YihkLCAnZ2V0U2NyZWVuc2hvdCcpLnJldHVybnMoVElOWV9QTkcpO1xuICAgICAgY29uc3Qgc2NyZWVuID0gVElOWV9QTkdfRElNUy5tYXAobiA9PiBuICogMS41KTtcbiAgICAgIGNvbnN0IG5ld1NjcmVlbnNob3QgPSBhd2FpdCBkLmdldFNjcmVlbnNob3RGb3JJbWFnZUZpbmQoLi4uc2NyZWVuKTtcbiAgICAgIG5ld1NjcmVlbnNob3Quc2hvdWxkLm5vdC5lcWwoVElOWV9QTkcpO1xuICAgICAgY29uc3Qgc2NyZWVuc2hvdE9iaiA9IGF3YWl0IGltYWdlVXRpbC5nZXRKaW1wSW1hZ2UobmV3U2NyZWVuc2hvdCk7XG4gICAgICBzY3JlZW5zaG90T2JqLmJpdG1hcC53aWR0aC5zaG91bGQuZXFsKHNjcmVlblswXSk7XG4gICAgICBzY3JlZW5zaG90T2JqLmJpdG1hcC5oZWlnaHQuc2hvdWxkLmVxbChzY3JlZW5bMV0pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHNjYWxlZCBzY3JlZW5zaG90IHdpdGggZGlmZmVyZW50IGFzcGVjdCByYXRpbyBpZiBub3QgbWF0Y2hpbmcgc2NyZWVuIGFzcGVjdCByYXRpbycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgVGVzdERyaXZlcigpO1xuICAgICAgc2lub24uc3R1YihkLCAnZ2V0U2NyZWVuc2hvdCcpLnJldHVybnMoVElOWV9QTkcpO1xuXG4gICAgICAvLyB0cnkgZmlyc3Qgd2l0aCBwb3J0cmFpdCBzY3JlZW5cbiAgICAgIGxldCBzY3JlZW4gPSBbVElOWV9QTkdfRElNU1swXSAqIDIsIFRJTllfUE5HX0RJTVNbMV0gKiAzXTtcbiAgICAgIGxldCBuZXdTY3JlZW5zaG90ID0gYXdhaXQgZC5nZXRTY3JlZW5zaG90Rm9ySW1hZ2VGaW5kKC4uLnNjcmVlbik7XG4gICAgICBuZXdTY3JlZW5zaG90LnNob3VsZC5ub3QuZXFsKFRJTllfUE5HKTtcbiAgICAgIGxldCBzY3JlZW5zaG90T2JqID0gYXdhaXQgaW1hZ2VVdGlsLmdldEppbXBJbWFnZShuZXdTY3JlZW5zaG90KTtcbiAgICAgIHNjcmVlbnNob3RPYmouYml0bWFwLndpZHRoLnNob3VsZC5lcWwoc2NyZWVuWzBdKTtcbiAgICAgIHNjcmVlbnNob3RPYmouYml0bWFwLmhlaWdodC5zaG91bGQuZXFsKHNjcmVlblsxXSk7XG5cbiAgICAgIC8vIHRoZW4gd2l0aCBsYW5kc2NhcGUgc2NyZWVuXG4gICAgICBzY3JlZW4gPSBbVElOWV9QTkdfRElNU1swXSAqIDMsIFRJTllfUE5HX0RJTVNbMV0gKiAyXTtcbiAgICAgIG5ld1NjcmVlbnNob3QgPSBhd2FpdCBkLmdldFNjcmVlbnNob3RGb3JJbWFnZUZpbmQoLi4uc2NyZWVuKTtcbiAgICAgIG5ld1NjcmVlbnNob3Quc2hvdWxkLm5vdC5lcWwoVElOWV9QTkcpO1xuICAgICAgc2NyZWVuc2hvdE9iaiA9IGF3YWl0IGltYWdlVXRpbC5nZXRKaW1wSW1hZ2UobmV3U2NyZWVuc2hvdCk7XG4gICAgICBzY3JlZW5zaG90T2JqLmJpdG1hcC53aWR0aC5zaG91bGQuZXFsKHNjcmVlblswXSk7XG4gICAgICBzY3JlZW5zaG90T2JqLmJpdG1hcC5oZWlnaHQuc2hvdWxkLmVxbChzY3JlZW5bMV0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnY3VzdG9tIGVsZW1lbnQgZmluZGluZyBwbHVnaW5zJywgZnVuY3Rpb24gKCkge1xuICAvLyBoYXBweXNcbiAgaXQoJ3Nob3VsZCBmaW5kIGEgc2luZ2xlIGVsZW1lbnQgdXNpbmcgYSBjdXN0b20gZmluZGVyJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IHtmOiBDVVNUT01fRklORF9NT0RVTEV9O1xuICAgIGF3YWl0IGQuZmluZEVsZW1lbnQoQ1VTVE9NX1NUUkFURUdZLCAnZjpmb28nKS5zaG91bGQuZXZlbnR1YWxseS5lcWwoJ2JhcicpO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCBub3QgcmVxdWlyZSBzZWxlY3RvciBwcmVmaXggaWYgb25seSBvbmUgZmluZCBwbHVnaW4gaXMgcmVnaXN0ZXJlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkID0gbmV3IEJhc2VEcml2ZXIoKTtcbiAgICBkLm9wdHMuY3VzdG9tRmluZE1vZHVsZXMgPSB7ZjogQ1VTVE9NX0ZJTkRfTU9EVUxFfTtcbiAgICBhd2FpdCBkLmZpbmRFbGVtZW50KENVU1RPTV9TVFJBVEVHWSwgJ2ZvbycpLnNob3VsZC5ldmVudHVhbGx5LmVxbCgnYmFyJyk7XG4gIH0pO1xuICBpdCgnc2hvdWxkIGZpbmQgbXVsdGlwbGUgZWxlbWVudHMgdXNpbmcgYSBjdXN0b20gZmluZGVyJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IHtmOiBDVVNUT01fRklORF9NT0RVTEV9O1xuICAgIGF3YWl0IGQuZmluZEVsZW1lbnRzKENVU1RPTV9TVFJBVEVHWSwgJ2Y6Zm9vcycpLnNob3VsZC5ldmVudHVhbGx5LmVxbChbJ2JhejEnLCAnYmF6MiddKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgZ2l2ZSBhIGhpbnQgdG8gdGhlIHBsdWdpbiBhYm91dCB3aGV0aGVyIG11bHRpcGxlIGFyZSByZXF1ZXN0ZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgZC5vcHRzLmN1c3RvbUZpbmRNb2R1bGVzID0ge2Y6IENVU1RPTV9GSU5EX01PRFVMRX07XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICdmOmZvb3MnKS5zaG91bGQuZXZlbnR1YWxseS5lcWwoJ2JhcjEnKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgYmUgYWJsZSB0byB1c2UgbXVsdGlwbGUgZmluZCBtb2R1bGVzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IHtmOiBDVVNUT01fRklORF9NT0RVTEUsIGc6IENVU1RPTV9GSU5EX01PRFVMRX07XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICdmOmZvbycpLnNob3VsZC5ldmVudHVhbGx5LmVxbCgnYmFyJyk7XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICdnOmZvbycpLnNob3VsZC5ldmVudHVhbGx5LmVxbCgnYmFyJyk7XG4gIH0pO1xuXG4gIC8vIGVycm9yc1xuICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIGN1c3RvbUZpbmRNb2R1bGVzIGlzIG5vdCBzZXQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICdmOmZvbycpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvY3VzdG9tRmluZE1vZHVsZXMvKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3IgaWYgY3VzdG9tRmluZE1vZHVsZXMgaXMgdGhlIHdyb25nIHNoYXBlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IENVU1RPTV9GSU5EX01PRFVMRTtcbiAgICBhd2FpdCBkLmZpbmRFbGVtZW50KENVU1RPTV9TVFJBVEVHWSwgJ2Y6Zm9vJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9jdXN0b21GaW5kTW9kdWxlcy8pO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBpZiBjdXN0b21GaW5kTW9kdWxlcyBpcyBzaXplID4gMSBhbmQgbm8gc2VsZWN0b3IgcHJlZml4IGlzIHVzZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgZC5vcHRzLmN1c3RvbUZpbmRNb2R1bGVzID0ge2Y6IENVU1RPTV9GSU5EX01PRFVMRSwgZzogQ1VTVE9NX0ZJTkRfTU9EVUxFfTtcbiAgICBhd2FpdCBkLmZpbmRFbGVtZW50KENVU1RPTV9TVFJBVEVHWSwgJ2ZvbycpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvbXVsdGlwbGUgZWxlbWVudCBmaW5kaW5nL2kpO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBpbiBhdHRlbXB0IHRvIHVzZSB1bnJlZ2lzdGVyZWQgcGx1Z2luJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IHtmOiBDVVNUT01fRklORF9NT0RVTEUsIGc6IENVU1RPTV9GSU5EX01PRFVMRX07XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICd6OmZvbycpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvd2FzIG5vdCByZWdpc3RlcmVkLyk7XG4gIH0pO1xuICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHBsdWdpbiBjYW5ub3QgYmUgbG9hZGVkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgQmFzZURyaXZlcigpO1xuICAgIGQub3B0cy5jdXN0b21GaW5kTW9kdWxlcyA9IHtmOiAnLi9mb28uanMnfTtcbiAgICBhd2FpdCBkLmZpbmRFbGVtZW50KENVU1RPTV9TVFJBVEVHWSwgJ2Y6Zm9vJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9jb3VsZCBub3QgbG9hZC9pKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3IgaWYgcGx1Z2luIGlzIG5vdCB0aGUgcmlnaHQgc2hhcGUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgZC5vcHRzLmN1c3RvbUZpbmRNb2R1bGVzID0ge2Y6IEJBRF9DVVNUT01fRklORF9NT0RVTEV9O1xuICAgIGF3YWl0IGQuZmluZEVsZW1lbnQoQ1VTVE9NX1NUUkFURUdZLCAnZjpmb28nKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL2NvbnN0cnVjdGVkIGNvcnJlY3RseS9pKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgcGFzcyBvbiBhbiBlcnJvciB0aHJvd24gYnkgdGhlIGZpbmRlciBpdHNlbGYnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgZC5vcHRzLmN1c3RvbUZpbmRNb2R1bGVzID0ge2Y6IENVU1RPTV9GSU5EX01PRFVMRX07XG4gICAgYXdhaXQgZC5maW5kRWxlbWVudChDVVNUT01fU1RSQVRFR1ksICdmOmVycm9yJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9wbHVnaW4gZXJyb3IvaSk7XG4gIH0pO1xuICBpdCgnc2hvdWxkIHRocm93IG5vIHN1Y2ggZWxlbWVudCBlcnJvciBpZiBlbGVtZW50IG5vdCBmb3VuZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkID0gbmV3IEJhc2VEcml2ZXIoKTtcbiAgICBkLm9wdHMuY3VzdG9tRmluZE1vZHVsZXMgPSB7ZjogQ1VTVE9NX0ZJTkRfTU9EVUxFfTtcbiAgICBhd2FpdCBkLmZpbmRFbGVtZW50KENVU1RPTV9TVFJBVEVHWSwgJ2Y6bm9wZScpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvY291bGQgbm90IGJlIGxvY2F0ZWQvKTtcbiAgfSk7XG59KTtcbiJdLCJmaWxlIjoidGVzdC9iYXNlZHJpdmVyL2NvbW1hbmRzL2ZpbmQtc3BlY3MuanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4vLi4ifQ==
