"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMostRecentChromedriver = getMostRecentChromedriver;
exports.default = exports.CD_VER = exports.CHROMEDRIVER_CHROME_MAPPING = exports.Chromedriver = void 0;

require("source-map-support/register");

var _events = _interopRequireDefault(require("events"));

var _appiumBaseDriver = require("appium-base-driver");

var _child_process = _interopRequireDefault(require("child_process"));

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _teen_process = require("teen_process");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _utils = require("./utils");

var _semver = _interopRequireDefault(require("semver"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

const log = _appiumSupport.logger.getLogger('Chromedriver');

const DEFAULT_HOST = '127.0.0.1';
const DEFAULT_PORT = 9515;
const CHROMEDRIVER_CHROME_MAPPING = {
  '2.45': '70.0.0',
  '2.44': '69.0.3497',
  '2.43': '69.0.3497',
  '2.42': '68.0.3440',
  '2.41': '67.0.3396',
  '2.40': '66.0.3359',
  '2.39': '66.0.3359',
  '2.38': '65.0.3325',
  '2.37': '64.0.3282',
  '2.36': '63.0.3239',
  '2.35': '62.0.3202',
  '2.34': '61.0.3163',
  '2.33': '60.0.3112',
  '2.32': '59.0.3071',
  '2.31': '58.0.3029',
  '2.30': '58.0.3029',
  '2.29': '57.0.2987',
  '2.28': '55.0.2883',
  '2.27': '54.0.2840',
  '2.26': '53.0.2785',
  '2.25': '53.0.2785',
  '2.24': '52.0.2743',
  '2.23': '51.0.2704',
  '2.22': '49.0.2623',
  '2.21': '46.0.2490',
  '2.20': '43.0.2357',
  '2.19': '43.0.2357',
  '2.18': '43.0.2357',
  '2.17': '42.0.2311',
  '2.16': '42.0.2311',
  '2.15': '40.0.2214',
  '2.14': '39.0.2171',
  '2.13': '38.0.2125',
  '2.12': '36.0.1985',
  '2.11': '36.0.1985',
  '2.10': '33.0.1751',
  '2.9': '31.0.1650',
  '2.8': '30.0.1573',
  '2.7': '30.0.1573',
  '2.6': '29.0.1545',
  '2.5': '29.0.1545',
  '2.4': '29.0.1545',
  '2.3': '28.0.1500',
  '2.2': '27.0.1453',
  '2.1': '27.0.1453',
  '2.0': '27.0.1453'
};
exports.CHROMEDRIVER_CHROME_MAPPING = CHROMEDRIVER_CHROME_MAPPING;
const CHROME_BUNDLE_ID = 'com.android.chrome';
const WEBVIEW_BUNDLE_IDS = ['com.google.android.webview', 'com.android.webview'];
const CHROMEDRIVER_TUTORIAL = 'https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/web/chromedriver.md';
const CD_VER = process.env.npm_config_chromedriver_version || process.env.CHROMEDRIVER_VERSION || getMostRecentChromedriver();
exports.CD_VER = CD_VER;
const CD_VERSION_TIMEOUT = 5000;

function getMostRecentChromedriver(mapping = CHROMEDRIVER_CHROME_MAPPING) {
  if (_lodash.default.isEmpty(mapping)) {
    throw new Error('Unable to get most recent Chromedriver from empty mapping');
  }

  return _lodash.default.keys(mapping).map(_semver.default.coerce).sort(_semver.default.rcompare).map(v => `${_semver.default.major(v)}.${_semver.default.minor(v)}`)[0];
}

class Chromedriver extends _events.default.EventEmitter {
  constructor(args = {}) {
    super();
    const {
      host = DEFAULT_HOST,
      port = DEFAULT_PORT,
      useSystemExecutable = false,
      executable,
      executableDir = (0, _utils.getChromedriverDir)(),
      bundleId,
      mappingPath,
      cmdArgs,
      adb,
      verbose,
      logPath,
      disableBuildCheck
    } = args;
    this.proxyHost = host;
    this.proxyPort = port;
    this.adb = adb;
    this.cmdArgs = cmdArgs;
    this.proc = null;
    this.useSystemExecutable = useSystemExecutable;
    this.chromedriver = executable;
    this.executableDir = executableDir;
    this.mappingPath = mappingPath;
    this.bundleId = bundleId;
    this.executableVerified = false;
    this.state = Chromedriver.STATE_STOPPED;
    this.jwproxy = new _appiumBaseDriver.JWProxy({
      server: this.proxyHost,
      port: this.proxyPort
    });
    this.verbose = verbose;
    this.logPath = logPath;
    this.disableBuildCheck = !!disableBuildCheck;
  }

  async getMapping() {
    let mapping = CHROMEDRIVER_CHROME_MAPPING;

    if (this.mappingPath) {
      log.debug(`Attempting to use Chromedriver-Chrome mapping from '${this.mappingPath}'`);

      if (!(await _appiumSupport.fs.exists(this.mappingPath))) {
        log.warn(`No file found at '${this.mappingPath}'. Using default mapping`);
      } else {
        try {
          mapping = JSON.parse((await _appiumSupport.fs.readFile(this.mappingPath)));
        } catch (err) {
          log.error(`Error parsing mapping from '${this.mappingPath}': ${err.message}`);
          log.warn('Using default mapping');
        }
      }
    }

    for (const [cdVersion, chromeVersion] of _lodash.default.toPairs(mapping)) {
      mapping[cdVersion] = _semver.default.coerce(chromeVersion);
    }

    return mapping;
  }

  async getChromedrivers(mapping) {
    const executables = await _appiumSupport.fs.glob(`${this.executableDir}/*`);
    log.debug(`Found ${executables.length} executable${executables.length === 1 ? '' : 's'} ` + `in '${this.executableDir}'`);
    const cds = (await (0, _asyncbox.asyncmap)(executables, async function (executable) {
      const logError = ({
        message,
        stdout = null,
        stderr = null
      }) => {
        let errMsg = `Cannot retrieve version number from '${_path.default.basename(executable)}' Chromedriver binary. ` + `Make sure it returns a valid version string in response to '--version' command line argument. ${message}`;

        if (stdout) {
          errMsg += `\nStdout: ${stdout}`;
        }

        if (stderr) {
          errMsg += `\nStderr: ${stderr}`;
        }

        log.warn(errMsg);
        return null;
      };

      let stdout;
      let stderr;

      try {
        ({
          stdout,
          stderr
        } = await (0, _teen_process.exec)(executable, ['--version'], {
          timeout: CD_VERSION_TIMEOUT
        }));
      } catch (err) {
        if (!(err.message || '').includes('timed out') && !(err.stdout || '').includes('Starting ChromeDriver')) {
          return logError(err);
        }

        stdout = err.stdout;
      }

      const match = /ChromeDriver\s+\(?v?([\d.]+)\)?/i.exec(stdout);

      if (!match) {
        return logError({
          message: 'Cannot parse the version string',
          stdout,
          stderr
        });
      }

      const versionObj = _semver.default.coerce(match[1], true);

      if (!versionObj) {
        return logError({
          message: 'Cannot coerce the version number',
          stdout,
          stderr
        });
      }

      const version = `${versionObj.major}.${versionObj.minor}`;
      return {
        executable,
        version,
        minCDVersion: mapping[version]
      };
    })).filter(cd => !!cd).sort((a, b) => _semver.default.gte(_semver.default.coerce(b.version), _semver.default.coerce(a.version)) ? 1 : -1);

    if (_lodash.default.isEmpty(cds)) {
      log.errorAndThrow(`No Chromedrivers found in '${this.executableDir}'`);
    }

    log.debug(`The following Chromedriver executables were found:`);

    for (const cd of cds) {
      log.debug(`    ${cd.executable} (minimum Chrome version '${cd.minCDVersion ? cd.minCDVersion : 'Unknown'}')`);
    }

    return cds;
  }

  async getChromeVersion() {
    let chromeVersion;

    if (this.adb && (await this.adb.getApiLevel()) >= 24) {
      this.bundleId = CHROME_BUNDLE_ID;
    }

    if (!this.bundleId) {
      this.bundleId = CHROME_BUNDLE_ID;

      for (const bundleId of WEBVIEW_BUNDLE_IDS) {
        chromeVersion = await (0, _utils.getChromeVersion)(this.adb, bundleId);

        if (chromeVersion) {
          this.bundleId = bundleId;
          break;
        }
      }
    }

    if (!chromeVersion) {
      chromeVersion = await (0, _utils.getChromeVersion)(this.adb, this.bundleId);
    }

    return chromeVersion ? _semver.default.coerce(chromeVersion) : null;
  }

  async getCompatibleChromedriver() {
    if (!this.adb) {
      return await (0, _utils.getChromedriverBinaryPath)();
    }

    const mapping = await this.getMapping();
    const cds = await this.getChromedrivers(mapping);
    const chromeVersion = await this.getChromeVersion();

    if (!chromeVersion) {
      let cd = cds[0];
      log.warn(`Unable to discover Chrome version. Using Chromedriver ${cd.version} at '${cd.executable}'`);
      return cd.executable;
    }

    log.debug(`Found Chrome bundle '${this.bundleId}' version '${chromeVersion}'`);

    if (_semver.default.gt(chromeVersion, _lodash.default.values(mapping)[0]) && !_lodash.default.isUndefined(cds[0]) && _lodash.default.isUndefined(cds[0].minCDVersion)) {
      let cd = cds[0];
      log.warn(`No known Chromedriver available to automate Chrome version '${chromeVersion}'.\n` + `Using Chromedriver version '${cd.version}', which has not been tested with Appium.`);
      return cd.executable;
    }

    const workingCds = cds.filter(cd => {
      return !_lodash.default.isUndefined(cd.minCDVersion) && _semver.default.gte(chromeVersion, cd.minCDVersion);
    });

    if (_lodash.default.isEmpty(workingCds)) {
      log.errorAndThrow(`No Chromedriver found that can automate Chrome '${chromeVersion}'. ` + `See ${CHROMEDRIVER_TUTORIAL} for more details.`);
    }

    const binPath = workingCds[0].executable;
    log.debug(`Found ${workingCds.length} Chromedriver executable${workingCds.length === 1 ? '' : 's'} ` + `capable of automating Chrome '${chromeVersion}'.\n` + `Choosing the most recent, '${binPath}'.`);
    log.debug('If a specific version is required, specify it with the `chromedriverExecutable`' + 'desired capability.');
    return binPath;
  }

  async initChromedriverPath() {
    if (this.executableVerified) return;

    if (!this.chromedriver) {
      this.chromedriver = this.useSystemExecutable ? await (0, _utils.getChromedriverBinaryPath)() : await this.getCompatibleChromedriver();
    }

    if (!(await _appiumSupport.fs.exists(this.chromedriver))) {
      throw new Error(`Trying to use a chromedriver binary at the path ` + `${this.chromedriver}, but it doesn't exist!`);
    }

    this.executableVerified = true;
    log.info(`Set chromedriver binary as: ${this.chromedriver}`);
  }

  async start(caps, emitStartingState = true) {
    this.capabilities = caps;

    if (emitStartingState) {
      this.changeState(Chromedriver.STATE_STARTING);
    }

    let args = ["--url-base=wd/hub", `--port=${this.proxyPort}`];

    if (this.adb && this.adb.adbPort) {
      args = args.concat([`--adb-port=${this.adb.adbPort}`]);
    }

    if (this.cmdArgs) {
      args = args.concat(this.cmdArgs);
    }

    if (this.logPath) {
      args = args.concat([`--log-path=${this.logPath}`]);
    }

    if (this.disableBuildCheck) {
      args = args.concat(['--disable-build-check']);
    }

    args = args.concat(['--verbose']);

    const startDetector = stdout => {
      return stdout.indexOf('Starting ') === 0;
    };

    let processIsAlive = false;
    let webviewVersion;

    try {
      await this.initChromedriverPath();
      await this.killAll();
      this.proc = new _teen_process.SubProcess(this.chromedriver, args);
      processIsAlive = true;
      this.proc.on('output', (stdout, stderr) => {
        const out = stdout + stderr;
        let match = /"Browser": "(.*)"/.exec(out);

        if (match) {
          webviewVersion = match[1];
          log.debug(`Webview version: '${webviewVersion}'`);
        }

        match = /Starting ChromeDriver ([.\d]+)/.exec(out);

        if (match) {
          log.debug(`Chromedriver version: '${match[1]}'`);
        }

        if (this.verbose) {
          for (let line of (stdout || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.debug(`[STDOUT] ${line}`);
          }

          for (let line of (stderr || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.error(`[STDERR] ${line}`);
          }
        }
      });
      this.proc.on('exit', (code, signal) => {
        processIsAlive = false;

        if (this.state !== Chromedriver.STATE_STOPPED && this.state !== Chromedriver.STATE_STOPPING && this.state !== Chromedriver.STATE_RESTARTING) {
          let msg = `Chromedriver exited unexpectedly with code ${code}, ` + `signal ${signal}`;
          log.error(msg);
          this.changeState(Chromedriver.STATE_STOPPED);
        }
      });
      log.info(`Spawning chromedriver with: ${this.chromedriver} ` + `${args.join(' ')}`);
      await this.proc.start(startDetector);
      await this.waitForOnline();
      await this.startSession();
    } catch (e) {
      this.emit(Chromedriver.EVENT_ERROR, e);

      if (processIsAlive) {
        await this.proc.stop();
      }

      let message = '';

      if (e.message.includes('Chrome version must be')) {
        message += 'Unable to automate Chrome version because it is too old for this version of Chromedriver.\n';

        if (webviewVersion) {
          message += `Chrome version on the device: ${webviewVersion}\n`;
        }

        message += `Visit '${CHROMEDRIVER_TUTORIAL}' to troubleshoot the problem.\n`;
      }

      message += e.message;
      log.errorAndThrow(message);
    }
  }

  sessionId() {
    if (this.state !== Chromedriver.STATE_ONLINE) {
      return null;
    }

    return this.jwproxy.sessionId;
  }

  async restart() {
    log.info("Restarting chromedriver");

    if (this.state !== Chromedriver.STATE_ONLINE) {
      throw new Error("Can't restart when we're not online");
    }

    this.changeState(Chromedriver.STATE_RESTARTING);
    await this.stop(false);
    await this.start(this.capabilities, false);
  }

  async waitForOnline() {
    let chromedriverStopped = false;
    await (0, _asyncbox.retryInterval)(20, 200, async () => {
      if (this.state === Chromedriver.STATE_STOPPED) {
        chromedriverStopped = true;
        return;
      }

      await this.getStatus();
    });

    if (chromedriverStopped) {
      throw new Error('ChromeDriver crashed during startup.');
    }
  }

  async getStatus() {
    return await this.jwproxy.command('/status', 'GET');
  }

  async startSession() {
    await (0, _asyncbox.retryInterval)(4, 200, async () => {
      try {
        let res = await this.jwproxy.command('/session', 'POST', {
          desiredCapabilities: this.capabilities
        });

        if (res.status) {
          throw new Error(res.value.message);
        }
      } catch (err) {
        log.errorAndThrow(`Failed to start Chromedriver session: ${err.message}`);
      }
    });
    this.changeState(Chromedriver.STATE_ONLINE);
  }

  async stop(emitStates = true) {
    if (emitStates) {
      this.changeState(Chromedriver.STATE_STOPPING);
    }

    try {
      await this.jwproxy.command('', 'DELETE');
      await this.proc.stop('SIGTERM', 20000);

      if (emitStates) {
        this.changeState(Chromedriver.STATE_STOPPED);
      }
    } catch (e) {
      log.error(e);
    }
  }

  changeState(state) {
    this.state = state;
    log.debug(`Changed state to '${state}'`);
    this.emit(Chromedriver.EVENT_CHANGED, {
      state
    });
  }

  async sendCommand(url, method, body) {
    return await this.jwproxy.command(url, method, body);
  }

  async proxyReq(req, res) {
    return await this.jwproxy.proxyReqRes(req, res);
  }

  async killAll() {
    let cmd = _appiumSupport.system.isWindows() ? `wmic process where "commandline like '%chromedriver.exe%--port=${this.proxyPort}%'" delete` : `pkill -15 -f "${this.chromedriver}.*--port=${this.proxyPort}"`;
    log.debug(`Killing any old chromedrivers, running: ${cmd}`);

    try {
      await _bluebird.default.promisify(_child_process.default.exec)(cmd);
      log.debug("Successfully cleaned up old chromedrivers");
    } catch (err) {
      log.warn("No old chromedrivers seemed to exist");
    }

    if (this.adb) {
      log.debug(`Cleaning any old adb forwarded port socket connections`);

      try {
        for (let conn of await this.adb.getForwardList()) {
          if (conn.indexOf('webview_devtools') !== -1) {
            let params = conn.split(/\s+/);

            if (params.length > 1) {
              await this.adb.removePortForward(params[1].replace(/[\D]*/, ''));
            }
          }
        }
      } catch (err) {
        log.warn(`Unable to clean forwarded ports. Error: '${err.message}'. Continuing.`);
      }
    }
  }

  async hasWorkingWebview() {
    try {
      await this.jwproxy.command('/url', 'GET');
      return true;
    } catch (e) {
      return false;
    }
  }

}

exports.Chromedriver = Chromedriver;
Chromedriver.EVENT_ERROR = 'chromedriver_error';
Chromedriver.EVENT_CHANGED = 'stateChanged';
Chromedriver.STATE_STOPPED = 'stopped';
Chromedriver.STATE_STARTING = 'starting';
Chromedriver.STATE_ONLINE = 'online';
Chromedriver.STATE_STOPPING = 'stopping';
Chromedriver.STATE_RESTARTING = 'restarting';
var _default = Chromedriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jaHJvbWVkcml2ZXIuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiREVGQVVMVF9IT1NUIiwiREVGQVVMVF9QT1JUIiwiQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HIiwiQ0hST01FX0JVTkRMRV9JRCIsIldFQlZJRVdfQlVORExFX0lEUyIsIkNIUk9NRURSSVZFUl9UVVRPUklBTCIsIkNEX1ZFUiIsInByb2Nlc3MiLCJlbnYiLCJucG1fY29uZmlnX2Nocm9tZWRyaXZlcl92ZXJzaW9uIiwiQ0hST01FRFJJVkVSX1ZFUlNJT04iLCJnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyIiwiQ0RfVkVSU0lPTl9USU1FT1VUIiwibWFwcGluZyIsIl8iLCJpc0VtcHR5IiwiRXJyb3IiLCJrZXlzIiwibWFwIiwic2VtdmVyIiwiY29lcmNlIiwic29ydCIsInJjb21wYXJlIiwidiIsIm1ham9yIiwibWlub3IiLCJDaHJvbWVkcml2ZXIiLCJldmVudHMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImFyZ3MiLCJob3N0IiwicG9ydCIsInVzZVN5c3RlbUV4ZWN1dGFibGUiLCJleGVjdXRhYmxlIiwiZXhlY3V0YWJsZURpciIsImJ1bmRsZUlkIiwibWFwcGluZ1BhdGgiLCJjbWRBcmdzIiwiYWRiIiwidmVyYm9zZSIsImxvZ1BhdGgiLCJkaXNhYmxlQnVpbGRDaGVjayIsInByb3h5SG9zdCIsInByb3h5UG9ydCIsInByb2MiLCJjaHJvbWVkcml2ZXIiLCJleGVjdXRhYmxlVmVyaWZpZWQiLCJzdGF0ZSIsIlNUQVRFX1NUT1BQRUQiLCJqd3Byb3h5IiwiSldQcm94eSIsInNlcnZlciIsImdldE1hcHBpbmciLCJkZWJ1ZyIsImZzIiwiZXhpc3RzIiwid2FybiIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIiwiY2RWZXJzaW9uIiwiY2hyb21lVmVyc2lvbiIsInRvUGFpcnMiLCJnZXRDaHJvbWVkcml2ZXJzIiwiZXhlY3V0YWJsZXMiLCJnbG9iIiwibGVuZ3RoIiwiY2RzIiwibG9nRXJyb3IiLCJzdGRvdXQiLCJzdGRlcnIiLCJlcnJNc2ciLCJwYXRoIiwiYmFzZW5hbWUiLCJ0aW1lb3V0IiwiaW5jbHVkZXMiLCJtYXRjaCIsImV4ZWMiLCJ2ZXJzaW9uT2JqIiwidmVyc2lvbiIsIm1pbkNEVmVyc2lvbiIsImZpbHRlciIsImNkIiwiYSIsImIiLCJndGUiLCJlcnJvckFuZFRocm93IiwiZ2V0Q2hyb21lVmVyc2lvbiIsImdldEFwaUxldmVsIiwiZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciIsImd0IiwidmFsdWVzIiwiaXNVbmRlZmluZWQiLCJ3b3JraW5nQ2RzIiwiYmluUGF0aCIsImluaXRDaHJvbWVkcml2ZXJQYXRoIiwiaW5mbyIsInN0YXJ0IiwiY2FwcyIsImVtaXRTdGFydGluZ1N0YXRlIiwiY2FwYWJpbGl0aWVzIiwiY2hhbmdlU3RhdGUiLCJTVEFURV9TVEFSVElORyIsImFkYlBvcnQiLCJjb25jYXQiLCJzdGFydERldGVjdG9yIiwiaW5kZXhPZiIsInByb2Nlc3NJc0FsaXZlIiwid2Vidmlld1ZlcnNpb24iLCJraWxsQWxsIiwiU3ViUHJvY2VzcyIsIm9uIiwib3V0IiwibGluZSIsInRyaW0iLCJzcGxpdCIsImNvZGUiLCJzaWduYWwiLCJTVEFURV9TVE9QUElORyIsIlNUQVRFX1JFU1RBUlRJTkciLCJtc2ciLCJqb2luIiwid2FpdEZvck9ubGluZSIsInN0YXJ0U2Vzc2lvbiIsImUiLCJlbWl0IiwiRVZFTlRfRVJST1IiLCJzdG9wIiwic2Vzc2lvbklkIiwiU1RBVEVfT05MSU5FIiwicmVzdGFydCIsImNocm9tZWRyaXZlclN0b3BwZWQiLCJnZXRTdGF0dXMiLCJjb21tYW5kIiwicmVzIiwiZGVzaXJlZENhcGFiaWxpdGllcyIsInN0YXR1cyIsInZhbHVlIiwiZW1pdFN0YXRlcyIsIkVWRU5UX0NIQU5HRUQiLCJzZW5kQ29tbWFuZCIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJwcm94eVJlcSIsInJlcSIsInByb3h5UmVxUmVzIiwiY21kIiwic3lzdGVtIiwiaXNXaW5kb3dzIiwiQiIsInByb21pc2lmeSIsImNwIiwiY29ubiIsImdldEZvcndhcmRMaXN0IiwicGFyYW1zIiwicmVtb3ZlUG9ydEZvcndhcmQiLCJyZXBsYWNlIiwiaGFzV29ya2luZ1dlYnZpZXciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLEdBQUcsR0FBR0Msc0JBQU9DLFNBQVAsQ0FBaUIsY0FBakIsQ0FBWjs7QUFFQSxNQUFNQyxZQUFZLEdBQUcsV0FBckI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBckI7QUFDQSxNQUFNQywyQkFBMkIsR0FBRztBQUVsQyxVQUFRLFFBRjBCO0FBR2xDLFVBQVEsV0FIMEI7QUFJbEMsVUFBUSxXQUowQjtBQUtsQyxVQUFRLFdBTDBCO0FBTWxDLFVBQVEsV0FOMEI7QUFPbEMsVUFBUSxXQVAwQjtBQVFsQyxVQUFRLFdBUjBCO0FBU2xDLFVBQVEsV0FUMEI7QUFVbEMsVUFBUSxXQVYwQjtBQVdsQyxVQUFRLFdBWDBCO0FBWWxDLFVBQVEsV0FaMEI7QUFhbEMsVUFBUSxXQWIwQjtBQWNsQyxVQUFRLFdBZDBCO0FBZWxDLFVBQVEsV0FmMEI7QUFnQmxDLFVBQVEsV0FoQjBCO0FBaUJsQyxVQUFRLFdBakIwQjtBQWtCbEMsVUFBUSxXQWxCMEI7QUFtQmxDLFVBQVEsV0FuQjBCO0FBb0JsQyxVQUFRLFdBcEIwQjtBQXFCbEMsVUFBUSxXQXJCMEI7QUFzQmxDLFVBQVEsV0F0QjBCO0FBdUJsQyxVQUFRLFdBdkIwQjtBQXdCbEMsVUFBUSxXQXhCMEI7QUF5QmxDLFVBQVEsV0F6QjBCO0FBMEJsQyxVQUFRLFdBMUIwQjtBQTJCbEMsVUFBUSxXQTNCMEI7QUE0QmxDLFVBQVEsV0E1QjBCO0FBNkJsQyxVQUFRLFdBN0IwQjtBQThCbEMsVUFBUSxX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LENBQWI7O0FBQ0EsZ0JBQUl3QyxNQUFNLENBQUN6RixNQUFQLEdBQWdCLENBQXBCLEVBQXVCO0FBQ3JCLG9CQUFNLEtBQUsvQixHQUFMLENBQVN5SCxpQkFBVCxDQUEyQkQsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVRSxPQUFWLENBQWtCLE9BQWxCLEVBQTJCLEVBQTNCLENBQTNCLENBQU47QUFDRDtBQUNGO0FBQ0Y7QUFDRixPQVZELENBVUUsT0FBT3BHLEdBQVAsRUFBWTtBQUNaaEUsUUFBQUEsR0FBRyxDQUFDNEQsSUFBSixDQUFVLDRDQUEyQ0ksR0FBRyxDQUFDRSxPQUFRLGdCQUFqRTtBQUNEO0FBQ0Y7QUFDRjs7QUFFRCxRQUFNbUcsaUJBQU4sR0FBMkI7QUFHekIsUUFBSTtBQUNGLFlBQU0sS0FBS2hILE9BQUwsQ0FBYXVGLE9BQWIsQ0FBcUIsTUFBckIsRUFBNkIsS0FBN0IsQ0FBTjtBQUNBLGFBQU8sSUFBUDtBQUNELEtBSEQsQ0FHRSxPQUFPVCxDQUFQLEVBQVU7QUFDVixhQUFPLEtBQVA7QUFDRDtBQUNGOztBQTVjNEM7OztBQStjL0N0RyxZQUFZLENBQUN3RyxXQUFiLEdBQTJCLG9CQUEzQjtBQUNBeEcsWUFBWSxDQUFDcUgsYUFBYixHQUE2QixjQUE3QjtBQUNBckgsWUFBWSxDQUFDdUIsYUFBYixHQUE2QixTQUE3QjtBQUNBdkIsWUFBWSxDQUFDZ0YsY0FBYixHQUE4QixVQUE5QjtBQUNBaEYsWUFBWSxDQUFDMkcsWUFBYixHQUE0QixRQUE1QjtBQUNBM0csWUFBWSxDQUFDZ0csY0FBYixHQUE4QixVQUE5QjtBQUNBaEcsWUFBWSxDQUFDaUcsZ0JBQWIsR0FBZ0MsWUFBaEM7ZUFLZWpHLFkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0cmFuc3BpbGU6bWFpblxuXG5pbXBvcnQgZXZlbnRzIGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBKV1Byb3h5IH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCBjcCBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCB7IHN5c3RlbSwgZnMsIGxvZ2dlciB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIGFzeW5jbWFwIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgU3ViUHJvY2VzcywgZXhlYyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgeyBnZXRDaHJvbWVWZXJzaW9uLCBnZXRDaHJvbWVkcml2ZXJEaXIsIGdldENocm9tZWRyaXZlckJpbmFyeVBhdGggfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuXG5jb25zdCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdDaHJvbWVkcml2ZXInKTtcblxuY29uc3QgREVGQVVMVF9IT1NUID0gJzEyNy4wLjAuMSc7XG5jb25zdCBERUZBVUxUX1BPUlQgPSA5NTE1O1xuY29uc3QgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HID0ge1xuICAvLyBDaHJvbWVkcml2ZXIgdmVyc2lvbjogbWludW11bSBDaHJvbWUgdmVyc2lvblxuICAnMi40NSc6ICc3MC4wLjAnLFxuICAnMi40NCc6ICc2OS4wLjM0OTcnLFxuICAnMi40Myc6ICc2OS4wLjM0OTcnLFxuICAnMi40Mic6ICc2OC4wLjM0NDAnLFxuICAnMi40MSc6ICc2Ny4wLjMzOTYnLFxuICAnMi40MCc6ICc2Ni4wLjMzNTknLFxuICAnMi4zOSc6ICc2Ni4wLjMzNTknLFxuICAnMi4zOCc6ICc2NS4wLjMzMjUnLFxuICAnMi4zNyc6ICc2NC4wLjMyODInLFxuICAnMi4zNic6ICc2My4wLjMyMzknLFxuICAnMi4zNSc6ICc2Mi4wLjMyMDInLFxuICAnMi4zNCc6ICc2MS4wLjMxNjMnLFxuICAnMi4zMyc6ICc2MC4wLjMxMTInLFxuICAnMi4zMic6ICc1OS4wLjMwNzEnLFxuICAnMi4zMSc6ICc1OC4wLjMwMjknLFxuICAnMi4zMCc6ICc1OC4wLjMwMjknLFxuICAnMi4yOSc6ICc1Ny4wLjI5ODcnLFxuICAnMi4yOCc6ICc1NS4wLjI4ODMnLFxuICAnMi4yNyc6ICc1NC4wLjI4NDAnLFxuICAnMi4yNic6ICc1My4wLjI3ODUnLFxuICAnMi4yNSc6ICc1My4wLjI3ODUnLFxuICAnMi4yNCc6ICc1Mi4wLjI3NDMnLFxuICAnMi4yMyc6ICc1MS4wLjI3MDQnLFxuICAnMi4yMic6ICc0OS4wLjI2MjMnLFxuICAnMi4yMSc6ICc0Ni4wLjI0OTAnLFxuICAnMi4yMCc6ICc0My4wLjIzNTcnLFxuICAnMi4xOSc6ICc0My4wLjIzNTcnLFxuICAnMi4xOCc6ICc0My4wLjIzNTcnLFxuICAnMi4xNyc6ICc0Mi4wLjIzMTEnLFxuICAnMi4xNic6ICc0Mi4wLjIzMTEnLFxuICAnMi4xNSc6ICc0MC4wLjIyMTQnLFxuICAnMi4xNCc6ICczOS4wLjIxNzEnLFxuICAnMi4xMyc6ICczOC4wLjIxMjUnLFxuICAnMi4xMic6ICczNi4wLjE5ODUnLFxuICAnMi4xMSc6ICczNi4wLjE5ODUnLFxuICAnMi4xMCc6ICczMy4wLjE3NTEnLFxuICAnMi45JzogJzMxLjAuMTY1MCcsXG4gICcyLjgnOiAnMzAuMC4xNTczJyxcbiAgJzIuNyc6ICczMC4wLjE1NzMnLFxuICAnMi42JzogJzI5LjAuMTU0NScsXG4gICcyLjUnOiAnMjkuMC4xNTQ1JyxcbiAgJzIuNCc6ICcyOS4wLjE1NDUnLFxuICAnMi4zJzogJzI4LjAuMTUwMCcsXG4gICcyLjInOiAnMjcuMC4xNDUzJyxcbiAgJzIuMSc6ICcyNy4wLjE0NTMnLFxuICAnMi4wJzogJzI3LjAuMTQ1MycsXG59O1xuY29uc3QgQ0hST01FX0JVTkRMRV9JRCA9ICdjb20uYW5kcm9pZC5jaHJvbWUnO1xuY29uc3QgV0VCVklFV19CVU5ETEVfSURTID0gW1xuICAnY29tLmdvb2dsZS5hbmRyb2lkLndlYnZpZXcnLFxuICAnY29tLmFuZHJvaWQud2VidmlldycsXG5dO1xuY29uc3QgQ0hST01FRFJJVkVSX1RVVE9SSUFMID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2Jsb2IvbWFzdGVyL2RvY3MvZW4vd3JpdGluZy1ydW5uaW5nLWFwcGl1bS93ZWIvY2hyb21lZHJpdmVyLm1kJztcblxuY29uc3QgQ0RfVkVSID0gcHJvY2Vzcy5lbnYubnBtX2NvbmZpZ19jaHJvbWVkcml2ZXJfdmVyc2lvbiB8fFxuICAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuQ0hST01FRFJJVkVSX1ZFUlNJT04gfHxcbiAgICAgICAgICAgICAgIGdldE1vc3RSZWNlbnRDaHJvbWVkcml2ZXIoKTtcblxuY29uc3QgQ0RfVkVSU0lPTl9USU1FT1VUID0gNTAwMDtcblxuZnVuY3Rpb24gZ2V0TW9zdFJlY2VudENocm9tZWRyaXZlciAobWFwcGluZyA9IENIUk9NRURSSVZFUl9DSFJPTUVfTUFQUElORykge1xuICBpZiAoXy5pc0VtcHR5KG1hcHBpbmcpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gZ2V0IG1vc3QgcmVjZW50IENocm9tZWRyaXZlciBmcm9tIGVtcHR5IG1hcHBpbmcnKTtcbiAgfVxuICByZXR1cm4gXy5rZXlzKG1hcHBpbmcpXG4gICAgLm1hcChzZW12ZXIuY29lcmNlKVxuICAgIC5zb3J0KHNlbXZlci5yY29tcGFyZSlcbiAgICAubWFwKCh2KSA9PiBgJHtzZW12ZXIubWFqb3Iodil9LiR7c2VtdmVyLm1pbm9yKHYpfWApWzBdO1xufVxuXG5jbGFzcyBDaHJvbWVkcml2ZXIgZXh0ZW5kcyBldmVudHMuRXZlbnRFbWl0dGVyIHtcbiAgY29uc3RydWN0b3IgKGFyZ3MgPSB7fSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBob3N0ID0gREVGQVVMVF9IT1NULFxuICAgICAgcG9ydCA9IERFRkFVTFRfUE9SVCxcbiAgICAgIHVzZVN5c3RlbUV4ZWN1dGFibGUgPSBmYWxzZSxcbiAgICAgIGV4ZWN1dGFibGUsXG4gICAgICBleGVjdXRhYmxlRGlyID0gZ2V0Q2hyb21lZHJpdmVyRGlyKCksXG4gICAgICBidW5kbGVJZCxcbiAgICAgIG1hcHBpbmdQYXRoLFxuICAgICAgY21kQXJncyxcbiAgICAgIGFkYixcbiAgICAgIHZlcmJvc2UsXG4gICAgICBsb2dQYXRoLFxuICAgICAgZGlzYWJsZUJ1aWxkQ2hlY2ssXG4gICAgfSA9IGFyZ3M7XG5cbiAgICB0aGlzLnByb3h5SG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5wcm94eVBvcnQgPSBwb3J0O1xuICAgIHRoaXMuYWRiID0gYWRiO1xuICAgIHRoaXMuY21kQXJncyA9IGNtZEFyZ3M7XG4gICAgdGhpcy5wcm9jID0gbnVsbDtcbiAgICB0aGlzLnVzZVN5c3RlbUV4ZWN1dGFibGUgPSB1c2VTeXN0ZW1FeGVjdXRhYmxlO1xuICAgIHRoaXMuY2hyb21lZHJpdmVyID0gZXhlY3V0YWJsZTtcbiAgICB0aGlzLmV4ZWN1dGFibGVEaXIgPSBleGVjdXRhYmxlRGlyO1xuICAgIHRoaXMubWFwcGluZ1BhdGggPSBtYXBwaW5nUGF0aDtcbiAgICB0aGlzLmJ1bmRsZUlkID0gYnVuZGxlSWQ7XG4gICAgdGhpcy5leGVjdXRhYmxlVmVyaWZpZWQgPSBmYWxzZTtcbiAgICB0aGlzLnN0YXRlID0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQ7XG4gICAgdGhpcy5qd3Byb3h5ID0gbmV3IEpXUHJveHkoe3NlcnZlcjogdGhpcy5wcm94eUhvc3QsIHBvcnQ6IHRoaXMucHJveHlQb3J0fSk7XG4gICAgdGhpcy52ZXJib3NlID0gdmVyYm9zZTtcbiAgICB0aGlzLmxvZ1BhdGggPSBsb2dQYXRoO1xuICAgIHRoaXMuZGlzYWJsZUJ1aWxkQ2hlY2sgPSAhIWRpc2FibGVCdWlsZENoZWNrO1xuICB9XG5cbiAgYXN5bmMgZ2V0TWFwcGluZyAoKSB7XG4gICAgbGV0IG1hcHBpbmcgPSBDSFJPTUVEUklWRVJfQ0hST01FX01BUFBJTkc7XG4gICAgaWYgKHRoaXMubWFwcGluZ1BhdGgpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQXR0ZW1wdGluZyB0byB1c2UgQ2hyb21lZHJpdmVyLUNocm9tZSBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nYCk7XG4gICAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyh0aGlzLm1hcHBpbmdQYXRoKSkge1xuICAgICAgICBsb2cud2FybihgTm8gZmlsZSBmb3VuZCBhdCAnJHt0aGlzLm1hcHBpbmdQYXRofScuIFVzaW5nIGRlZmF1bHQgbWFwcGluZ2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBtYXBwaW5nID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRmlsZSh0aGlzLm1hcHBpbmdQYXRoKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZy5lcnJvcihgRXJyb3IgcGFyc2luZyBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICAgIGxvZy53YXJuKCdVc2luZyBkZWZhdWx0IG1hcHBpbmcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSB2YWx1ZXMgZm9yIG1pbmltdW0gY2hyb21lIHZlcnNpb24gYXJlIHNlbXZlciBjb21wbGlhbnRcbiAgICBmb3IgKGNvbnN0IFtjZFZlcnNpb24sIGNocm9tZVZlcnNpb25dIG9mIF8udG9QYWlycyhtYXBwaW5nKSkge1xuICAgICAgbWFwcGluZ1tjZFZlcnNpb25dID0gc2VtdmVyLmNvZXJjZShjaHJvbWVWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcHBpbmc7XG4gIH1cblxuICBhc3luYyBnZXRDaHJvbWVkcml2ZXJzIChtYXBwaW5nKSB7XG4gICAgLy8gZ28gdGhyb3VnaCB0aGUgdmVyc2lvbnMgYXZhaWxhYmxlXG4gICAgY29uc3QgZXhlY3V0YWJsZXMgPSBhd2FpdCBmcy5nbG9iKGAke3RoaXMuZXhlY3V0YWJsZURpcn0vKmApO1xuICAgIGxvZy5kZWJ1ZyhgRm91bmQgJHtleGVjdXRhYmxlcy5sZW5ndGh9IGV4ZWN1dGFibGUke2V4ZWN1dGFibGVzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBgICtcbiAgICAgIGBpbiAnJHt0aGlzLmV4ZWN1dGFibGVEaXJ9J2ApO1xuICAgIGNvbnN0IGNkcyA9IChhd2FpdCBhc3luY21hcChleGVjdXRhYmxlcywgYXN5bmMgZnVuY3Rpb24gKGV4ZWN1dGFibGUpIHtcbiAgICAgIGNvbnN0IGxvZ0Vycm9yID0gKHttZXNzYWdlLCBzdGRvdXQgPSBudWxsLCBzdGRlcnIgPSBudWxsfSkgPT4ge1xuICAgICAgICBsZXQgZXJyTXNnID0gYENhbm5vdCByZXRyaWV2ZSB2ZXJzaW9uIG51bWJlciBmcm9tICcke3BhdGguYmFzZW5hbWUoZXhlY3V0YWJsZSl9JyBDaHJvbWVkcml2ZXIgYmluYXJ5LiBgICtcbiAgICAgICAgICBgTWFrZSBzdXJlIGl0IHJldHVybnMgYSB2YWxpZCB2ZXJzaW9uIHN0cmluZyBpbiByZXNwb25zZSB0byAnLS12ZXJzaW9uJyBjb21tYW5kIGxpbmUgYXJndW1lbnQuICR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAoc3Rkb3V0KSB7XG4gICAgICAgICAgZXJyTXNnICs9IGBcXG5TdGRvdXQ6ICR7c3Rkb3V0fWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZGVycikge1xuICAgICAgICAgIGVyck1zZyArPSBgXFxuU3RkZXJyOiAke3N0ZGVycn1gO1xuICAgICAgICB9XG4gICAgICAgIGxvZy53YXJuKGVyck1zZyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcblxuICAgICAgbGV0IHN0ZG91dDtcbiAgICAgIGxldCBzdGRlcnI7XG4gICAgICB0cnkge1xuICAgICAgICAoe3N0ZG91dCwgc3RkZXJyfSA9IGF3YWl0IGV4ZWMoZXhlY3V0YWJsZSwgWyctLXZlcnNpb24nXSwge1xuICAgICAgICAgIHRpbWVvdXQ6IENEX1ZFUlNJT05fVElNRU9VVCxcbiAgICAgICAgfSkpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmICghKGVyci5tZXNzYWdlIHx8ICcnKS5pbmNsdWRlcygndGltZWQgb3V0JykgJiYgIShlcnIuc3Rkb3V0IHx8ICcnKS5pbmNsdWRlcygnU3RhcnRpbmcgQ2hyb21lRHJpdmVyJykpIHtcbiAgICAgICAgICByZXR1cm4gbG9nRXJyb3IoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoaXMgaGFzIHRpbWVkIG91dCxpdCBoYXMgYWN0dWFsbHkgc3RhcnRlZCBDaHJvbWVkcml2ZXIsXG4gICAgICAgIC8vIGluIHdoaWNoIGNhc2UgdGhlcmUgd2lsbCBhbHNvIGJlIHRoZSB2ZXJzaW9uIHN0cmluZyBpbiB0aGUgb3V0cHV0XG4gICAgICAgIHN0ZG91dCA9IGVyci5zdGRvdXQ7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1hdGNoID0gL0Nocm9tZURyaXZlclxccytcXCg/dj8oW1xcZC5dKylcXCk/L2kuZXhlYyhzdGRvdXQpOyAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL3pwajV3QS8xXG4gICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHJldHVybiBsb2dFcnJvcih7bWVzc2FnZTogJ0Nhbm5vdCBwYXJzZSB0aGUgdmVyc2lvbiBzdHJpbmcnLCBzdGRvdXQsIHN0ZGVycn0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdmVyc2lvbk9iaiA9IHNlbXZlci5jb2VyY2UobWF0Y2hbMV0sIHRydWUpO1xuICAgICAgaWYgKCF2ZXJzaW9uT2JqKSB7XG4gICAgICAgIHJldHVybiBsb2dFcnJvcih7bWVzc2FnZTogJ0Nhbm5vdCBjb2VyY2UgdGhlIHZlcnNpb24gbnVtYmVyJywgc3Rkb3V0LCBzdGRlcnJ9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZlcnNpb24gPSBgJHt2ZXJzaW9uT2JqLm1ham9yfS4ke3ZlcnNpb25PYmoubWlub3J9YDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGV4ZWN1dGFibGUsXG4gICAgICAgIHZlcnNpb24sXG4gICAgICAgIG1pbkNEVmVyc2lvbjogbWFwcGluZ1t2ZXJzaW9uXSxcbiAgICAgIH07XG4gICAgfSkpXG4gICAgICAuZmlsdGVyKChjZCkgPT4gISFjZClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBzZW12ZXIuZ3RlKHNlbXZlci5jb2VyY2UoYi52ZXJzaW9uKSwgc2VtdmVyLmNvZXJjZShhLnZlcnNpb24pKSA/IDEgOiAtMSk7XG4gICAgaWYgKF8uaXNFbXB0eShjZHMpKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgTm8gQ2hyb21lZHJpdmVycyBmb3VuZCBpbiAnJHt0aGlzLmV4ZWN1dGFibGVEaXJ9J2ApO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYFRoZSBmb2xsb3dpbmcgQ2hyb21lZHJpdmVyIGV4ZWN1dGFibGVzIHdlcmUgZm91bmQ6YCk7XG4gICAgZm9yIChjb25zdCBjZCBvZiBjZHMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgICAgICR7Y2QuZXhlY3V0YWJsZX0gKG1pbmltdW0gQ2hyb21lIHZlcnNpb24gJyR7Y2QubWluQ0RWZXJzaW9uID8gY2QubWluQ0RWZXJzaW9uIDogJ1Vua25vd24nfScpYCk7XG4gICAgfVxuICAgIHJldHVybiBjZHM7XG4gIH1cblxuICBhc3luYyBnZXRDaHJvbWVWZXJzaW9uICgpIHtcbiAgICBsZXQgY2hyb21lVmVyc2lvbjtcblxuICAgIC8vIG9uIEFuZHJvaWQgNysgd2Vidmlld3MgYXJlIGJhY2tlZCBieSB0aGUgbWFpbiBDaHJvbWUsIG5vdCB0aGUgc3lzdGVtIHdlYnZpZXdcbiAgICBpZiAodGhpcy5hZGIgJiYgYXdhaXQgdGhpcy5hZGIuZ2V0QXBpTGV2ZWwoKSA+PSAyNCkge1xuICAgICAgdGhpcy5idW5kbGVJZCA9IENIUk9NRV9CVU5ETEVfSUQ7XG4gICAgfVxuXG4gICAgLy8gdHJ5IG91dCB3ZWJ2aWV3cyB3aGVuIG5vIGJ1bmRsZSBpZCBpcyBzZW50IGluXG4gICAgaWYgKCF0aGlzLmJ1bmRsZUlkKSB7XG4gICAgICAvLyBkZWZhdWx0IHRvIHRoZSBnZW5lcmljIENocm9tZSBidW5kbGVcbiAgICAgIHRoaXMuYnVuZGxlSWQgPSBDSFJPTUVfQlVORExFX0lEO1xuXG4gICAgICAvLyB3ZSBoYXZlIGEgd2VidmlldyBvZiBzb21lIHNvcnQsIHNvIHRyeSB0byBmaW5kIHRoZSBidW5kbGUgdmVyc2lvblxuICAgICAgZm9yIChjb25zdCBidW5kbGVJZCBvZiBXRUJWSUVXX0JVTkRMRV9JRFMpIHtcbiAgICAgICAgY2hyb21lVmVyc2lvbiA9IGF3YWl0IGdldENocm9tZVZlcnNpb24odGhpcy5hZGIsIGJ1bmRsZUlkKTtcbiAgICAgICAgaWYgKGNocm9tZVZlcnNpb24pIHtcbiAgICAgICAgICB0aGlzLmJ1bmRsZUlkID0gYnVuZGxlSWQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpZiB3ZSBkbyBub3QgaGF2ZSBhIGNocm9tZSB2ZXJzaW9uLCBpdCBtdXN0IG5vdCBiZSBhIHdlYnZpZXdcbiAgICBpZiAoIWNocm9tZVZlcnNpb24pIHtcbiAgICAgIGNocm9tZVZlcnNpb24gPSBhd2FpdCBnZXRDaHJvbWVWZXJzaW9uKHRoaXMuYWRiLCB0aGlzLmJ1bmRsZUlkKTtcbiAgICB9XG5cbiAgICAvLyBtYWtlIHN1cmUgaXQgaXMgc2VtdmVyLCBzbyBsYXRlciBjaGVja3Mgd29uJ3QgZmFpbFxuICAgIHJldHVybiBjaHJvbWVWZXJzaW9uID8gc2VtdmVyLmNvZXJjZShjaHJvbWVWZXJzaW9uKSA6IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRDb21wYXRpYmxlQ2hyb21lZHJpdmVyICgpIHtcbiAgICBpZiAoIXRoaXMuYWRiKSB7XG4gICAgICByZXR1cm4gYXdhaXQgZ2V0Q2hyb21lZHJpdmVyQmluYXJ5UGF0aCgpO1xuICAgIH1cblxuICAgIGNvbnN0IG1hcHBpbmcgPSBhd2FpdCB0aGlzLmdldE1hcHBpbmcoKTtcbiAgICBjb25zdCBjZHMgPSBhd2FpdCB0aGlzLmdldENocm9tZWRyaXZlcnMobWFwcGluZyk7XG5cbiAgICBjb25zdCBjaHJvbWVWZXJzaW9uID0gYXdhaXQgdGhpcy5nZXRDaHJvbWVWZXJzaW9uKCk7XG5cbiAgICBpZiAoIWNocm9tZVZlcnNpb24pIHtcbiAgICAgIC8vIHVuYWJsZSB0byBnZXQgdGhlIGNocm9tZSB2ZXJzaW9uXG4gICAgICBsZXQgY2QgPSBjZHNbMF07XG4gICAgICBsb2cud2FybihgVW5hYmxlIHRvIGRpc2NvdmVyIENocm9tZSB2ZXJzaW9uLiBVc2luZyBDaHJvbWVkcml2ZXIgJHtjZC52ZXJzaW9ufSBhdCAnJHtjZC5leGVjdXRhYmxlfSdgKTtcbiAgICAgIHJldHVybiBjZC5leGVjdXRhYmxlO1xuICAgIH1cblxuICAgIGxvZy5kZWJ1ZyhgRm91bmQgQ2hyb21lIGJ1bmRsZSAnJHt0aGlzLmJ1bmRsZUlkfScgdmVyc2lvbiAnJHtjaHJvbWVWZXJzaW9ufSdgKTtcblxuICAgIGlmIChzZW12ZXIuZ3QoY2hyb21lVmVyc2lvbiwgXy52YWx1ZXMobWFwcGluZylbMF0pICYmXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKGNkc1swXSkgJiYgXy5pc1VuZGVmaW5lZChjZHNbMF0ubWluQ0RWZXJzaW9uKSkge1xuICAgICAgLy8gdGhpcyBpcyBhIGNocm9tZSBhYm92ZSB0aGUgbGF0ZXN0IHZlcnNpb24gd2Uga25vdyBhYm91dCxcbiAgICAgIC8vIGFuZCB3ZSBoYXZlIGEgY2hyb21lZHJpdmVyIHRoYXQgaXMgYmV5b25kIHdoYXQgd2Uga25vdyxcbiAgICAgIC8vIHNvIHVzZSB0aGUgbW9zdCByZWNlbnQgY2hyb21lZHJpdmVyIHRoYXQgd2UgZm91bmRcbiAgICAgIGxldCBjZCA9IGNkc1swXTtcbiAgICAgIGxvZy53YXJuKGBObyBrbm93biBDaHJvbWVkcml2ZXIgYXZhaWxhYmxlIHRvIGF1dG9tYXRlIENocm9tZSB2ZXJzaW9uICcke2Nocm9tZVZlcnNpb259Jy5cXG5gICtcbiAgICAgICAgICAgICAgIGBVc2luZyBDaHJvbWVkcml2ZXIgdmVyc2lvbiAnJHtjZC52ZXJzaW9ufScsIHdoaWNoIGhhcyBub3QgYmVlbiB0ZXN0ZWQgd2l0aCBBcHBpdW0uYCk7XG4gICAgICByZXR1cm4gY2QuZXhlY3V0YWJsZTtcbiAgICB9XG5cbiAgICBjb25zdCB3b3JraW5nQ2RzID0gY2RzLmZpbHRlcigoY2QpID0+IHtcbiAgICAgIHJldHVybiAhXy5pc1VuZGVmaW5lZChjZC5taW5DRFZlcnNpb24pICYmIHNlbXZlci5ndGUoY2hyb21lVmVyc2lvbiwgY2QubWluQ0RWZXJzaW9uKTtcbiAgICB9KTtcblxuICAgIGlmIChfLmlzRW1wdHkod29ya2luZ0NkcykpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGBObyBDaHJvbWVkcml2ZXIgZm91bmQgdGhhdCBjYW4gYXV0b21hdGUgQ2hyb21lICcke2Nocm9tZVZlcnNpb259Jy4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgU2VlICR7Q0hST01FRFJJVkVSX1RVVE9SSUFMfSBmb3IgbW9yZSBkZXRhaWxzLmApO1xuICAgIH1cblxuICAgIGNvbnN0IGJpblBhdGggPSB3b3JraW5nQ2RzWzBdLmV4ZWN1dGFibGU7XG4gICAgbG9nLmRlYnVnKGBGb3VuZCAke3dvcmtpbmdDZHMubGVuZ3RofSBDaHJvbWVkcml2ZXIgZXhlY3V0YWJsZSR7d29ya2luZ0Nkcy5sZW5ndGggPT09IDEgPyAnJyA6ICdzJ30gYCArXG4gICAgICAgICAgICAgIGBjYXBhYmxlIG9mIGF1dG9tYXRpbmcgQ2hyb21lICcke2Nocm9tZVZlcnNpb259Jy5cXG5gICtcbiAgICAgICAgICAgICAgYENob29zaW5nIHRoZSBtb3N0IHJlY2VudCwgJyR7YmluUGF0aH0nLmApO1xuICAgIGxvZy5kZWJ1ZygnSWYgYSBzcGVjaWZpYyB2ZXJzaW9uIGlzIHJlcXVpcmVkLCBzcGVjaWZ5IGl0IHdpdGggdGhlIGBjaHJvbWVkcml2ZXJFeGVjdXRhYmxlYCcgK1xuICAgICAgICAgICAgICAnZGVzaXJlZCBjYXBhYmlsaXR5LicpO1xuICAgIHJldHVybiBiaW5QYXRoO1xuICB9XG5cbiAgYXN5bmMgaW5pdENocm9tZWRyaXZlclBhdGggKCkge1xuICAgIGlmICh0aGlzLmV4ZWN1dGFibGVWZXJpZmllZCkgcmV0dXJuOyAvL2VzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcblxuICAgIC8vIHRoZSBleGVjdXRhYmxlIG1pZ2h0IGJlIHNldCAoaWYgcGFzc2VkIGluKVxuICAgIC8vIG9yIHdlIG1pZ2h0IHdhbnQgdG8gdXNlIHRoZSBiYXNpYyBvbmUgaW5zdGFsbGVkIHdpdGggdGhpcyBkcml2ZXJcbiAgICAvLyBvciB3ZSB3YW50IHRvIGZpZ3VyZSBvdXQgdGhlIGJlc3Qgb25lXG4gICAgaWYgKCF0aGlzLmNocm9tZWRyaXZlcikge1xuICAgICAgdGhpcy5jaHJvbWVkcml2ZXIgPSB0aGlzLnVzZVN5c3RlbUV4ZWN1dGFibGVcbiAgICAgICAgPyBhd2FpdCBnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoKClcbiAgICAgICAgOiBhd2FpdCB0aGlzLmdldENvbXBhdGlibGVDaHJvbWVkcml2ZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyh0aGlzLmNocm9tZWRyaXZlcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVHJ5aW5nIHRvIHVzZSBhIGNocm9tZWRyaXZlciBiaW5hcnkgYXQgdGhlIHBhdGggYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7dGhpcy5jaHJvbWVkcml2ZXJ9LCBidXQgaXQgZG9lc24ndCBleGlzdCFgKTtcbiAgICB9XG4gICAgdGhpcy5leGVjdXRhYmxlVmVyaWZpZWQgPSB0cnVlO1xuICAgIGxvZy5pbmZvKGBTZXQgY2hyb21lZHJpdmVyIGJpbmFyeSBhczogJHt0aGlzLmNocm9tZWRyaXZlcn1gKTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0IChjYXBzLCBlbWl0U3RhcnRpbmdTdGF0ZSA9IHRydWUpIHtcbiAgICB0aGlzLmNhcGFiaWxpdGllcyA9IGNhcHM7XG4gICAgaWYgKGVtaXRTdGFydGluZ1N0YXRlKSB7XG4gICAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9TVEFSVElORyk7XG4gICAgfVxuXG4gICAgbGV0IGFyZ3MgPSBbXCItLXVybC1iYXNlPXdkL2h1YlwiLCBgLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9YF07XG4gICAgaWYgKHRoaXMuYWRiICYmIHRoaXMuYWRiLmFkYlBvcnQpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbYC0tYWRiLXBvcnQ9JHt0aGlzLmFkYi5hZGJQb3J0fWBdKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY21kQXJncykge1xuICAgICAgYXJncyA9IGFyZ3MuY29uY2F0KHRoaXMuY21kQXJncyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmxvZ1BhdGgpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbYC0tbG9nLXBhdGg9JHt0aGlzLmxvZ1BhdGh9YF0pO1xuICAgIH1cbiAgICBpZiAodGhpcy5kaXNhYmxlQnVpbGRDaGVjaykge1xuICAgICAgYXJncyA9IGFyZ3MuY29uY2F0KFsnLS1kaXNhYmxlLWJ1aWxkLWNoZWNrJ10pO1xuICAgIH1cbiAgICBhcmdzID0gYXJncy5jb25jYXQoWyctLXZlcmJvc2UnXSk7XG4gICAgLy8gd2hhdCBhcmUgdGhlIHByb2Nlc3Mgc3Rkb3V0L3N0ZGVyciBjb25kaXRpb25zIHdoZXJlaW4gd2Uga25vdyB0aGF0XG4gICAgLy8gdGhlIHByb2Nlc3MgaGFzIHN0YXJ0ZWQgdG8gb3VyIHNhdGlzZmFjdGlvbj9cbiAgICBjb25zdCBzdGFydERldGVjdG9yID0gKHN0ZG91dCkgPT4ge1xuICAgICAgcmV0dXJuIHN0ZG91dC5pbmRleE9mKCdTdGFydGluZyAnKSA9PT0gMDtcbiAgICB9O1xuXG4gICAgbGV0IHByb2Nlc3NJc0FsaXZlID0gZmFsc2U7XG4gICAgbGV0IHdlYnZpZXdWZXJzaW9uO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRDaHJvbWVkcml2ZXJQYXRoKCk7XG4gICAgICBhd2FpdCB0aGlzLmtpbGxBbGwoKTtcblxuICAgICAgLy8gc2V0IHVwIG91ciBzdWJwcm9jZXNzIG9iamVjdFxuICAgICAgdGhpcy5wcm9jID0gbmV3IFN1YlByb2Nlc3ModGhpcy5jaHJvbWVkcml2ZXIsIGFyZ3MpO1xuICAgICAgcHJvY2Vzc0lzQWxpdmUgPSB0cnVlO1xuXG4gICAgICAvLyBoYW5kbGUgbG9nIG91dHB1dFxuICAgICAgdGhpcy5wcm9jLm9uKCdvdXRwdXQnLCAoc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICAgICAgLy8gaWYgdGhlIGNkIG91dHB1dCBpcyBub3QgcHJpbnRlZCwgZmluZCB0aGUgY2hyb21lIHZlcnNpb24gYW5kIHByaW50XG4gICAgICAgIC8vIHdpbGwgZ2V0IGEgcmVzcG9uc2UgbGlrZVxuICAgICAgICAvLyAgIERldlRvb2xzIHJlc3BvbnNlOiB7XG4gICAgICAgIC8vICAgICAgXCJBbmRyb2lkLVBhY2thZ2VcIjogXCJpby5hcHBpdW0uc2FtcGxlYXBwXCIsXG4gICAgICAgIC8vICAgICAgXCJCcm93c2VyXCI6IFwiQ2hyb21lLzU1LjAuMjg4My45MVwiLFxuICAgICAgICAvLyAgICAgIFwiUHJvdG9jb2wtVmVyc2lvblwiOiBcIjEuMlwiLFxuICAgICAgICAvLyAgICAgIFwiVXNlci1BZ2VudFwiOiBcIi4uLlwiLFxuICAgICAgICAvLyAgICAgIFwiV2ViS2l0LVZlcnNpb25cIjogXCI1MzcuMzZcIlxuICAgICAgICAvLyAgIH1cbiAgICAgICAgY29uc3Qgb3V0ID0gc3Rkb3V0ICsgc3RkZXJyO1xuICAgICAgICBsZXQgbWF0Y2ggPSAvXCJCcm93c2VyXCI6IFwiKC4qKVwiLy5leGVjKG91dCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIHdlYnZpZXdWZXJzaW9uID0gbWF0Y2hbMV07XG4gICAgICAgICAgbG9nLmRlYnVnKGBXZWJ2aWV3IHZlcnNpb246ICcke3dlYnZpZXdWZXJzaW9ufSdgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFsc28gcHJpbnQgY2hyb21lZHJpdmVyIHZlcnNpb24gdG8gbG9nc1xuICAgICAgICAvLyB3aWxsIG91dHB1dCBzb21ldGhpbmcgbGlrZVxuICAgICAgICAvLyAgU3RhcnRpbmcgQ2hyb21lRHJpdmVyIDIuMzMuNTA2MTA2ICg4YTA2YzM5YzQ1ODJmYmZiYWI2OTY2ZGJiMWMzOGE5MTczYmZiMWEyKSBvbiBwb3J0IDk1MTVcbiAgICAgICAgbWF0Y2ggPSAvU3RhcnRpbmcgQ2hyb21lRHJpdmVyIChbLlxcZF0rKS8uZXhlYyhvdXQpO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICBsb2cuZGVidWcoYENocm9tZWRyaXZlciB2ZXJzaW9uOiAnJHttYXRjaFsxXX0nYCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBnaXZlIHRoZSBvdXRwdXQgaWYgaXQgaXMgcmVxdWVzdGVkXG4gICAgICAgIGlmICh0aGlzLnZlcmJvc2UpIHtcbiAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIChzdGRvdXQgfHwgJycpLnRyaW0oKS5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgICAgIGlmICghbGluZS50cmltKCkubGVuZ3RoKSBjb250aW51ZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgICAgICAgICAgbG9nLmRlYnVnKGBbU1RET1VUXSAke2xpbmV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAobGV0IGxpbmUgb2YgKHN0ZGVyciB8fCAnJykudHJpbSgpLnNwbGl0KCdcXG4nKSkge1xuICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKS5sZW5ndGgpIGNvbnRpbnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtTVERFUlJdICR7bGluZX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBoYW5kbGUgb3V0LW9mLWJvdW5kIGV4aXQgYnkgc2ltcGx5IGVtaXR0aW5nIGEgc3RvcHBlZCBzdGF0ZVxuICAgICAgdGhpcy5wcm9jLm9uKCdleGl0JywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgICAgICBwcm9jZXNzSXNBbGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9TVE9QUElORyAmJlxuICAgICAgICAgICAgdGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcpIHtcbiAgICAgICAgICBsZXQgbXNnID0gYENocm9tZWRyaXZlciBleGl0ZWQgdW5leHBlY3RlZGx5IHdpdGggY29kZSAke2NvZGV9LCBgICtcbiAgICAgICAgICAgICAgICAgICAgYHNpZ25hbCAke3NpZ25hbH1gO1xuICAgICAgICAgIGxvZy5lcnJvcihtc2cpO1xuICAgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxvZy5pbmZvKGBTcGF3bmluZyBjaHJvbWVkcml2ZXIgd2l0aDogJHt0aGlzLmNocm9tZWRyaXZlcn0gYCArXG4gICAgICAgICAgICAgICBgJHthcmdzLmpvaW4oJyAnKX1gKTtcbiAgICAgIC8vIHN0YXJ0IHN1YnByb2MgYW5kIHdhaXQgZm9yIHN0YXJ0RGV0ZWN0b3JcbiAgICAgIGF3YWl0IHRoaXMucHJvYy5zdGFydChzdGFydERldGVjdG9yKTtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvck9ubGluZSgpO1xuICAgICAgYXdhaXQgdGhpcy5zdGFydFNlc3Npb24oKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmVtaXQoQ2hyb21lZHJpdmVyLkVWRU5UX0VSUk9SLCBlKTtcbiAgICAgIC8vIGp1c3QgYmVjYXVzZSB3ZSBoYWQgYW4gZXJyb3IgZG9lc24ndCBtZWFuIHRoZSBjaHJvbWVkcml2ZXIgcHJvY2Vzc1xuICAgICAgLy8gZmluaXNoZWQ7IHdlIHNob3VsZCBjbGVhbiB1cCBpZiBuZWNlc3NhcnlcbiAgICAgIGlmIChwcm9jZXNzSXNBbGl2ZSkge1xuICAgICAgICBhd2FpdCB0aGlzLnByb2Muc3RvcCgpO1xuICAgICAgfVxuXG4gICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgLy8gb2Z0ZW4gdGhlIHVzZXIncyBDaHJvbWUgdmVyc2lvbiBpcyB0b28gbG93IGZvciB0aGUgdmVyc2lvbiBvZiBDaHJvbWVkcml2ZXJcbiAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoJ0Nocm9tZSB2ZXJzaW9uIG11c3QgYmUnKSkge1xuICAgICAgICBtZXNzYWdlICs9ICdVbmFibGUgdG8gYXV0b21hdGUgQ2hyb21lIHZlcnNpb24gYmVjYXVzZSBpdCBpcyB0b28gb2xkIGZvciB0aGlzIHZlcnNpb24gb2YgQ2hyb21lZHJpdmVyLlxcbic7XG4gICAgICAgIGlmICh3ZWJ2aWV3VmVyc2lvbikge1xuICAgICAgICAgIG1lc3NhZ2UgKz0gYENocm9tZSB2ZXJzaW9uIG9uIHRoZSBkZXZpY2U6ICR7d2Vidmlld1ZlcnNpb259XFxuYDtcbiAgICAgICAgfVxuICAgICAgICBtZXNzYWdlICs9IGBWaXNpdCAnJHtDSFJPTUVEUklWRVJfVFVUT1JJQUx9JyB0byB0cm91Ymxlc2hvb3QgdGhlIHByb2JsZW0uXFxuYDtcbiAgICAgIH1cblxuICAgICAgbWVzc2FnZSArPSBlLm1lc3NhZ2U7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhtZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICBzZXNzaW9uSWQgKCkge1xuICAgIGlmICh0aGlzLnN0YXRlICE9PSBDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5qd3Byb3h5LnNlc3Npb25JZDtcbiAgfVxuXG4gIGFzeW5jIHJlc3RhcnQgKCkge1xuICAgIGxvZy5pbmZvKFwiUmVzdGFydGluZyBjaHJvbWVkcml2ZXJcIik7XG4gICAgaWYgKHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9PTkxJTkUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IHJlc3RhcnQgd2hlbiB3ZSdyZSBub3Qgb25saW5lXCIpO1xuICAgIH1cbiAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9SRVNUQVJUSU5HKTtcbiAgICBhd2FpdCB0aGlzLnN0b3AoZmFsc2UpO1xuICAgIGF3YWl0IHRoaXMuc3RhcnQodGhpcy5jYXBhYmlsaXRpZXMsIGZhbHNlKTtcbiAgfVxuXG4gIGFzeW5jIHdhaXRGb3JPbmxpbmUgKCkge1xuICAgIC8vIHdlIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgQ0QgaGFzbid0IGNyYXNoZWRcbiAgICBsZXQgY2hyb21lZHJpdmVyU3RvcHBlZCA9IGZhbHNlO1xuICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoMjAsIDIwMCwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IENocm9tZWRyaXZlci5TVEFURV9TVE9QUEVEKSB7XG4gICAgICAgIC8vIHdlIGFyZSBlaXRoZXIgc3RvcHBlZCBvciBzdG9wcGluZywgc28gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgICAgICAgY2hyb21lZHJpdmVyU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMuZ2V0U3RhdHVzKCk7XG4gICAgfSk7XG4gICAgaWYgKGNocm9tZWRyaXZlclN0b3BwZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2hyb21lRHJpdmVyIGNyYXNoZWQgZHVyaW5nIHN0YXJ0dXAuJyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0U3RhdHVzICgpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5qd3Byb3h5LmNvbW1hbmQoJy9zdGF0dXMnLCAnR0VUJyk7XG4gIH1cblxuICBhc3luYyBzdGFydFNlc3Npb24gKCkge1xuICAgIC8vIHJldHJ5IHNlc3Npb24gc3RhcnQgNCB0aW1lcywgc29tZXRpbWVzIHRoaXMgZmFpbHMgZHVlIHRvIGFkYlxuICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoNCwgMjAwLCBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5qd3Byb3h5LmNvbW1hbmQoJy9zZXNzaW9uJywgJ1BPU1QnLCB7ZGVzaXJlZENhcGFiaWxpdGllczogdGhpcy5jYXBhYmlsaXRpZXN9KTtcbiAgICAgICAgLy8gQ2hyb21lRHJpdmVyIGNhbiByZXR1cm4gYSBwb3NpdGl2ZSBzdGF0dXMgZGVzcGl0ZSBmYWlsaW5nXG4gICAgICAgIGlmIChyZXMuc3RhdHVzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy52YWx1ZS5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBGYWlsZWQgdG8gc3RhcnQgQ2hyb21lZHJpdmVyIHNlc3Npb246ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKTtcbiAgfVxuXG4gIGFzeW5jIHN0b3AgKGVtaXRTdGF0ZXMgPSB0cnVlKSB7XG4gICAgaWYgKGVtaXRTdGF0ZXMpIHtcbiAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQSU5HKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcnLCAnREVMRVRFJyk7XG4gICAgICBhd2FpdCB0aGlzLnByb2Muc3RvcCgnU0lHVEVSTScsIDIwMDAwKTtcbiAgICAgIGlmIChlbWl0U3RhdGVzKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5lcnJvcihlKTtcbiAgICB9XG4gIH1cblxuICBjaGFuZ2VTdGF0ZSAoc3RhdGUpIHtcbiAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgbG9nLmRlYnVnKGBDaGFuZ2VkIHN0YXRlIHRvICcke3N0YXRlfSdgKTtcbiAgICB0aGlzLmVtaXQoQ2hyb21lZHJpdmVyLkVWRU5UX0NIQU5HRUQsIHtzdGF0ZX0pO1xuICB9XG5cbiAgYXN5bmMgc2VuZENvbW1hbmQgKHVybCwgbWV0aG9kLCBib2R5KSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKHVybCwgbWV0aG9kLCBib2R5KTtcbiAgfVxuXG4gIGFzeW5jIHByb3h5UmVxIChyZXEsIHJlcykge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmp3cHJveHkucHJveHlSZXFSZXMocmVxLCByZXMpO1xuICB9XG5cbiAgYXN5bmMga2lsbEFsbCAoKSB7XG4gICAgbGV0IGNtZCA9IHN5c3RlbS5pc1dpbmRvd3MoKVxuICAgICAgPyBgd21pYyBwcm9jZXNzIHdoZXJlIFwiY29tbWFuZGxpbmUgbGlrZSAnJWNocm9tZWRyaXZlci5leGUlLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9JSdcIiBkZWxldGVgXG4gICAgICA6IGBwa2lsbCAtMTUgLWYgXCIke3RoaXMuY2hyb21lZHJpdmVyfS4qLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9XCJgO1xuICAgIGxvZy5kZWJ1ZyhgS2lsbGluZyBhbnkgb2xkIGNocm9tZWRyaXZlcnMsIHJ1bm5pbmc6ICR7Y21kfWApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCAoQi5wcm9taXNpZnkoY3AuZXhlYykpKGNtZCk7XG4gICAgICBsb2cuZGVidWcoXCJTdWNjZXNzZnVsbHkgY2xlYW5lZCB1cCBvbGQgY2hyb21lZHJpdmVyc1wiKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKFwiTm8gb2xkIGNocm9tZWRyaXZlcnMgc2VlbWVkIHRvIGV4aXN0XCIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFkYikge1xuICAgICAgbG9nLmRlYnVnKGBDbGVhbmluZyBhbnkgb2xkIGFkYiBmb3J3YXJkZWQgcG9ydCBzb2NrZXQgY29ubmVjdGlvbnNgKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAobGV0IGNvbm4gb2YgYXdhaXQgdGhpcy5hZGIuZ2V0Rm9yd2FyZExpc3QoKSkge1xuICAgICAgICAgIC8vIGNocm9tZWRyaXZlciB3aWxsIGFzayBBREIgdG8gZm9yd2FyZCBhIHBvcnQgbGlrZSBcImRldmljZUlkIHRjcDpwb3J0IGxvY2FsYWJzdHJhY3Q6d2Vidmlld19kZXZ0b29sc19yZW1vdGVfcG9ydFwiXG4gICAgICAgICAgaWYgKGNvbm4uaW5kZXhPZignd2Vidmlld19kZXZ0b29scycpICE9PSAtMSkge1xuICAgICAgICAgICAgbGV0IHBhcmFtcyA9IGNvbm4uc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFkYi5yZW1vdmVQb3J0Rm9yd2FyZChwYXJhbXNbMV0ucmVwbGFjZSgvW1xcRF0qLywgJycpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cud2FybihgVW5hYmxlIHRvIGNsZWFuIGZvcndhcmRlZCBwb3J0cy4gRXJyb3I6ICcke2Vyci5tZXNzYWdlfScuIENvbnRpbnVpbmcuYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFzV29ya2luZ1dlYnZpZXcgKCkge1xuICAgIC8vIHNvbWV0aW1lcyBjaHJvbWVkcml2ZXIgc3RvcHMgYXV0b21hdGluZyB3ZWJ2aWV3cy4gdGhpcyBtZXRob2QgcnVucyBhXG4gICAgLy8gc2ltcGxlIGNvbW1hbmQgdG8gZGV0ZXJtaW5lIG91ciBzdGF0ZSwgYW5kIHJlc3BvbmRzIGFjY29yZGluZ2x5XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvdXJsJywgJ0dFVCcpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG5DaHJvbWVkcml2ZXIuRVZFTlRfRVJST1IgPSAnY2hyb21lZHJpdmVyX2Vycm9yJztcbkNocm9tZWRyaXZlci5FVkVOVF9DSEFOR0VEID0gJ3N0YXRlQ2hhbmdlZCc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCA9ICdzdG9wcGVkJztcbkNocm9tZWRyaXZlci5TVEFURV9TVEFSVElORyA9ICdzdGFydGluZyc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FID0gJ29ubGluZSc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBJTkcgPSAnc3RvcHBpbmcnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcgPSAncmVzdGFydGluZyc7XG5cbmV4cG9ydCB7XG4gIENocm9tZWRyaXZlciwgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HLCBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyLCBDRF9WRVIsXG59O1xuZXhwb3J0IGRlZmF1bHQgQ2hyb21lZHJpdmVyO1xuIl0sImZpbGUiOiJsaWIvY2hyb21lZHJpdmVyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
