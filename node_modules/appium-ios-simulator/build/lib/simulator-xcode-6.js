"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SPRINGBOARD_BUNDLE_ID = exports.BOOT_COMPLETED_EVENT = exports.SimulatorXcode6 = exports.default = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _path = _interopRequireDefault(require("path"));

var simctl = _interopRequireWildcard(require("node-simctl"));

var _appiumXcode = _interopRequireWildcard(require("appium-xcode"));

var _logger = _interopRequireDefault(require("./logger"));

var _appiumSupport = require("appium-support");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _lodash = _interopRequireDefault(require("lodash"));

var _asyncLock = _interopRequireDefault(require("async-lock"));

var _utils = require("./utils.js");

var _asyncbox = require("asyncbox");

var settings = _interopRequireWildcard(require("./settings"));

var _teen_process = require("teen_process");

var _tailUntil = require("./tail-until.js");

var _index = _interopRequireDefault(require("./extensions/index"));

var _events = require("events");

var _calendar = _interopRequireDefault(require("./calendar"));

var _permissions = _interopRequireDefault(require("./permissions"));

const STARTUP_TIMEOUT = 60 * 1000;
const EXTRA_STARTUP_TIME = 2000;
const UI_CLIENT_ACCESS_GUARD = new _asyncLock.default();
const UI_CLIENT_BUNDLE_ID = 'com.apple.iphonesimulator';
const SPRINGBOARD_BUNDLE_ID = 'com.apple.SpringBoard';
exports.SPRINGBOARD_BUNDLE_ID = SPRINGBOARD_BUNDLE_ID;
const BOOT_COMPLETED_EVENT = 'bootCompleted';
exports.BOOT_COMPLETED_EVENT = BOOT_COMPLETED_EVENT;

class SimulatorXcode6 extends _events.EventEmitter {
  constructor(udid, xcodeVersion) {
    super();
    this.udid = String(udid);
    this.xcodeVersion = xcodeVersion;
    this._platformVersion = null;
    this.keychainPath = _path.default.resolve(this.getDir(), 'Library', 'Keychains');
    this.simulatorApp = 'iOS Simulator.app';
    this.appDataBundlePaths = {};
    this.isFreshFiles = ['Library/ConfigurationProfiles', 'Library/Cookies', 'Library/Preferences/.GlobalPreferences.plist', 'Library/Preferences/com.apple.springboard.plist', 'var/run/syslog.pid'];
    this.extraStartupTime = EXTRA_STARTUP_TIME;
    this.calendar = new _calendar.default(xcodeVersion, this.getDir());
    this.permissions = new _permissions.default(xcodeVersion, this.getDir(), this.udid);
  }

  get uiClientBundleId() {
    return UI_CLIENT_BUNDLE_ID;
  }

  getUIClientPid() {
    var _this = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let stdout;

      try {
        var _ref = yield (0, _teen_process.exec)('osascript', ['-e', `tell application "System Events" to unix id of processes whose bundle identifier is "${_this.uiClientBundleId}"`]);

        stdout = _ref.stdout;
      } catch (e) {
        try {
          var _ref2 = yield (0, _teen_process.exec)('pgrep', ['-xni', _this.simulatorApp.split('.')[0]]);

          stdout = _ref2.stdout;
        } catch (e1) {
          return null;
        }
      }

      if (isNaN(parseInt(stdout, 10))) {
        return null;
      }

      stdout = stdout.trim();

      _logger.default.debug(`Got Simulator UI client PID: ${stdout}`);

      return stdout;
    })();
  }

  isUIClientRunning() {
    var _this2 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return !_lodash.default.isNull((yield _this2.getUIClientPid()));
    })();
  }

  get startupTimeout() {
    return STARTUP_TIMEOUT;
  }

  getPlatformVersion() {
    var _this3 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (!_this3._platformVersion) {
        let _ref3 = yield _this3.stat(),
            sdk = _ref3.sdk;

        _this3._platformVersion = sdk;
      }

      return _this3._platformVersion;
    })();
  }

  getRootDir() {
    let home = process.env.HOME;
    return _path.default.resolve(home, 'Library', 'Developer', 'CoreSimulator', 'Devices');
  }

  getDir() {
    return _path.default.resolve(this.getRootDir(), this.udid, 'data');
  }

  getLogDir() {
    let home = process.env.HOME;
    return _path.default.resolve(home, 'Library', 'Logs', 'CoreSimulator', this.udid);
  }

  installApp(app) {
    var _this4 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield simctl.installApp(_this4.udid, app);
    })();
  }

  isAppInstalled(bundleId, appFile = null) {
    var _this5 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let appDirs = yield _this5.getAppDirs(appFile, bundleId);
      return appDirs.length !== 0;
    })();
  }

  getAppDir(id, subDir = 'Data') {
    var _this6 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _this6.appDataBundlePaths[subDir] = _this6.appDataBundlePaths[subDir] || {};

      if (_lodash.default.isEmpty(_this6.appDataBundlePaths[subDir]) && !(yield _this6.isFresh())) {
        _this6.appDataBundlePaths[subDir] = yield _this6.buildBundlePathMap(subDir);
      }

      return _this6.appDataBundlePaths[subDir][id];
    })();
  }

  buildBundlePathMap(subDir = 'Data') {
    var _this7 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Building bundle path map');

      let applicationList;
      let pathBundlePair;

      if ((yield _this7.getPlatformVersion()) === '7.1') {
        applicationList = _path.default.resolve(_this7.getDir(), 'Applications');

        pathBundlePair = function () {
          var _ref4 = (0, _asyncToGenerator2.default)(function* (dir) {
            dir = _path.default.resolve(applicationList, dir);
            let appFiles = yield _appiumSupport.fs.glob(`${dir}/*.app`);
            let bundleId = appFiles[0].match(/.*\/(.*)\.app/)[1];
            return {
              path: dir,
              bundleId
            };
          });

          return function pathBundlePair(_x) {
            return _ref4.apply(this, arguments);
          };
        }();
      } else {
        applicationList = _path.default.resolve(_this7.getDir(), 'Containers', subDir, 'Application');

        let readBundleId = function () {
          var _ref5 = (0, _asyncToGenerator2.default)(function* (dir) {
            let plist = _path.default.resolve(dir, '.com.apple.mobile_container_manager.metadata.plist');

            let metadata = yield settings.read(plist);
            return metadata.MCMMetadataIdentifier;
          });

          return function readBundleId(_x2) {
            return _ref5.apply(this, arguments);
          };
        }();

        pathBundlePair = function () {
          var _ref6 = (0, _asyncToGenerator2.default)(function* (dir) {
            dir = _path.default.resolve(applicationList, dir);
            let bundleId = yield readBundleId(dir);
            return {
              path: dir,
              bundleId
            };
          });

          return function pathBundlePair(_x3) {
            return _ref6.apply(this, arguments);
          };
        }();
      }

      let bundlePathDirs = yield _appiumSupport.fs.readdir(applicationList);
      let bundlePathPairs = yield (0, _asyncbox.asyncmap)(bundlePathDirs, function () {
        var _ref7 = (0, _asyncToGenerator2.default)(function* (dir) {
          return yield pathBundlePair(dir);
        });

        return function (_x4) {
          return _ref7.apply(this, arguments);
        };
      }(), false);
      return bundlePathPairs.reduce((bundleMap, bundlePath) => {
        bundleMap[bundlePath.bundleId] = bundlePath.path;
        return bundleMap;
      }, {});
    })();
  }

  stat() {
    var _this8 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = _lodash.default.toPairs((yield simctl.getDevices()))[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          let _step$value = (0, _slicedToArray2.default)(_step.value, 2),
              sdk = _step$value[0],
              deviceArr = _step$value[1];

          var _iteratorNormalCompletion2 = true;
          var _didIteratorError2 = false;
          var _iteratorError2 = undefined;

          try {
            for (var _iterator2 = deviceArr[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
              let device = _step2.value;

              if (device.udid === _this8.udid) {
                device.sdk = sdk;
                return device;
              }
            }
          } catch (err) {
            _didIteratorError2 = true;
            _iteratorError2 = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
                _iterator2.return();
              }
            } finally {
              if (_didIteratorError2) {
                throw _iteratorError2;
              }
            }
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return != null) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return {};
    })();
  }

  isFresh() {
    var _this9 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let files = _this9.isFreshFiles;
      let pv = yield _this9.getPlatformVersion();

      if (pv !== '7.1') {
        files.push('Library/Preferences/com.apple.Preferences.plist');
      } else {
        files.push('Applications');
      }

      const dir = _this9.getDir();

      files = files.map(s => _path.default.resolve(dir, s));
      const existences = yield (0, _asyncbox.asyncmap)(files, function () {
        var _ref8 = (0, _asyncToGenerator2.default)(function* (f) {
          return yield _appiumSupport.fs.hasAccess(f);
        });

        return function (_x5) {
          return _ref8.apply(this, arguments);
        };
      }());
      const fresh = _lodash.default.compact(existences).length !== files.length;

      _logger.default.debug(`Checking whether simulator has been run before: ${fresh ? 'no' : 'yes'}`);

      return fresh;
    })();
  }

  isRunning() {
    var _this10 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let stat = yield _this10.stat();
      return stat.state === 'Booted';
    })();
  }

  waitForBoot(startupTimeout) {
    var _this11 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let bootedIndicator = yield _this11.getBootedIndicatorString();
      yield _this11.tailLogsUntil(bootedIndicator, startupTimeout);

      _logger.default.debug(`Waiting an extra ${_this11.extraStartupTime}ms for the simulator to really finish booting`);

      yield _bluebird.default.delay(_this11.extraStartupTime);

      _logger.default.debug('Done waiting extra time for simulator');

      _this11.emit(BOOT_COMPLETED_EVENT);
    })();
  }

  getBootedIndicatorString() {
    var _this12 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let indicator;
      let platformVersion = yield _this12.getPlatformVersion();

      switch (platformVersion) {
        case '7.1':
        case '8.1':
        case '8.2':
        case '8.3':
        case '8.4':
          indicator = 'profiled: Service starting...';
          break;

        case '9.0':
        case '9.1':
        case '9.2':
        case '9.3':
          indicator = 'System app "com.apple.springboard" finished startup';
          break;

        case '10.0':
          indicator = 'Switching to keyboard';
          break;

        default:
          _logger.default.warn(`No boot indicator case for platform version '${platformVersion}'`);

          indicator = 'no boot indicator string available';
      }

      return indicator;
    })();
  }

  startUIClient(opts = {}) {
    var _this13 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      opts = Object.assign({
        scaleFactor: null,
        connectHardwareKeyboard: false,
        startupTimeout: _this13.startupTimeout
      }, opts);

      const simulatorApp = _path.default.resolve((yield (0, _appiumXcode.getPath)()), 'Applications', _this13.simulatorApp);

      const args = ['-Fn', simulatorApp, '--args', '-CurrentDeviceUDID', _this13.udid];

      if (opts.scaleFactor) {
        const stat = yield _this13.stat();
        const formattedDeviceName = stat.name.replace(/\s+/g, '-');
        const argumentName = `-SimulatorWindowLastScale-com.apple.CoreSimulator.SimDeviceType.${formattedDeviceName}`;
        args.push(argumentName, opts.scaleFactor);
      }

      if (_lodash.default.isBoolean(opts.connectHardwareKeyboard)) {
        args.push('-ConnectHardwareKeyboard', opts.connectHardwareKeyboard ? '1' : '0');
      }

      _logger.default.info(`Starting Simulator UI with command: open ${args.join(' ')}`);

      try {
        yield (0, _teen_process.exec)('open', args, {
          timeout: opts.startupTimeout
        });
      } catch (err) {
        if (!(err.stdout || '').includes('-10825') && !(err.stderr || '').includes('-10825')) {
          throw err;
        }

        _logger.default.warn(`Error while opening UI: ${err.stdout || err.stderr}. Continuing`);
      }
    })();
  }

  run(opts = {}) {
    var _this14 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      opts = Object.assign({
        startupTimeout: _this14.startupTimeout
      }, opts);

      const _ref9 = yield _this14.stat(),
            state = _ref9.state;

      const isServerRunning = state === 'Booted';
      const isUIClientRunning = yield _this14.isUIClientRunning();

      if (isServerRunning && isUIClientRunning) {
        _logger.default.info(`Both Simulator with UDID ${_this14.udid} and the UI client are currently running`);

        return;
      }

      const startTime = process.hrtime();

      try {
        yield _this14.shutdown();
      } catch (err) {
        _logger.default.warn(`Error on Simulator shutdown: ${err.message}`);
      }

      yield _this14.startUIClient(opts);
      yield _this14.waitForBoot(opts.startupTimeout);

      _logger.default.info(`Simulator with UDID ${_this14.udid} booted in ${process.hrtime(startTime)[0]} seconds`);
    })();
  }

  clean() {
    var _this15 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this15.endSimulatorDaemon();

      _logger.default.info(`Cleaning simulator ${_this15.udid}`);

      yield simctl.eraseDevice(_this15.udid, 10000);
    })();
  }

  scrubCustomApp(appFile, appBundleId) {
    var _this16 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield _this16.cleanCustomApp(appFile, appBundleId, true);
    })();
  }

  cleanCustomApp(appFile, appBundleId, scrub = false) {
    var _this17 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug(`Cleaning app data files for '${appFile}', '${appBundleId}'`);

      if (!scrub) {
        _logger.default.debug(`Deleting app altogether`);
      }

      let appDirs = yield _this17.getAppDirs(appFile, appBundleId, scrub);

      if (appDirs.length === 0) {
        _logger.default.debug("Could not find app directories to delete. It is probably not installed");

        return;
      }

      let deletePromises = [];
      var _iteratorNormalCompletion3 = true;
      var _didIteratorError3 = false;
      var _iteratorError3 = undefined;

      try {
        for (var _iterator3 = appDirs[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
          let dir = _step3.value;

          _logger.default.debug(`Deleting directory: '${dir}'`);

          deletePromises.push(_appiumSupport.fs.rimraf(dir));
        }
      } catch (err) {
        _didIteratorError3 = true;
        _iteratorError3 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {
            _iterator3.return();
          }
        } finally {
          if (_didIteratorError3) {
            throw _iteratorError3;
          }
        }
      }

      if ((yield _this17.getPlatformVersion()) >= 8) {
        let relRmPath = `Library/Preferences/${appBundleId}.plist`;

        let rmPath = _path.default.resolve(_this17.getRootDir(), relRmPath);

        _logger.default.debug(`Deleting file: '${rmPath}'`);

        deletePromises.push(_appiumSupport.fs.rimraf(rmPath));
      }

      yield _bluebird.default.all(deletePromises);
    })();
  }

  getAppDirs(appFile, appBundleId, scrub = false) {
    var _this18 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let dirs = [];

      if ((yield _this18.getPlatformVersion()) >= 8) {
        let data = yield _this18.getAppDir(appBundleId);
        if (!data) return dirs;
        let bundle = !scrub ? yield _this18.getAppDir(appBundleId, 'Bundle') : undefined;
        var _arr = [data, bundle];

        for (var _i = 0; _i < _arr.length; _i++) {
          let src = _arr[_i];

          if (src) {
            dirs.push(src);
          }
        }
      } else {
        let data = yield _this18.getAppDir(appFile);

        if (data) {
          dirs.push(data);
        }
      }

      return dirs;
    })();
  }

  launchAndQuit(safari = false, startupTimeout = this.startupTimeout) {
    var _this19 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Attempting to launch and quit the simulator, to create directory structure');

      _logger.default.debug(`Will launch with Safari? ${safari}`);

      yield _this19.run(startupTimeout);

      if (safari) {
        yield _this19.openUrl('http://www.appium.io');
      }

      try {
        yield (0, _asyncbox.retryInterval)(60, 250, (0, _asyncToGenerator2.default)(function* () {
          if (yield _this19.isFresh()) {
            throw new Error('Simulator files not fully created. Waiting a bit');
          }
        }));
      } catch (err) {
        _logger.default.warn(`Timeout waiting for simulator files to be created. Continuing`);
      }

      yield _this19.shutdown();
    })();
  }

  endSimulatorDaemon() {
    var _this20 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug(`Killing any simulator daemons for ${_this20.udid}`);

      let launchctlCmd = `launchctl list | grep ${_this20.udid} | cut -f 3 | xargs -n 1 launchctl`;

      try {
        let stopCmd = `${launchctlCmd} stop`;
        yield (0, _teen_process.exec)('bash', ['-c', stopCmd]);
      } catch (err) {
        _logger.default.warn(`Could not stop simulator daemons: ${err.message}`);

        _logger.default.debug('Carrying on anyway!');
      }

      try {
        let removeCmd = `${launchctlCmd} remove`;
        yield (0, _teen_process.exec)('bash', ['-c', removeCmd]);
      } catch (err) {
        _logger.default.warn(`Could not remove simulator daemons: ${err.message}`);

        _logger.default.debug('Carrying on anyway!');
      }

      try {
        yield (0, _asyncbox.waitForCondition)((0, _asyncToGenerator2.default)(function* () {
          let _ref12 = yield (0, _teen_process.exec)('bash', ['-c', `ps -e  | grep ${_this20.udid} | grep launchd_sim | grep -v bash | grep -v grep | awk {'print$1'}`]),
              stdout = _ref12.stdout;

          return stdout.trim().length === 0;
        }), {
          waitMs: 10000,
          intervalMs: 500
        });
      } catch (err) {
        _logger.default.warn(`Could not end simulator daemon for ${_this20.udid}: ${err.message}`);

        _logger.default.debug('Carrying on anyway!');
      }
    })();
  }

  shutdown() {
    return (0, _asyncToGenerator2.default)(function* () {
      yield (0, _utils.killAllSimulators)();
    })();
  }

  delete() {
    var _this21 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield simctl.deleteDevice(_this21.udid);
    })();
  }

  updateSettings(plist, updates) {
    var _this22 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield settings.updateSettings(_this22, plist, updates);
    })();
  }

  updateLocationSettings(bundleId, authorized) {
    var _this23 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield settings.updateLocationSettings(_this23, bundleId, authorized);
    })();
  }

  setReduceMotion(reduceMotion = true) {
    var _this24 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (yield _this24.isFresh()) {
        yield _this24.launchAndQuit(false, STARTUP_TIMEOUT);
      }

      yield settings.setReduceMotion(_this24, reduceMotion);
    })();
  }

  updateSafariSettings(updates) {
    var _this25 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let updated = yield settings.updateSafariUserSettings(_this25, updates);
      return (yield settings.updateSettings(_this25, 'mobileSafari', updates)) || updated;
    })();
  }

  updateLocale(language, locale, calendarFormat) {
    var _this26 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield settings.updateLocale(_this26, language, locale, calendarFormat);
    })();
  }

  deleteSafari() {
    var _this27 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Deleting Safari apps from simulator');

      let dirs = [];
      dirs.push((yield _this27.getAppDir('com.apple.mobilesafari')));
      let pv = yield _this27.getPlatformVersion();

      if (pv >= 8) {
        dirs.push((yield _this27.getAppDir('com.apple.mobilesafari', 'Bundle')));
      }

      let deletePromises = [];
      var _iteratorNormalCompletion4 = true;
      var _didIteratorError4 = false;
      var _iteratorError4 = undefined;

      try {
        for (var _iterator4 = _lodash.default.compact(dirs)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
          let dir = _step4.value;

          _logger.default.debug(`Deleting directory: '${dir}'`);

          deletePromises.push(_appiumSupport.fs.rimraf(dir));
        }
      } catch (err) {
        _didIteratorError4 = true;
        _iteratorError4 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {
            _iterator4.return();
          }
        } finally {
          if (_didIteratorError4) {
            throw _iteratorError4;
          }
        }
      }

      yield _bluebird.default.all(deletePromises);
    })();
  }

  cleanSafari(keepPrefs = true) {
    var _this28 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Cleaning mobile safari data files');

      if (yield _this28.isFresh()) {
        _logger.default.info('Could not find Safari support directories to clean out old ' + 'data. Probably there is nothing to clean out');

        return;
      }

      let libraryDir = _path.default.resolve(_this28.getDir(), 'Library');

      let safariRoot = yield _this28.getAppDir('com.apple.mobilesafari');

      if (!safariRoot) {
        _logger.default.info('Could not find Safari support directories to clean out old ' + 'data. Probably there is nothing to clean out');

        return;
      }

      let safariLibraryDir = _path.default.resolve(safariRoot, 'Library');

      let filesToDelete = ['Caches/Snapshots/com.apple.mobilesafari', 'Caches/com.apple.mobilesafari/*', 'Caches/com.apple.WebAppCache/*', 'Caches/com.apple.WebKit.Networking/*', 'Caches/com.apple.WebKit.WebContent/*', 'Image Cache/*', 'WebKit/com.apple.mobilesafari/*', 'WebKit/GeolocationSites.plist', 'WebKit/LocalStorage/*.*', 'Safari/*', 'Cookies/*.binarycookies', 'Caches/com.apple.UIStatusBar/*', 'Caches/com.apple.keyboards/images/*', 'Caches/com.apple.Safari.SafeBrowsing/*', '../tmp/com.apple.mobilesafari/*'];
      let deletePromises = [];

      for (var _i2 = 0; _i2 < filesToDelete.length; _i2++) {
        let file = filesToDelete[_i2];
        deletePromises.push(_appiumSupport.fs.rimraf(_path.default.resolve(libraryDir, file)));
        deletePromises.push(_appiumSupport.fs.rimraf(_path.default.resolve(safariLibraryDir, file)));
      }

      if (!keepPrefs) {
        deletePromises.push(_appiumSupport.fs.rimraf(_path.default.resolve(safariLibraryDir, 'Preferences/*.plist')));
      }

      yield _bluebird.default.all(deletePromises);
    })();
  }

  removeApp(bundleId) {
    var _this29 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield simctl.removeApp(_this29.udid, bundleId);
    })();
  }

  moveBuiltInApp(appName, appPath, newAppPath) {
    return (0, _asyncToGenerator2.default)(function* () {
      yield (0, _utils.safeRimRaf)(newAppPath);
      yield _appiumSupport.fs.copyFile(appPath, newAppPath);

      _logger.default.debug(`Copied '${appName}' to '${newAppPath}'`);

      yield _appiumSupport.fs.rimraf(appPath);

      _logger.default.debug(`Temporarily deleted original app at '${appPath}'`);

      return [newAppPath, appPath];
    })();
  }

  openUrl(url) {
    var _this30 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const SAFARI_BOOTED_INDICATOR = 'MobileSafari[';
      const SAFARI_STARTUP_TIMEOUT = 15 * 1000;
      const EXTRA_STARTUP_TIME = 3 * 1000;

      if (yield _this30.isRunning()) {
        yield (0, _asyncbox.retry)(5000, simctl.openUrl, _this30.udid, url);
        yield _this30.tailLogsUntil(SAFARI_BOOTED_INDICATOR, SAFARI_STARTUP_TIMEOUT);

        _logger.default.debug(`Safari started, waiting ${EXTRA_STARTUP_TIME}ms for it to fully start`);

        yield _bluebird.default.delay(EXTRA_STARTUP_TIME);

        _logger.default.debug('Done waiting for Safari');

        return;
      } else {
        throw new Error('Tried to open a url, but the Simulator is not Booted');
      }
    })();
  }

  clearCaches(...folderNames) {
    var _this31 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const cachesRoot = _path.default.resolve(_this31.getDir(), 'Library', 'Caches');

      if (!(yield _appiumSupport.fs.hasAccess(cachesRoot))) {
        _logger.default.debug(`Caches root at '${cachesRoot}' does not exist or is not accessible. Nothing to do there`);

        return 0;
      }

      let itemsToRemove = folderNames.length ? folderNames : yield _appiumSupport.fs.readdir(cachesRoot);
      itemsToRemove = itemsToRemove.map(x => _path.default.resolve(cachesRoot, x));

      if (folderNames.length) {
        itemsToRemove = yield _bluebird.default.filter(itemsToRemove, x => _appiumSupport.fs.hasAccess(x));
      }

      itemsToRemove = yield _bluebird.default.filter(itemsToRemove, function () {
        var _ref13 = (0, _asyncToGenerator2.default)(function* (x) {
          return (yield _appiumSupport.fs.stat(x)).isDirectory();
        });

        return function (_x6) {
          return _ref13.apply(this, arguments);
        };
      }());

      if (!itemsToRemove.length) {
        _logger.default.debug(`No Simulator cache items for cleanup were matched in '${cachesRoot}'`);

        return 0;
      }

      _logger.default.debug(`Matched ${itemsToRemove.length} Simulator cache ` + `item${itemsToRemove.length === 1 ? '' : 's'} for cleanup: ${itemsToRemove}`);

      try {
        yield _bluebird.default.all(itemsToRemove, x => _appiumSupport.fs.rimraf(x));
      } catch (e) {
        _logger.default.warn(`Got an exception while cleaning Simulator caches: ${e.message}`);
      }

      return itemsToRemove.length;
    })();
  }

  tailLogsUntil(bootedIndicator, timeoutMs) {
    var _this32 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let simLog = _path.default.resolve(_this32.getLogDir(), 'system.log');

      yield (0, _asyncbox.retryInterval)(200, 200, (0, _asyncToGenerator2.default)(function* () {
        let exists = yield _appiumSupport.fs.exists(simLog);

        if (!exists) {
          throw new Error(`Could not find Simulator log: '${simLog}'`);
        }
      }));

      _logger.default.info(`Simulator log at '${simLog}'`);

      _logger.default.info(`Tailing simulator logs until we encounter the string "${bootedIndicator}"`);

      _logger.default.info(`We will time out after ${timeoutMs}ms`);

      try {
        yield (0, _tailUntil.tailUntil)(simLog, bootedIndicator, timeoutMs);
      } catch (err) {
        _logger.default.debug('Simulator startup timed out. Continuing anyway.');
      }
    })();
  }

  enableCalendarAccess(bundleID) {
    var _this33 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this33.calendar.enableCalendarAccess(bundleID);
    })();
  }

  disableCalendarAccess(bundleID) {
    var _this34 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this34.calendar.disableCalendarAccess(bundleID);
    })();
  }

  hasCalendarAccess(bundleID) {
    var _this35 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield _this35.calendar.hasCalendarAccess(bundleID);
    })();
  }

  _activateWindow() {
    return (0, _asyncToGenerator2.default)(function* () {
      return `
      tell application "System Events"
        tell process "Simulator"
          set frontmost to false
          set frontmost to true
        end tell
      end tell
    `;
    })();
  }

  executeUIClientScript(appleScript) {
    var _this36 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const windowActivationScript = yield _this36._activateWindow();
      const resultScript = `${windowActivationScript ? windowActivationScript + '\n' : ''}${appleScript}`;

      _logger.default.debug(`Executing UI Apple Script on Simulator with UDID ${_this36.udid}: ${resultScript}`);

      return yield UI_CLIENT_ACCESS_GUARD.acquire(_this36.simulatorApp, (0, _asyncToGenerator2.default)(function* () {
        try {
          const _ref16 = yield (0, _teen_process.exec)('osascript', ['-e', resultScript]),
                stdout = _ref16.stdout;

          return stdout;
        } catch (err) {
          _logger.default.errorAndThrow(`Could not complete operation. Make sure Simulator UI is running and the parent Appium application (e. g. Appium.app or Terminal.app) ` + `is present in System Preferences > Security & Privacy > Privacy > Accessibility list. If the operation is still unsuccessful then ` + `it is not supported by this Simulator. ` + `Original error: ${err.message}`);
        }
      }));
    })();
  }

  isBiometricEnrolled() {
    var _this37 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const output = yield _this37.executeUIClientScript(`
      tell application "System Events"
        tell process "Simulator"
          set dstMenuItem to menu item "Touch ID Enrolled" of menu 1 of menu bar item "Hardware" of menu bar 1
          set isChecked to (value of attribute "AXMenuItemMarkChar" of dstMenuItem) is "✓"
        end tell
      end tell
    `);

      _logger.default.debug(`Touch ID enrolled state: ${output}`);

      return _lodash.default.isString(output) && output.trim() === 'true';
    })();
  }

  enrollBiometric(isEnabled = true) {
    var _this38 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this38.executeUIClientScript(`
      tell application "System Events"
        tell process "Simulator"
          set dstMenuItem to menu item "Touch ID Enrolled" of menu 1 of menu bar item "Hardware" of menu bar 1
          set isChecked to (value of attribute "AXMenuItemMarkChar" of dstMenuItem) is "✓"
          if ${isEnabled ? 'not ' : ''}isChecked then
            click dstMenuItem
          end if
        end tell
      end tell
    `);
    })();
  }

  sendBiometricMatch(shouldMatch = true) {
    var _this39 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this39.executeUIClientScript(`
      tell application "System Events"
        tell process "Simulator"
          set dstMenuItem to menu item "${shouldMatch ? 'Matching' : 'Non-matching'}" of menu 1 of menu item "Simulate Finger Touch" of menu 1 of menu bar item "Hardware" of menu bar 1
          click dstMenuItem
        end tell
      end tell
    `);
    })();
  }

  dismissDatabaseAlert(increase = true) {
    var _this40 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let button = increase ? 'Increase' : 'Cancel';

      _logger.default.debug(`Attempting to dismiss database alert with '${button}' button`);

      yield _this40.executeUIClientScript(`
      tell application "System Events"
        tell process "Simulator"
          click button "${button}" of window 1
        end tell
      end tell
    `);
    })();
  }

  backupKeychains() {
    var _this41 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (!(yield _appiumSupport.fs.exists(_this41.keychainPath))) {
        return false;
      }

      const backupPath = yield _appiumSupport.tempDir.path({
        prefix: `keychains_backup_${Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1)}`,
        suffix: '.zip'
      });
      const zipArgs = ['-r', backupPath, `${_this41.keychainPath}${_path.default.sep}`];

      _logger.default.debug(`Creating keychains backup with 'zip ${zipArgs.join(' ')}' command`);

      yield (0, _teen_process.exec)('zip', zipArgs);

      if (_lodash.default.isString(_this41._keychainsBackupPath) && (yield _appiumSupport.fs.exists(_this41._keychainsBackupPath))) {
        yield _appiumSupport.fs.unlink(_this41._keychainsBackupPath);
      }

      _this41._keychainsBackupPath = backupPath;
      return true;
    })();
  }

  restoreKeychains(excludePatterns = []) {
    var _this42 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (!_lodash.default.isString(_this42._keychainsBackupPath) || !(yield _appiumSupport.fs.exists(_this42._keychainsBackupPath))) {
        throw new Error(`The keychains backup archive does not exist. ` + `Are you sure it was created before?`);
      }

      if (_lodash.default.isString(excludePatterns)) {
        excludePatterns = excludePatterns.split(',').map(x => x.trim());
      }

      const _ref17 = yield _this42.stat(),
            state = _ref17.state;

      const isServerRunning = state === 'Booted';
      let plistPath;

      if (isServerRunning) {
        plistPath = _path.default.resolve((yield _this42.getLaunchDaemonsRoot()), 'com.apple.securityd.plist');

        if (!(yield _appiumSupport.fs.exists(plistPath))) {
          throw new Error(`Cannot clear keychains because '${plistPath}' does not exist`);
        }

        yield simctl.spawn(_this42.udid, ['launchctl', 'unload', plistPath]);
      }

      try {
        yield _appiumSupport.fs.rimraf(_this42.keychainPath);
        yield (0, _appiumSupport.mkdirp)(_this42.keychainPath);
        const unzipArgs = ['-o', _this42._keychainsBackupPath, ..._lodash.default.flatMap(excludePatterns.map(x => ['-x', x])), '-d', '/'];

        _logger.default.debug(`Restoring keychains with 'unzip ${unzipArgs.join(' ')}' command`);

        yield (0, _teen_process.exec)('unzip', unzipArgs);
        yield _appiumSupport.fs.unlink(_this42._keychainsBackupPath);
        _this42._keychainsBackupPath = null;
      } finally {
        if (isServerRunning && plistPath) {
          yield simctl.spawn(_this42.udid, ['launchctl', 'load', plistPath]);
        }
      }

      return true;
    })();
  }

  clearKeychains() {
    var _this43 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const plistPath = _path.default.resolve((yield _this43.getLaunchDaemonsRoot()), 'com.apple.securityd.plist');

      if (!(yield _appiumSupport.fs.exists(plistPath))) {
        throw new Error(`Cannot clear keychains because '${plistPath}' does not exist`);
      }

      yield simctl.spawn(_this43.udid, ['launchctl', 'unload', plistPath]);

      try {
        if (yield _appiumSupport.fs.exists(_this43.keychainPath)) {
          yield _appiumSupport.fs.rimraf(_this43.keychainPath);
          yield (0, _appiumSupport.mkdirp)(_this43.keychainPath);
        }
      } finally {
        yield simctl.spawn(_this43.udid, ['launchctl', 'load', plistPath]);
      }
    })();
  }

  setPermissions(bundleId, permissionsMapping) {
    var _this44 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this44.permissions.setAccess(permissionsMapping, bundleId);

      _logger.default.debug(`Set ${JSON.stringify(permissionsMapping)} access for '${bundleId}'`);
    })();
  }

  getPermission(bundleId, serviceName) {
    var _this45 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const result = yield _this45.permissions.getAccess(serviceName, bundleId);

      _logger.default.debug(`Got ${serviceName} access status for '${bundleId}': ${result}`);

      return result;
    })();
  }

  getLaunchDaemonsRoot() {
    return (0, _asyncToGenerator2.default)(function* () {
      const devRoot = yield (0, _utils.getDeveloperRoot)();
      return _path.default.resolve(devRoot, 'Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/LaunchDaemons');
    })();
  }

  static _getDeviceStringPlatformVersion(platformVersion) {
    return (0, _asyncToGenerator2.default)(function* () {
      let reqVersion = platformVersion;

      if (!reqVersion) {
        reqVersion = yield _appiumXcode.default.getMaxIOSSDK();

        _logger.default.warn(`No platform version set. Using max SDK version: ${reqVersion}`);

        if (!_lodash.default.isString(reqVersion)) {
          reqVersion = reqVersion % 1 ? String(reqVersion) : `${reqVersion}.0`;
        }
      }

      return reqVersion;
    })();
  }

  static _getDeviceStringVersionString(platformVersion) {
    var _this46 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let reqVersion = yield _this46._getDeviceStringPlatformVersion(platformVersion);
      return `(${reqVersion} Simulator)`;
    })();
  }

  static _getDeviceStringConfigFix() {
    return {
      'iPad Simulator (7.1 Simulator)': 'iPad 2 (7.1 Simulator)',
      'iPad Simulator (8.0 Simulator)': 'iPad 2 (8.0 Simulator)',
      'iPad Simulator (8.1 Simulator)': 'iPad 2 (8.1 Simulator)',
      'iPad Simulator (8.2 Simulator)': 'iPad 2 (8.2 Simulator)',
      'iPad Simulator (8.3 Simulator)': 'iPad 2 (8.3 Simulator)',
      'iPad Simulator (8.4 Simulator)': 'iPad 2 (8.4 Simulator)',
      'iPhone Simulator (7.1 Simulator)': 'iPhone 5s (7.1 Simulator)',
      'iPhone Simulator (8.4 Simulator)': 'iPhone 6 (8.4 Simulator)',
      'iPhone Simulator (8.3 Simulator)': 'iPhone 6 (8.3 Simulator)',
      'iPhone Simulator (8.2 Simulator)': 'iPhone 6 (8.2 Simulator)',
      'iPhone Simulator (8.1 Simulator)': 'iPhone 6 (8.1 Simulator)',
      'iPhone Simulator (8.0 Simulator)': 'iPhone 6 (8.0 Simulator)'
    };
  }

  static getDeviceString(opts) {
    var _this47 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      opts = Object.assign({}, {
        deviceName: null,
        platformVersion: null,
        forceIphone: false,
        forceIpad: false
      }, opts);
      let logOpts = {
        deviceName: opts.deviceName,
        platformVersion: opts.platformVersion,
        forceIphone: opts.forceIphone,
        forceIpad: opts.forceIpad
      };

      _logger.default.debug(`Getting device string from options: ${JSON.stringify(logOpts)}`);

      if ((opts.deviceName || '')[0] === '=') {
        return opts.deviceName.substring(1);
      }

      let isiPhone = !!opts.forceIphone || !opts.forceIpad;

      if (opts.deviceName) {
        let device = opts.deviceName.toLowerCase();

        if (device.indexOf('iphone') !== -1) {
          isiPhone = true;
        } else if (device.indexOf('ipad') !== -1) {
          isiPhone = false;
        }
      }

      let iosDeviceString = opts.deviceName || (isiPhone ? 'iPhone Simulator' : 'iPad Simulator');

      if (/^(iPhone|iPad)$/.test(iosDeviceString)) {
        iosDeviceString += " Simulator";
      }

      if (/[^(iPhone|iPad)] Simulator/.test(iosDeviceString)) {
        iosDeviceString = iosDeviceString.replace(" Simulator", "");
      }

      iosDeviceString += ` ${yield _this47._getDeviceStringVersionString(opts.platformVersion)}`;

      let CONFIG_FIX = _this47._getDeviceStringConfigFix();

      let configFix = CONFIG_FIX;

      if (configFix[iosDeviceString]) {
        iosDeviceString = configFix[iosDeviceString];

        _logger.default.debug(`Fixing device. Changed from '${opts.deviceName}' ` + `to '${iosDeviceString}'`);
      }

      _logger.default.debug(`Final device string is '${iosDeviceString}'`);

      return iosDeviceString;
    })();
  }

  getWebInspectorSocket() {
    return (0, _asyncToGenerator2.default)(function* () {
      return null;
    })();
  }

}

exports.SimulatorXcode6 = SimulatorXcode6;
var _iteratorNormalCompletion5 = true;
var _didIteratorError5 = false;
var _iteratorError5 = undefined;

try {
  for (var _iterator5 = _lodash.default.toPairs(_index.default)[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
    let _step5$value = (0, _slicedToArray2.default)(_step5.value, 2),
        cmd = _step5$value[0],
        fn = _step5$value[1];

    SimulatorXcode6.prototype[cmd] = fn;
  }
} catch (err) {
  _didIteratorError5 = true;
  _iteratorError5 = err;
} finally {
  try {
    if (!_iteratorNormalCompletion5 && _iterator5.return != null) {
      _iterator5.return();
    }
  } finally {
    if (_didIteratorError5) {
      throw _iteratorError5;
    }
  }
}

var _default = SimulatorXcode6;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW11bGF0b3IteGNvZGUtNi5qcyJdLCJuYW1lcyI6WyJTVEFSVFVQX1RJTUVPVVQiLCJFWFRSQV9TVEFSVFVQX1RJTUUiLCJVSV9DTElFTlRfQUNDRVNTX0dVQVJEIiwiQXN5bmNMb2NrIiwiVUlfQ0xJRU5UX0JVTkRMRV9JRCIsIlNQUklOR0JPQVJEX0JVTkRMRV9JRCIsIkJPT1RfQ09NUExFVEVEX0VWRU5UIiwiU2ltdWxhdG9yWGNvZGU2IiwiRXZlbnRFbWl0dGVyIiwiY29uc3RydWN0b3IiLCJ1ZGlkIiwieGNvZGVWZXJzaW9uIiwiU3RyaW5nIiwiX3BsYXRmb3JtVmVyc2lvbiIsImtleWNoYWluUGF0aCIsInBhdGgiLCJyZXNvbHZlIiwiZ2V0RGlyIiwic2ltdWxhdG9yQXBwIiwiYXBwRGF0YUJ1bmRsZVBhdGhzIiwiaXNGcmVzaEZpbGVzIiwiZXh0cmFTdGFydHVwVGltZSIsImNhbGVuZGFyIiwiQ2FsZW5kYXIiLCJwZXJtaXNzaW9ucyIsIlBlcm1pc3Npb25zIiwidWlDbGllbnRCdW5kbGVJZCIsImdldFVJQ2xpZW50UGlkIiwic3Rkb3V0IiwiZSIsInNwbGl0IiwiZTEiLCJpc05hTiIsInBhcnNlSW50IiwidHJpbSIsImxvZyIsImRlYnVnIiwiaXNVSUNsaWVudFJ1bm5pbmciLCJfIiwiaXNOdWxsIiwic3RhcnR1cFRpbWVvdXQiLCJnZXRQbGF0Zm9ybVZlcnNpb24iLCJzdGF0Iiwic2RrIiwiZ2V0Um9vdERpciIsImhvbWUiLCJwcm9jZXNzIiwiZW52IiwiSE9NRSIsImdldExvZ0RpciIsImluc3RhbGxBcHAiLCJhcHAiLCJzaW1jdGwiLCJpc0FwcEluc3RhbGxlZCIsImJ1bmRsZUlkIiwiYXBwRmlsZSIsImFwcERpcnMiLCJnZXRBcHBEaXJzIiwibGVuZ3RoIiwiZ2V0QXBwRGlyIiwiaWQiLCJzdWJEaXIiLCJpc0VtcHR5IiwiaXNGcmVzaCIsImJ1aWxkQnVuZGxlUGF0aE1hcCIsImFwcGxpY2F0aW9uTGlzdCIsInBhdGhCdW5kbGVQYWlyIiwiZGlyIiwiYXBwRmlsZXMiLCJmcyIsImdsb2IiLCJtYXRjaCIsInJlYWRCdW5kbGVJZCIsInBsaXN0IiwibWV0YWRhdGEiLCJzZXR0aW5ncyIsInJlYWQiLCJNQ01NZXRhZGF0YUlkZW50aWZpZXIiLCJidW5kbGVQYXRoRGlycyIsInJlYWRkaXIiLCJidW5kbGVQYXRoUGFpcnMiLCJyZWR1Y2UiLCJidW5kbGVNYXAiLCJidW5kbGVQYXRoIiwidG9QYWlycyIsImdldERldmljZXMiLCJkZXZpY2VBcnIiLCJkZXZpY2UiLCJmaWxlcyIsInB2IiwicHVzaCIsIm1hcCIsInMiLCJleGlzdGVuY2VzIiwiZiIsImhhc0FjY2VzcyIsImZyZXNoIiwiY29tcGFjdCIsImlzUnVubmluZyIsInN0YXRlIiwid2FpdEZvckJvb3QiLCJib290ZWRJbmRpY2F0b3IiLCJnZXRCb290ZWRJbmRpY2F0b3JTdHJpbmciLCJ0YWlsTG9nc1VudGlsIiwiQiIsImRlbGF5IiwiZW1pdCIsImluZGljYXRvciIsInBsYXRmb3JtVmVyc2lvbiIsIndhcm4iLCJzdGFydFVJQ2xpZW50Iiwib3B0cyIsIk9iamVjdCIsImFzc2lnbiIsInNjYWxlRmFjdG9yIiwiY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQiLCJhcmdzIiwiZm9ybWF0dGVkRGV2aWNlTmFtZSIsIm5hbWUiLCJyZXBsYWNlIiwiYXJndW1lbnROYW1lIiwiaXNCb29sZWFuIiwiaW5mbyIsImpvaW4iLCJ0aW1lb3V0IiwiZXJyIiwiaW5jbHVkZXMiLCJzdGRlcnIiLCJydW4iLCJpc1NlcnZlclJ1bm5pbmciLCJzdGFydFRpbWUiLCJocnRpbWUiLCJzaHV0ZG93biIsIm1lc3NhZ2UiLCJjbGVhbiIsImVuZFNpbXVsYXRvckRhZW1vbiIsImVyYXNlRGV2aWNlIiwic2NydWJDdXN0b21BcHAiLCJhcHBCdW5kbGVJZCIsImNsZWFuQ3VzdG9tQXBwIiwic2NydWIiLCJkZWxldGVQcm9taXNlcyIsInJpbXJhZiIsInJlbFJtUGF0aCIsInJtUGF0aCIsImFsbCIsImRpcnMiLCJkYXRhIiwiYnVuZGxlIiwidW5kZWZpbmVkIiwic3JjIiwibGF1bmNoQW5kUXVpdCIsInNhZmFyaSIsIm9wZW5VcmwiLCJFcnJvciIsImxhdW5jaGN0bENtZCIsInN0b3BDbWQiLCJyZW1vdmVDbWQiLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIiwiZGVsZXRlIiwiZGVsZXRlRGV2aWNlIiwidXBkYXRlU2V0dGluZ3MiLCJ1cGRhdGVzIiwidXBkYXRlTG9jYXRpb25TZXR0aW5ncyIsImF1dGhvcml6ZWQiLCJzZXRSZWR1Y2VNb3Rpb24iLCJyZWR1Y2VNb3Rpb24iLCJ1cGRhdGVTYWZhcmlTZXR0aW5ncyIsInVwZGF0ZWQiLCJ1cGRhdGVTYWZhcmlVc2VyU2V0dGluZ3MiLCJ1cGRhdGVMb2NhbGUiLCJsYW5ndWFnZSIsImxvY2FsZSIsImNhbGVuZGFyRm9ybWF0IiwiZGVsZXRlU2FmYXJpIiwiY2xlYW5TYWZhcmkiLCJrZWVwUHJlZnMiLCJsaWJyYXJ5RGlyIiwic2FmYXJpUm9vdCIsInNhZmFyaUxpYnJhcnlEaXIiLCJmaWxlc1RvRGVsZXRlIiwiZmlsZSIsInJlbW92ZUFwcCIsIm1vdmVCdWlsdEluQXBwIiwiYXBwTmFtZSIsImFwcFBhdGgiLCJuZXdBcHBQYXRoIiwiY29weUZpbGUiLCJ1cmwiLCJTQUZBUklfQk9PVEVEX0lORElDQVRPUiIsIlNBRkFSSV9TVEFSVFVQX1RJTUVPVVQiLCJjbGVhckNhY2hlcyIsImZvbGRlck5hbWVzIiwiY2FjaGVzUm9vdCIsIml0ZW1zVG9SZW1vdmUiLCJ4IiwiZmlsdGVyIiwiaXNEaXJlY3RvcnkiLCJ0aW1lb3V0TXMiLCJzaW1Mb2ciLCJleGlzdHMiLCJlbmFibGVDYWxlbmRhckFjY2VzcyIsImJ1bmRsZUlEIiwiZGlzYWJsZUNhbGVuZGFyQWNjZXNzIiwiaGFzQ2FsZW5kYXJBY2Nlc3MiLCJfYWN0aXZhdGVXaW5kb3ciLCJleGVjdXRlVUlDbGllbnRTY3JpcHQiLCJhcHBsZVNjcmlwdCIsIndpbmRvd0FjdGl2YXRpb25TY3JpcHQiLCJyZXN1bHRTY3JpcHQiLCJhY3F1aXJlIiwiZXJyb3JBbmRUaHJvdyIsImlzQmlvbWV0cmljRW5yb2xsZWQiLCJvdXRwdXQiLCJpc1N0cmluZyIsImVucm9sbEJpb21ldHJpYyIsImlzRW5hYmxlZCIsInNlbmRCaW9tZXRyaWNNYXRjaCIsInNob3VsZE1hdGNoIiwiZGlzbWlzc0RhdGFiYXNlQWxlcnQiLCJpbmNyZWFzZSIsImJ1dHRvbiIsImJhY2t1cEtleWNoYWlucyIsImJhY2t1cFBhdGgiLCJ0ZW1wRGlyIiwicHJlZml4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJzdWZmaXgiLCJ6aXBBcmdzIiwic2VwIiwiX2tleWNoYWluc0JhY2t1cFBhdGgiLCJ1bmxpbmsiLCJyZXN0b3JlS2V5Y2hhaW5zIiwiZXhjbHVkZVBhdHRlcm5zIiwicGxpc3RQYXRoIiwiZ2V0TGF1bmNoRGFlbW9uc1Jvb3QiLCJzcGF3biIsInVuemlwQXJncyIsImZsYXRNYXAiLCJjbGVhcktleWNoYWlucyIsInNldFBlcm1pc3Npb25zIiwicGVybWlzc2lvbnNNYXBwaW5nIiwic2V0QWNjZXNzIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFBlcm1pc3Npb24iLCJzZXJ2aWNlTmFtZSIsInJlc3VsdCIsImdldEFjY2VzcyIsImRldlJvb3QiLCJfZ2V0RGV2aWNlU3RyaW5nUGxhdGZvcm1WZXJzaW9uIiwicmVxVmVyc2lvbiIsInhjb2RlIiwiZ2V0TWF4SU9TU0RLIiwiX2dldERldmljZVN0cmluZ1ZlcnNpb25TdHJpbmciLCJfZ2V0RGV2aWNlU3RyaW5nQ29uZmlnRml4IiwiZ2V0RGV2aWNlU3RyaW5nIiwiZGV2aWNlTmFtZSIsImZvcmNlSXBob25lIiwiZm9yY2VJcGFkIiwibG9nT3B0cyIsImlzaVBob25lIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwiaW9zRGV2aWNlU3RyaW5nIiwidGVzdCIsIkNPTkZJR19GSVgiLCJjb25maWdGaXgiLCJnZXRXZWJJbnNwZWN0b3JTb2NrZXQiLCJleHRlbnNpb25zIiwiY21kIiwi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QUFqQztBQUNEOzs7Ozs7Ozs7Ozs7Ozs7O2VBRWM3USxlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgKiBhcyBzaW1jdGwgZnJvbSAnbm9kZS1zaW1jdGwnO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyB4Y29kZSwgZ2V0UGF0aCBhcyBnZXRYY29kZVBhdGggfSBmcm9tICdhcHBpdW0teGNvZGUnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgeyBmcywgdGVtcERpciwgbWtkaXJwIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBBc3luY0xvY2sgZnJvbSAnYXN5bmMtbG9jayc7XG5pbXBvcnQgeyBraWxsQWxsU2ltdWxhdG9ycywgc2FmZVJpbVJhZiwgZ2V0RGV2ZWxvcGVyUm9vdCB9IGZyb20gJy4vdXRpbHMuanMnO1xuaW1wb3J0IHsgYXN5bmNtYXAsIHJldHJ5SW50ZXJ2YWwsIHdhaXRGb3JDb25kaXRpb24sIHJldHJ5IH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0ICogYXMgc2V0dGluZ3MgZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCB7IHRhaWxVbnRpbCB9IGZyb20gJy4vdGFpbC11bnRpbC5qcyc7XG5pbXBvcnQgZXh0ZW5zaW9ucyBmcm9tICcuL2V4dGVuc2lvbnMvaW5kZXgnO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnZXZlbnRzJztcbmltcG9ydCBDYWxlbmRhciBmcm9tICcuL2NhbGVuZGFyJztcbmltcG9ydCBQZXJtaXNzaW9ucyBmcm9tICcuL3Blcm1pc3Npb25zJztcblxuY29uc3QgU1RBUlRVUF9USU1FT1VUID0gNjAgKiAxMDAwO1xuY29uc3QgRVhUUkFfU1RBUlRVUF9USU1FID0gMjAwMDtcbmNvbnN0IFVJX0NMSUVOVF9BQ0NFU1NfR1VBUkQgPSBuZXcgQXN5bmNMb2NrKCk7XG5jb25zdCBVSV9DTElFTlRfQlVORExFX0lEID0gJ2NvbS5hcHBsZS5pcGhvbmVzaW11bGF0b3InO1xuY29uc3QgU1BSSU5HQk9BUkRfQlVORExFX0lEID0gJ2NvbS5hcHBsZS5TcHJpbmdCb2FyZCc7XG5cbi8qXG4gKiBUaGlzIGV2ZW50IGlzIGVtaXR0ZWQgYXMgc29vbiBhcyBpT1MgU2ltdWxhdG9yXG4gKiBoYXMgZmluaXNoZWQgYm9vdGluZyBhbmQgaXQgaXMgcmVhZHkgdG8gYWNjZXB0IHhjcnVuIGNvbW1hbmRzLlxuICogVGhlIGV2ZW50IGhhbmRsZXIgaXMgY2FsbGVkIGFmdGVyICdydW4nIG1ldGhvZCBpcyBjb21wbGV0ZWRcbiAqIGZvciBYY29kZSA3IGFuZCBvbGRlciBhbmQgaXMgb25seSB1c2VmdWwgaW4gWGNvZGUgOCssXG4gKiBzaW5jZSBvbmUgY2FuIHN0YXJ0IGRvaW5nIHN0dWZmIChmb3IgZXhhbXBsZSBpbnN0YWxsL3VuaW5zdGFsbCBhbiBhcHApIGluIHBhcmFsbGVsXG4gKiB3aXRoIFNpbXVsYXRvciBVSSBzdGFydHVwLCB3aGljaCBzaG9ydGVucyBzZXNzaW9uIHN0YXJ0dXAgdGltZS5cbiAqL1xuY29uc3QgQk9PVF9DT01QTEVURURfRVZFTlQgPSAnYm9vdENvbXBsZXRlZCc7XG5cblxuY2xhc3MgU2ltdWxhdG9yWGNvZGU2IGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcblxuICAvKipcbiAgICogQ29uc3RydWN0cyB0aGUgb2JqZWN0IHdpdGggdGhlIGB1ZGlkYCBhbmQgdmVyc2lvbiBvZiBYY29kZS4gVXNlIHRoZSBleHBvcnRlZCBgZ2V0U2ltdWxhdG9yKHVkaWQpYCBtZXRob2QgaW5zdGVhZC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgU2ltdWxhdG9yIElELlxuICAgKiBAcGFyYW0ge29iamVjdH0geGNvZGVWZXJzaW9uIC0gVGhlIHRhcmdldCBYY29kZSB2ZXJzaW9uIGluIGZvcm1hdCB7bWFqb3IsIG1pbm9yLCBidWlsZH0uXG4gICAqL1xuICBjb25zdHJ1Y3RvciAodWRpZCwgeGNvZGVWZXJzaW9uKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnVkaWQgPSBTdHJpbmcodWRpZCk7XG4gICAgdGhpcy54Y29kZVZlcnNpb24gPSB4Y29kZVZlcnNpb247XG5cbiAgICAvLyBwbGF0Zm9ybVZlcnNpb24gY2Fubm90IGJlIGZvdW5kIGluaXRpYWxseSwgc2luY2UgZ2V0dGluZyBpdCBoYXMgc2lkZSBlZmZlY3RzIGZvclxuICAgIC8vIG91ciBsb2dpYyBmb3IgZmlndXJpbmcgb3V0IGlmIGEgc2ltIGhhcyBiZWVuIHJ1blxuICAgIC8vIGl0IHdpbGwgYmUgc2V0IHdoZW4gaXQgaXMgbmVlZGVkXG4gICAgdGhpcy5fcGxhdGZvcm1WZXJzaW9uID0gbnVsbDtcblxuICAgIHRoaXMua2V5Y2hhaW5QYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMuZ2V0RGlyKCksICdMaWJyYXJ5JywgJ0tleWNoYWlucycpO1xuICAgIHRoaXMuc2ltdWxhdG9yQXBwID0gJ2lPUyBTaW11bGF0b3IuYXBwJztcblxuICAgIHRoaXMuYXBwRGF0YUJ1bmRsZVBhdGhzID0ge307XG5cbiAgICAvLyBsaXN0IG9mIGZpbGVzIHRvIGNoZWNrIGZvciB3aGVuIHNlZWluZyBpZiBhIHNpbXVsYXRvciBpcyBcImZyZXNoXCJcbiAgICAvLyAobWVhbmluZyBpdCBoYXMgbmV2ZXIgYmVlbiBib290ZWQpLlxuICAgIC8vIElmIHRoZXNlIGZpbGVzIGFyZSBwcmVzZW50LCB3ZSBhc3N1bWUgaXQncyBiZWVuIHN1Y2Nlc3NmdWxseSBib290ZWRcbiAgICB0aGlzLmlzRnJlc2hGaWxlcyA9IFtcbiAgICAgICdMaWJyYXJ5L0NvbmZpZ3VyYXRpb25Qcm9maWxlcycsXG4gICAgICAnTGlicmFyeS9Db29raWVzJyxcbiAgICAgICdMaWJyYXJ5L1ByZWZlcmVuY2VzLy5HbG9iYWxQcmVmZXJlbmNlcy5wbGlzdCcsXG4gICAgICAnTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuc3ByaW5nYm9hcmQucGxpc3QnLFxuICAgICAgJ3Zhci9ydW4vc3lzbG9nLnBpZCdcbiAgICBdO1xuXG4gICAgLy8gZXh0cmEgdGltZSB0byB3YWl0IGZvciBzaW11bGF0b3IgdG8gYmUgZGVlbWVkIGJvb3RlZFxuICAgIHRoaXMuZXh0cmFTdGFydHVwVGltZSA9IEVYVFJBX1NUQVJUVVBfVElNRTtcblxuICAgIHRoaXMuY2FsZW5kYXIgPSBuZXcgQ2FsZW5kYXIoeGNvZGVWZXJzaW9uLCB0aGlzLmdldERpcigpKTtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gbmV3IFBlcm1pc3Npb25zKHhjb2RlVmVyc2lvbiwgdGhpcy5nZXREaXIoKSwgdGhpcy51ZGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IEJ1bmRsZSBpZGVudGlmaWVyIG9mIFNpbXVsYXRvciBVSSBjbGllbnQuXG4gICAqL1xuICBnZXQgdWlDbGllbnRCdW5kbGVJZCAoKSB7XG4gICAgcmV0dXJuIFVJX0NMSUVOVF9CVU5ETEVfSUQ7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHRoZSBjdXJyZW50IHByb2Nlc3MgaWQgb2YgdGhlIFVJIGNsaWVudFxuICAgKlxuICAgKiBAcmV0dXJuIHs/c3RyaW5nfSBUaGUgcHJvY2VzcyBJRCBvciBudWxsIGlmIHRoZSBVSSBjbGllbnQgaXMgbm90IHJ1bm5pbmdcbiAgICovXG4gIGFzeW5jIGdldFVJQ2xpZW50UGlkICgpIHtcbiAgICBsZXQgc3Rkb3V0O1xuICAgIHRyeSB7XG4gICAgICAoe3N0ZG91dH0gPSBhd2FpdCBleGVjKCdvc2FzY3JpcHQnLCBbXG4gICAgICAgICctZScsXG4gICAgICAgIGB0ZWxsIGFwcGxpY2F0aW9uIFwiU3lzdGVtIEV2ZW50c1wiIHRvIHVuaXggaWQgb2YgcHJvY2Vzc2VzIHdob3NlIGJ1bmRsZSBpZGVudGlmaWVyIGlzIFwiJHt0aGlzLnVpQ2xpZW50QnVuZGxlSWR9XCJgXG4gICAgICBdKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gUmV0cnkgd2l0aCBwZ3JlcCwgc2luY2UgQXBwbGUgU2NyaXB0IHVzYWdlIG1pZ2h0IGJlIGJsb2NrZWQgYnkgdGhlIE9TXG4gICAgICB0cnkge1xuICAgICAgICAoe3N0ZG91dH0gPSBhd2FpdCBleGVjKCdwZ3JlcCcsIFsnLXhuaScsIHRoaXMuc2ltdWxhdG9yQXBwLnNwbGl0KCcuJylbMF1dKSk7XG4gICAgICB9IGNhdGNoIChlMSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzTmFOKHBhcnNlSW50KHN0ZG91dCwgMTApKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHN0ZG91dCA9IHN0ZG91dC50cmltKCk7XG4gICAgbG9nLmRlYnVnKGBHb3QgU2ltdWxhdG9yIFVJIGNsaWVudCBQSUQ6ICR7c3Rkb3V0fWApO1xuICAgIHJldHVybiBzdGRvdXQ7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgdGhlIHN0YXRlIG9mIFNpbXVsYXRvciBVSSBjbGllbnQuXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgb2YgaWYgVUkgY2xpZW50IGlzIHJ1bm5pbmcgb3IgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgYXN5bmMgaXNVSUNsaWVudFJ1bm5pbmcgKCkge1xuICAgIHJldHVybiAhXy5pc051bGwoYXdhaXQgdGhpcy5nZXRVSUNsaWVudFBpZCgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIb3cgbG9uZyB0byB3YWl0IGJlZm9yZSB0aHJvd2luZyBhbiBlcnJvciBhYm91dCBTaW11bGF0b3Igc3RhcnR1cCB0aW1lb3V0IGhhcHBlbmVkLlxuICAgKlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLlxuICAgKi9cbiAgZ2V0IHN0YXJ0dXBUaW1lb3V0ICgpIHtcbiAgICByZXR1cm4gU1RBUlRVUF9USU1FT1VUO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgcGxhdGZvcm0gdmVyc2lvbiBvZiB0aGUgY3VycmVudCBTaW11bGF0b3IuXG4gICAqXG4gICAqIEByZXR1cm4ge3N0cmluZ30gU0RLIHZlcnNpb24sIGZvciBleGFtcGxlICc4LjMnLlxuICAgKi9cbiAgYXN5bmMgZ2V0UGxhdGZvcm1WZXJzaW9uICgpIHtcbiAgICBpZiAoIXRoaXMuX3BsYXRmb3JtVmVyc2lvbikge1xuICAgICAgbGV0IHtzZGt9ID0gYXdhaXQgdGhpcy5zdGF0KCk7XG4gICAgICB0aGlzLl9wbGF0Zm9ybVZlcnNpb24gPSBzZGs7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9wbGF0Zm9ybVZlcnNpb247XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGZ1bGwgcGF0aCB0byB0aGUgZGlyZWN0b3J5IHdoZXJlIFNpbXVsYXRvciBzdHVmZiBpcyBsb2NhdGVkLlxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBwYXRoIHN0cmluZy5cbiAgICovXG4gIGdldFJvb3REaXIgKCkge1xuICAgIGxldCBob21lID0gcHJvY2Vzcy5lbnYuSE9NRTtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKGhvbWUsICdMaWJyYXJ5JywgJ0RldmVsb3BlcicsICdDb3JlU2ltdWxhdG9yJywgJ0RldmljZXMnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgZnVsbCBwYXRoIHRvIHRoZSBkaXJlY3Rvcnkgd2hlcmUgU2ltdWxhdG9yIGFwcGxpY2F0aW9ucyBkYXRhIGlzIGxvY2F0ZWQuXG4gICAqXG4gICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHBhdGggc3RyaW5nLlxuICAgKi9cbiAgZ2V0RGlyICgpIHtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKHRoaXMuZ2V0Um9vdERpcigpLCB0aGlzLnVkaWQsICdkYXRhJyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGZ1bGwgcGF0aCB0byB0aGUgZGlyZWN0b3J5IHdoZXJlIFNpbXVsYXRvciBsb2dzIGFyZSBzdG9yZWQuXG4gICAqXG4gICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHBhdGggc3RyaW5nLlxuICAgKi9cbiAgZ2V0TG9nRGlyICgpIHtcbiAgICBsZXQgaG9tZSA9IHByb2Nlc3MuZW52LkhPTUU7XG4gICAgcmV0dXJuIHBhdGgucmVzb2x2ZShob21lLCAnTGlicmFyeScsICdMb2dzJywgJ0NvcmVTaW11bGF0b3InLCB0aGlzLnVkaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluc3RhbGwgdmFsaWQgLmFwcCBwYWNrYWdlIG9uIFNpbXVsYXRvci5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGFwcCAtIFRoZSBwYXRoIHRvIHRoZSAuYXBwIHBhY2thZ2UuXG4gICAqL1xuICBhc3luYyBpbnN0YWxsQXBwIChhcHApIHtcbiAgICByZXR1cm4gYXdhaXQgc2ltY3RsLmluc3RhbGxBcHAodGhpcy51ZGlkLCBhcHApO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmeSB3aGV0aGVyIHRoZSBwYXJ0aWN1bGFyIGFwcGxpY2F0aW9uIGlzIGluc3RhbGxlZCBvbiBTaW11bGF0b3IuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIFRoZSBidW5kbGUgaWQgb2YgdGhlIGFwcGxpY2F0aW9uIHRvIGJlIGNoZWNrZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBGdWxlIC0gQXBwbGljYXRpb24gbmFtZSBtaW51cyBcIi5hcHBcIiAoZm9yIGlPUyA3LjEpXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGdpdmVuIGFwcGxpY2F0aW9uIGlzIGluc3RhbGxlZFxuICAgKi9cbiAgYXN5bmMgaXNBcHBJbnN0YWxsZWQgKGJ1bmRsZUlkLCBhcHBGaWxlID0gbnVsbCkge1xuICAgIC8vIGBhcHBGaWxlYCBhcmd1bWVudCBvbmx5IG5lY2Vzc2FyeSBmb3IgaU9TIGJlbG93IHZlcnNpb24gOFxuICAgIGxldCBhcHBEaXJzID0gYXdhaXQgdGhpcy5nZXRBcHBEaXJzKGFwcEZpbGUsIGJ1bmRsZUlkKTtcbiAgICByZXR1cm4gYXBwRGlycy5sZW5ndGggIT09IDA7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGRpcmVjdG9yeSBmb3IgYSBwYXJ0aWN1bGFyIGFwcGxpY2F0aW9uJ3MgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gRWl0aGVyIGEgYnVuZGxlSWQgKGUuZy4sIGNvbS5hcHBsZS5tb2JpbGVzYWZhcmkpIG9yLCBmb3IgaU9TIDcuMSwgdGhlIGFwcCBuYW1lIHdpdGhvdXQgYC5hcHBgIChlLmcuLCBNb2JpbGVTYWZhcmkpXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJkaXIgLSBUaGUgc3ViLWRpcmVjdG9yeSB3ZSBleHBlY3QgdG8gYmUgd2l0aGluIHRoZSBhcHBsaWNhdGlvbiBkaXJlY3RvcnkuIERlZmF1bHRzIHRvIFwiRGF0YVwiLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSByb290IGFwcGxpY2F0aW9uIGZvbGRlci5cbiAgICovXG4gIGFzeW5jIGdldEFwcERpciAoaWQsIHN1YkRpciA9ICdEYXRhJykge1xuICAgIHRoaXMuYXBwRGF0YUJ1bmRsZVBhdGhzW3N1YkRpcl0gPSB0aGlzLmFwcERhdGFCdW5kbGVQYXRoc1tzdWJEaXJdIHx8IHt9O1xuICAgIGlmIChfLmlzRW1wdHkodGhpcy5hcHBEYXRhQnVuZGxlUGF0aHNbc3ViRGlyXSkgJiYgIWF3YWl0IHRoaXMuaXNGcmVzaCgpKSB7XG4gICAgICB0aGlzLmFwcERhdGFCdW5kbGVQYXRoc1tzdWJEaXJdID0gYXdhaXQgdGhpcy5idWlsZEJ1bmRsZVBhdGhNYXAoc3ViRGlyKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYXBwRGF0YUJ1bmRsZVBhdGhzW3N1YkRpcl1baWRdO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSB4Y29kZSA2IHNpbXVsYXRvcnMgYXJlIHJlYWxseSBhbm5veWluZywgYW5kIGJ1cnkgdGhlIG1haW4gYXBwXG4gICAqIGRpcmVjdG9yaWVzIGluc2lkZSBkaXJlY3RvcmllcyBqdXN0IG5hbWVkIHdpdGggSGFzaGVzLlxuICAgKiBUaGlzIGZ1bmN0aW9uIGZpbmRzIHRoZSBwcm9wZXIgZGlyZWN0b3J5IGJ5IHRyYXZlcnNpbmcgYWxsIG9mIHRoZW1cbiAgICogYW5kIHJlYWRpbmcgYSBtZXRhZGF0YSBwbGlzdCAoTW9iaWxlIENvbnRhaW5lciBNYW5hZ2VyKSB0byBnZXQgdGhlXG4gICAqIGJ1bmRsZSBpZC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN1YmRpciAtIFRoZSBzdWItZGlyZWN0b3J5IHdlIGV4cGVjdCB0byBiZSB3aXRoaW4gdGhlIGFwcGxpY2F0aW9uIGRpcmVjdG9yeS4gRGVmYXVsdHMgdG8gXCJEYXRhXCIuXG4gICAqIEByZXR1cm4ge29iamVjdH0gVGhlIGxpc3Qgb2YgcGF0aC1idW5kbGUgcGFpcnMgdG8gYW4gb2JqZWN0IHdoZXJlIGJ1bmRsZUlkcyBhcmUgbWFwcGVkIHRvIHBhdGhzLlxuICAgKi9cbiAgYXN5bmMgYnVpbGRCdW5kbGVQYXRoTWFwIChzdWJEaXIgPSAnRGF0YScpIHtcbiAgICBsb2cuZGVidWcoJ0J1aWxkaW5nIGJ1bmRsZSBwYXRoIG1hcCcpO1xuICAgIGxldCBhcHBsaWNhdGlvbkxpc3Q7XG4gICAgbGV0IHBhdGhCdW5kbGVQYWlyO1xuICAgIGlmIChhd2FpdCB0aGlzLmdldFBsYXRmb3JtVmVyc2lvbigpID09PSAnNy4xJykge1xuICAgICAgLy8gYXBwcyBhdmFpbGFibGVcbiAgICAgIC8vICAgV2ViLmFwcCxcbiAgICAgIC8vICAgV2ViVmlld1NlcnZpY2UuYXBwLFxuICAgICAgLy8gICBNb2JpbGVTYWZhcmkuYXBwLFxuICAgICAgLy8gICBXZWJDb250ZW50QW5hbHlzaXNVSS5hcHAsXG4gICAgICAvLyAgIEREQWN0aW9uc1NlcnZpY2UuYXBwLFxuICAgICAgLy8gICBTdG9yZUtpdFVJU2VydmljZS5hcHBcbiAgICAgIGFwcGxpY2F0aW9uTGlzdCA9IHBhdGgucmVzb2x2ZSh0aGlzLmdldERpcigpLCAnQXBwbGljYXRpb25zJyk7XG4gICAgICBwYXRoQnVuZGxlUGFpciA9IGFzeW5jIChkaXIpID0+IHtcbiAgICAgICAgZGlyID0gcGF0aC5yZXNvbHZlKGFwcGxpY2F0aW9uTGlzdCwgZGlyKTtcbiAgICAgICAgbGV0IGFwcEZpbGVzID0gYXdhaXQgZnMuZ2xvYihgJHtkaXJ9LyouYXBwYCk7XG4gICAgICAgIGxldCBidW5kbGVJZCA9IGFwcEZpbGVzWzBdLm1hdGNoKC8uKlxcLyguKilcXC5hcHAvKVsxXTtcbiAgICAgICAgcmV0dXJuIHtwYXRoOiBkaXIsIGJ1bmRsZUlkfTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGFwcGxpY2F0aW9uTGlzdCA9IHBhdGgucmVzb2x2ZSh0aGlzLmdldERpcigpLCAnQ29udGFpbmVycycsIHN1YkRpciwgJ0FwcGxpY2F0aW9uJyk7XG4gICAgICAvLyBnaXZlbiBhIGRpcmVjdG9yeSwgZmluZCB0aGUgcGxpc3QgZmlsZSBhbmQgcHVsbCB0aGUgYnVuZGxlIGlkIGZyb20gaXRcbiAgICAgIGxldCByZWFkQnVuZGxlSWQgPSBhc3luYyAoZGlyKSA9PiB7XG4gICAgICAgIGxldCBwbGlzdCA9IHBhdGgucmVzb2x2ZShkaXIsICcuY29tLmFwcGxlLm1vYmlsZV9jb250YWluZXJfbWFuYWdlci5tZXRhZGF0YS5wbGlzdCcpO1xuICAgICAgICBsZXQgbWV0YWRhdGEgPSBhd2FpdCBzZXR0aW5ncy5yZWFkKHBsaXN0KTtcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhLk1DTU1ldGFkYXRhSWRlbnRpZmllcjtcbiAgICAgIH07XG4gICAgICAvLyBnaXZlbiBhIGRpcmVjdG9yeSwgcmV0dXJuIHRoZSBwYXRoIGFuZCBidW5kbGUgaWQgYXNzb2NpYXRlZCB3aXRoIGl0XG4gICAgICBwYXRoQnVuZGxlUGFpciA9IGFzeW5jIChkaXIpID0+IHtcbiAgICAgICAgZGlyID0gcGF0aC5yZXNvbHZlKGFwcGxpY2F0aW9uTGlzdCwgZGlyKTtcbiAgICAgICAgbGV0IGJ1bmRsZUlkID0gYXdhaXQgcmVhZEJ1bmRsZUlkKGRpcik7XG4gICAgICAgIHJldHVybiB7cGF0aDogZGlyLCBidW5kbGVJZH07XG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBidW5kbGVQYXRoRGlycyA9IGF3YWl0IGZzLnJlYWRkaXIoYXBwbGljYXRpb25MaXN0KTtcbiAgICBsZXQgYnVuZGxlUGF0aFBhaXJzID0gYXdhaXQgYXN5bmNtYXAoYnVuZGxlUGF0aERpcnMsIGFzeW5jIChkaXIpID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBwYXRoQnVuZGxlUGFpcihkaXIpO1xuICAgIH0sIGZhbHNlKTtcblxuICAgIC8vIHJlZHVjZSB0aGUgbGlzdCBvZiBwYXRoLWJ1bmRsZSBwYWlycyB0byBhbiBvYmplY3Qgd2hlcmUgYnVuZGxlSWRzIGFyZSBtYXBwZWQgdG8gcGF0aHNcbiAgICByZXR1cm4gYnVuZGxlUGF0aFBhaXJzLnJlZHVjZSgoYnVuZGxlTWFwLCBidW5kbGVQYXRoKSA9PiB7XG4gICAgICBidW5kbGVNYXBbYnVuZGxlUGF0aC5idW5kbGVJZF0gPSBidW5kbGVQYXRoLnBhdGg7XG4gICAgICByZXR1cm4gYnVuZGxlTWFwO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHN0YXRlIGFuZCBzcGVjaWZpY3Mgb2YgdGhpcyBzaW0uXG4gICAqXG4gICAqIEByZXR1cm4ge29iamVjdH0gU2ltdWxhdG9yIHN0YXRzIG1hcHBpbmcsIGZvciBleGFtcGxlOlxuICAgKiB7IG5hbWU6ICdpUGhvbmUgNHMnLFxuICAgKiAgIHVkaWQ6ICdDMDlCMzRFNS03RENCLTQ0MkUtQjc5Qy1BQjZCQzAzNTc0MTcnLFxuICAgKiAgIHN0YXRlOiAnU2h1dGRvd24nLFxuICAgKiAgIHNkazogJzguMydcbiAgICogfVxuICAgKi9cbiAgYXN5bmMgc3RhdCAoKSB7XG4gICAgZm9yIChsZXQgW3NkaywgZGV2aWNlQXJyXSBvZiBfLnRvUGFpcnMoYXdhaXQgc2ltY3RsLmdldERldmljZXMoKSkpIHtcbiAgICAgIGZvciAobGV0IGRldmljZSBvZiBkZXZpY2VBcnIpIHtcbiAgICAgICAgaWYgKGRldmljZS51ZGlkID09PSB0aGlzLnVkaWQpIHtcbiAgICAgICAgICBkZXZpY2Uuc2RrID0gc2RrO1xuICAgICAgICAgIHJldHVybiBkZXZpY2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge307XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBpcyBhIGJlc3QtYmV0IGhldXJpc3RpYyBmb3Igd2hldGhlciBvciBub3QgYSBzaW0gaGFzIGJlZW4gYm9vdGVkXG4gICAqIGJlZm9yZS4gV2UgdXN1YWxseSB3YW50IHRvIHN0YXJ0IGEgc2ltdWxhdG9yIHRvIFwid2FybVwiIGl0IHVwLCBoYXZlXG4gICAqIFhjb2RlIHBvcHVsYXRlIGl0IHdpdGggcGxpc3RzIGZvciB1cyB0byBtYW5pcHVsYXRlIGJlZm9yZSBhIHJlYWxcbiAgICogdGVzdCBydW4uXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGN1cnJlbnQgU2ltdWxhdG9yIGhhcyBuZXZlciBiZWVuIHN0YXJ0ZWQgYmVmb3JlXG4gICAqL1xuICBhc3luYyBpc0ZyZXNoICgpIHtcbiAgICAvLyBpZiB0aGUgZm9sbG93aW5nIGZpbGVzIGRvbid0IGV4aXN0LCBpdCBoYXNuJ3QgYmVlbiBib290ZWQuXG4gICAgLy8gVEhJUyBJUyBOT1QgQU4gRVhIQVVTVElWRSBMSVNUXG4gICAgbGV0IGZpbGVzID0gdGhpcy5pc0ZyZXNoRmlsZXM7XG5cbiAgICBsZXQgcHYgPSBhd2FpdCB0aGlzLmdldFBsYXRmb3JtVmVyc2lvbigpO1xuICAgIGlmIChwdiAhPT0gJzcuMScpIHtcbiAgICAgIGZpbGVzLnB1c2goJ0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLlByZWZlcmVuY2VzLnBsaXN0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbGVzLnB1c2goJ0FwcGxpY2F0aW9ucycpO1xuICAgIH1cblxuICAgIGNvbnN0IGRpciA9IHRoaXMuZ2V0RGlyKCk7XG4gICAgZmlsZXMgPSBmaWxlcy5tYXAoKHMpID0+IHBhdGgucmVzb2x2ZShkaXIsIHMpKTtcblxuICAgIGNvbnN0IGV4aXN0ZW5jZXMgPSBhd2FpdCBhc3luY21hcChmaWxlcywgYXN5bmMgKGYpID0+IGF3YWl0IGZzLmhhc0FjY2VzcyhmKSk7XG4gICAgY29uc3QgZnJlc2ggPSBfLmNvbXBhY3QoZXhpc3RlbmNlcykubGVuZ3RoICE9PSBmaWxlcy5sZW5ndGg7XG4gICAgbG9nLmRlYnVnKGBDaGVja2luZyB3aGV0aGVyIHNpbXVsYXRvciBoYXMgYmVlbiBydW4gYmVmb3JlOiAke2ZyZXNoID8gJ25vJyA6ICd5ZXMnfWApO1xuXG4gICAgcmV0dXJuIGZyZXNoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyB0aGUgc3RhdGUgb2YgdGhlIGN1cnJlbnQgU2ltdWxhdG9yLiBPbmUgc2hvdWxkIGRpc3Rpbmd1aXNoIHRoZVxuICAgKiBzdGF0ZXMgb2YgU2ltdWxhdG9yIFVJIGFuZCB0aGUgU2ltdWxhdG9yIGl0c2VsZi5cbiAgICpcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgY3VycmVudCBTaW11bGF0b3IgaXMgcnVubmluZy5cbiAgICovXG4gIGFzeW5jIGlzUnVubmluZyAoKSB7XG4gICAgbGV0IHN0YXQgPSBhd2FpdCB0aGlzLnN0YXQoKTtcbiAgICByZXR1cm4gc3RhdC5zdGF0ZSA9PT0gJ0Jvb3RlZCc7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZ5IHdoZXRoZXIgdGhlIFNpbXVsYXRvciBib290aW5nIGlzIGNvbXBsZXRlZCBhbmQvb3Igd2FpdCBmb3IgaXRcbiAgICogdW50aWwgdGhlIHRpbWVvdXQgZXhwaXJlcy5cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0dXBUaW1lb3V0IC0gdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCBib290aW5nIGlzIGNvbXBsZXRlZC5cbiAgICogQGVtaXRzIEJPT1RfQ09NUExFVEVEX0VWRU5UIGlmIHRoZSBjdXJyZW50IFNpbXVsYXRvciBpcyByZWFkeSB0byBhY2NlcHQgc2ltY3RsIGNvbW1hbmRzLCBsaWtlICdpbnN0YWxsJy5cbiAgICovXG4gIGFzeW5jIHdhaXRGb3JCb290IChzdGFydHVwVGltZW91dCkge1xuICAgIC8vIHdhaXQgZm9yIHRoZSBzaW11bGF0b3IgdG8gYm9vdFxuICAgIC8vIHdhaXRpbmcgZm9yIHRoZSBzaW11bGF0b3Igc3RhdHVzIHRvIGJlICdib290ZWQnIGlzbid0IGdvb2QgZW5vdWdoXG4gICAgLy8gaXQgY2xhaW1zIHRvIGJlIGJvb3RlZCB3YXkgYmVmb3JlIGZpbmlzaGluZyBsb2FkaW5nXG4gICAgLy8gbGV0J3MgdGFpbCB0aGUgc2ltdWxhdG9yIHN5c3RlbSBsb2cgdW50aWwgd2Ugc2VlIGEgbWFnaWMgbGluZSAodGhpcy5ib290ZWRJbmRpY2F0b3IpXG4gICAgbGV0IGJvb3RlZEluZGljYXRvciA9IGF3YWl0IHRoaXMuZ2V0Qm9vdGVkSW5kaWNhdG9yU3RyaW5nKCk7XG4gICAgYXdhaXQgdGhpcy50YWlsTG9nc1VudGlsKGJvb3RlZEluZGljYXRvciwgc3RhcnR1cFRpbWVvdXQpO1xuXG4gICAgLy8gc28gc29ycnksIGJ1dCB3ZSBzaG91bGQgd2FpdCBhbm90aGVyIHR3byBzZWNvbmRzLCBqdXN0IHRvIG1ha2Ugc3VyZSB3ZSd2ZSByZWFsbHkgc3RhcnRlZFxuICAgIC8vIHdlIGNhbid0IGxvb2sgZm9yIGFub3RoZXIgbWFnaWMgbG9nIGxpbmUsIGJlY2F1c2UgdGhleSBzZWVtIHRvIGJlIGFwcC1kZXBlbmRlbnQgKG5vdCBzeXN0ZW0gZGVwZW5kZW50KVxuICAgIGxvZy5kZWJ1ZyhgV2FpdGluZyBhbiBleHRyYSAke3RoaXMuZXh0cmFTdGFydHVwVGltZX1tcyBmb3IgdGhlIHNpbXVsYXRvciB0byByZWFsbHkgZmluaXNoIGJvb3RpbmdgKTtcbiAgICBhd2FpdCBCLmRlbGF5KHRoaXMuZXh0cmFTdGFydHVwVGltZSk7XG4gICAgbG9nLmRlYnVnKCdEb25lIHdhaXRpbmcgZXh0cmEgdGltZSBmb3Igc2ltdWxhdG9yJyk7XG5cbiAgICB0aGlzLmVtaXQoQk9PVF9DT01QTEVURURfRVZFTlQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBtYWdpYyBzdHJpbmcsIHdoaWNoLCBpZiBwcmVzZW50IGluIGxvZ3MsIHJlZmxlY3RzIHRoZSBmYWN0IHRoYXQgc2ltdWxhdG9yIGJvb3RpbmcgaGFzIGJlZW4gY29tcGxldGVkLlxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBtYWdpYyBsb2cgc3RyaW5nLlxuICAgKi9cbiAgYXN5bmMgZ2V0Qm9vdGVkSW5kaWNhdG9yU3RyaW5nICgpIHtcbiAgICBsZXQgaW5kaWNhdG9yO1xuICAgIGxldCBwbGF0Zm9ybVZlcnNpb24gPSBhd2FpdCB0aGlzLmdldFBsYXRmb3JtVmVyc2lvbigpO1xuICAgIHN3aXRjaCAocGxhdGZvcm1WZXJzaW9uKSB7XG4gICAgICBjYXNlICc3LjEnOlxuICAgICAgY2FzZSAnOC4xJzpcbiAgICAgIGNhc2UgJzguMic6XG4gICAgICBjYXNlICc4LjMnOlxuICAgICAgY2FzZSAnOC40JzpcbiAgICAgICAgaW5kaWNhdG9yID0gJ3Byb2ZpbGVkOiBTZXJ2aWNlIHN0YXJ0aW5nLi4uJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICc5LjAnOlxuICAgICAgY2FzZSAnOS4xJzpcbiAgICAgIGNhc2UgJzkuMic6XG4gICAgICBjYXNlICc5LjMnOlxuICAgICAgICBpbmRpY2F0b3IgPSAnU3lzdGVtIGFwcCBcImNvbS5hcHBsZS5zcHJpbmdib2FyZFwiIGZpbmlzaGVkIHN0YXJ0dXAnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzEwLjAnOlxuICAgICAgICBpbmRpY2F0b3IgPSAnU3dpdGNoaW5nIHRvIGtleWJvYXJkJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBsb2cud2FybihgTm8gYm9vdCBpbmRpY2F0b3IgY2FzZSBmb3IgcGxhdGZvcm0gdmVyc2lvbiAnJHtwbGF0Zm9ybVZlcnNpb259J2ApO1xuICAgICAgICBpbmRpY2F0b3IgPSAnbm8gYm9vdCBpbmRpY2F0b3Igc3RyaW5nIGF2YWlsYWJsZSc7XG4gICAgfVxuICAgIHJldHVybiBpbmRpY2F0b3I7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgdGhlIFNpbXVsYXRvciBVSSBjbGllbnQgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gT25lIG9yIG1vcmUgb2YgYXZhaWxhYmxlIFNpbXVsYXRvciBVSSBjbGllbnQgb3B0aW9uczpcbiAgICogICAtIHtzdHJpbmd9IHNjYWxlRmFjdG9yOiBjYW4gYmUgb25lIG9mIFsnMS4wJywgJzAuNzUnLCAnMC41JywgJzAuMzMnLCAnMC4yNSddLlxuICAgKiAgIERlZmluZXMgdGhlIHdpbmRvdyBzY2FsZSB2YWx1ZSBmb3IgdGhlIFVJIGNsaWVudCB3aW5kb3cgZm9yIHRoZSBjdXJyZW50IFNpbXVsYXRvci5cbiAgICogICBFcXVhbHMgdG8gbnVsbCBieSBkZWZhdWx0LCB3aGljaCBrZWVwcyB0aGUgY3VycmVudCBzY2FsZSB1bmNoYW5nZWQuXG4gICAqICAgLSB7Ym9vbGVhbn0gY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQ6IHdoZXRoZXIgdG8gY29ubmVjdCB0aGUgaGFyZHdhcmUga2V5Ym9hcmQgdG8gdGhlXG4gICAqICAgU2ltdWxhdG9yIFVJIGNsaWVudC4gRXF1YWxzIHRvIGZhbHNlIGJ5IGRlZmF1bHQuXG4gICAqICAgLSB7bnVtYmVyfSBzdGFydHVwVGltZW91dDogbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIFNpbXVsYXRvciBib290aW5nXG4gICAqICAgcHJvY2VzcyBpcyBjb21wbGV0ZWQuIFRoZSBkZWZhdWx0IHRpbWVvdXQgd2lsbCBiZSB1c2VkIGlmIG5vdCBzZXQgZXhwbGljaXRseS5cbiAgICovXG4gIGFzeW5jIHN0YXJ0VUlDbGllbnQgKG9wdHMgPSB7fSkge1xuICAgIG9wdHMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgIHNjYWxlRmFjdG9yOiBudWxsLFxuICAgICAgY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQ6IGZhbHNlLFxuICAgICAgc3RhcnR1cFRpbWVvdXQ6IHRoaXMuc3RhcnR1cFRpbWVvdXQsXG4gICAgfSwgb3B0cyk7XG5cbiAgICBjb25zdCBzaW11bGF0b3JBcHAgPSBwYXRoLnJlc29sdmUoYXdhaXQgZ2V0WGNvZGVQYXRoKCksICdBcHBsaWNhdGlvbnMnLCB0aGlzLnNpbXVsYXRvckFwcCk7XG4gICAgY29uc3QgYXJncyA9IFsnLUZuJywgc2ltdWxhdG9yQXBwLCAnLS1hcmdzJywgJy1DdXJyZW50RGV2aWNlVURJRCcsIHRoaXMudWRpZF07XG5cbiAgICBpZiAob3B0cy5zY2FsZUZhY3Rvcikge1xuICAgICAgY29uc3Qgc3RhdCA9IGF3YWl0IHRoaXMuc3RhdCgpO1xuICAgICAgY29uc3QgZm9ybWF0dGVkRGV2aWNlTmFtZSA9IHN0YXQubmFtZS5yZXBsYWNlKC9cXHMrL2csICctJyk7XG4gICAgICBjb25zdCBhcmd1bWVudE5hbWUgPSBgLVNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZS1jb20uYXBwbGUuQ29yZVNpbXVsYXRvci5TaW1EZXZpY2VUeXBlLiR7Zm9ybWF0dGVkRGV2aWNlTmFtZX1gO1xuICAgICAgYXJncy5wdXNoKGFyZ3VtZW50TmFtZSwgb3B0cy5zY2FsZUZhY3Rvcik7XG4gICAgfVxuXG4gICAgaWYgKF8uaXNCb29sZWFuKG9wdHMuY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQpKSB7XG4gICAgICBhcmdzLnB1c2goJy1Db25uZWN0SGFyZHdhcmVLZXlib2FyZCcsIG9wdHMuY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgPyAnMScgOiAnMCcpO1xuICAgIH1cblxuICAgIGxvZy5pbmZvKGBTdGFydGluZyBTaW11bGF0b3IgVUkgd2l0aCBjb21tYW5kOiBvcGVuICR7YXJncy5qb2luKCcgJyl9YCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGV4ZWMoJ29wZW4nLCBhcmdzLCB7dGltZW91dDogb3B0cy5zdGFydHVwVGltZW91dH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKCEoZXJyLnN0ZG91dCB8fCAnJykuaW5jbHVkZXMoJy0xMDgyNScpICYmICEoZXJyLnN0ZGVyciB8fCAnJykuaW5jbHVkZXMoJy0xMDgyNScpKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICAgIGxvZy53YXJuKGBFcnJvciB3aGlsZSBvcGVuaW5nIFVJOiAke2Vyci5zdGRvdXQgfHwgZXJyLnN0ZGVycn0uIENvbnRpbnVpbmdgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZXMgZ2l2ZW4gU2ltdWxhdG9yIHdpdGggb3B0aW9ucy4gVGhlIFNpbXVsYXRvciB3aWxsIG5vdCBiZSByZXN0YXJ0ZWQgaWZcbiAgICogaXQgaXMgYWxyZWFkeSBydW5uaW5nLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gb3B0cyAtIE9uZSBvciBtb3JlIG9mIGF2YWlsYWJsZSBTaW11bGF0b3Igb3B0aW9ucy5cbiAgICogICBTZWUgeyNzdGFydFVJQ2xpZW50KG9wdHMpfSBkb2N1bWVudGF0aW9uIGZvciBtb3JlIGRldGFpbHMgb24gb3RoZXIgc3VwcG9ydGVkIGtleXMuXG4gICAqL1xuICBhc3luYyBydW4gKG9wdHMgPSB7fSkge1xuICAgIG9wdHMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgIHN0YXJ0dXBUaW1lb3V0OiB0aGlzLnN0YXJ0dXBUaW1lb3V0LFxuICAgIH0sIG9wdHMpO1xuICAgIGNvbnN0IHtzdGF0ZX0gPSBhd2FpdCB0aGlzLnN0YXQoKTtcbiAgICBjb25zdCBpc1NlcnZlclJ1bm5pbmcgPSBzdGF0ZSA9PT0gJ0Jvb3RlZCc7XG4gICAgY29uc3QgaXNVSUNsaWVudFJ1bm5pbmcgPSBhd2FpdCB0aGlzLmlzVUlDbGllbnRSdW5uaW5nKCk7XG4gICAgaWYgKGlzU2VydmVyUnVubmluZyAmJiBpc1VJQ2xpZW50UnVubmluZykge1xuICAgICAgbG9nLmluZm8oYEJvdGggU2ltdWxhdG9yIHdpdGggVURJRCAke3RoaXMudWRpZH0gYW5kIHRoZSBVSSBjbGllbnQgYXJlIGN1cnJlbnRseSBydW5uaW5nYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHByb2Nlc3MuaHJ0aW1lKCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2h1dGRvd24oKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKGBFcnJvciBvbiBTaW11bGF0b3Igc2h1dGRvd246ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMuc3RhcnRVSUNsaWVudChvcHRzKTtcblxuICAgIGF3YWl0IHRoaXMud2FpdEZvckJvb3Qob3B0cy5zdGFydHVwVGltZW91dCk7XG4gICAgbG9nLmluZm8oYFNpbXVsYXRvciB3aXRoIFVESUQgJHt0aGlzLnVkaWR9IGJvb3RlZCBpbiAke3Byb2Nlc3MuaHJ0aW1lKHN0YXJ0VGltZSlbMF19IHNlY29uZHNgKTtcbiAgfVxuXG4gIC8vIFRPRE8ga2VlcCBrZXljaGFpbnNcbiAgLyoqXG4gICAqIFJlc2V0IHRoZSBjdXJyZW50IFNpbXVsYXRvciB0byB0aGUgY2xlYW4gc3RhdGUuXG4gICAqL1xuICBhc3luYyBjbGVhbiAoKSB7XG4gICAgYXdhaXQgdGhpcy5lbmRTaW11bGF0b3JEYWVtb24oKTtcbiAgICBsb2cuaW5mbyhgQ2xlYW5pbmcgc2ltdWxhdG9yICR7dGhpcy51ZGlkfWApO1xuICAgIGF3YWl0IHNpbWN0bC5lcmFzZURldmljZSh0aGlzLnVkaWQsIDEwMDAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTY3J1YiAoZGVsZXRlIHRoZSBwcmVmZXJlbmNlcyBhbmQgY2hhbmdlZCBmaWxlcykgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb24gb24gU2ltdWxhdG9yLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYXBwRmlsZSAtIEFwcGxpY2F0aW9uIG5hbWUgbWludXMgXCIuYXBwXCIuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBCdW5kbGVJZCAtIEJ1bmRsZSBpZGVudGlmaWVyIG9mIHRoZSBhcHBsaWNhdGlvbi5cbiAgICovXG4gIGFzeW5jIHNjcnViQ3VzdG9tQXBwIChhcHBGaWxlLCBhcHBCdW5kbGVJZCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmNsZWFuQ3VzdG9tQXBwKGFwcEZpbGUsIGFwcEJ1bmRsZUlkLCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbi9zY3J1YiB0aGUgcGFydGljdWxhciBhcHBsaWNhdGlvbiBvbiBTaW11bGF0b3IuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBGaWxlIC0gQXBwbGljYXRpb24gbmFtZSBtaW51cyBcIi5hcHBcIi5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGFwcEJ1bmRsZUlkIC0gQnVuZGxlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNjcnViIC0gSWYgYHNjcnViYCBpcyBmYWxzZSwgd2Ugd2FudCB0byBjbGVhbiBieSBkZWxldGluZyB0aGUgYXBwIGFuZCBhbGxcbiAgICogICBmaWxlcyBhc3NvY2lhdGVkIHdpdGggaXQuIElmIGBzY3J1YmAgaXMgdHJ1ZSwgd2UganVzdCB3YW50IHRvIGRlbGV0ZSB0aGUgcHJlZmVyZW5jZXMgYW5kXG4gICAqICAgY2hhbmdlZCBmaWxlcy5cbiAgICovXG4gIGFzeW5jIGNsZWFuQ3VzdG9tQXBwIChhcHBGaWxlLCBhcHBCdW5kbGVJZCwgc2NydWIgPSBmYWxzZSkge1xuICAgIGxvZy5kZWJ1ZyhgQ2xlYW5pbmcgYXBwIGRhdGEgZmlsZXMgZm9yICcke2FwcEZpbGV9JywgJyR7YXBwQnVuZGxlSWR9J2ApO1xuICAgIGlmICghc2NydWIpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgRGVsZXRpbmcgYXBwIGFsdG9nZXRoZXJgKTtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIGRpcmVjdG9yaWVzIHRvIGJlIGRlbGV0ZWRcbiAgICBsZXQgYXBwRGlycyA9IGF3YWl0IHRoaXMuZ2V0QXBwRGlycyhhcHBGaWxlLCBhcHBCdW5kbGVJZCwgc2NydWIpO1xuXG4gICAgaWYgKGFwcERpcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICBsb2cuZGVidWcoXCJDb3VsZCBub3QgZmluZCBhcHAgZGlyZWN0b3JpZXMgdG8gZGVsZXRlLiBJdCBpcyBwcm9iYWJseSBub3QgaW5zdGFsbGVkXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBkZWxldGVQcm9taXNlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgZGlyIG9mIGFwcERpcnMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgRGVsZXRpbmcgZGlyZWN0b3J5OiAnJHtkaXJ9J2ApO1xuICAgICAgZGVsZXRlUHJvbWlzZXMucHVzaChmcy5yaW1yYWYoZGlyKSk7XG4gICAgfVxuXG4gICAgaWYgKGF3YWl0IHRoaXMuZ2V0UGxhdGZvcm1WZXJzaW9uKCkgPj0gOCkge1xuICAgICAgbGV0IHJlbFJtUGF0aCA9IGBMaWJyYXJ5L1ByZWZlcmVuY2VzLyR7YXBwQnVuZGxlSWR9LnBsaXN0YDtcbiAgICAgIGxldCBybVBhdGggPSBwYXRoLnJlc29sdmUodGhpcy5nZXRSb290RGlyKCksIHJlbFJtUGF0aCk7XG4gICAgICBsb2cuZGVidWcoYERlbGV0aW5nIGZpbGU6ICcke3JtUGF0aH0nYCk7XG4gICAgICBkZWxldGVQcm9taXNlcy5wdXNoKGZzLnJpbXJhZihybVBhdGgpKTtcbiAgICB9XG5cbiAgICBhd2FpdCBCLmFsbChkZWxldGVQcm9taXNlcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgcGF0aHMgdG8gZGlycyB3aGVyZSBhcHBsaWNhdGlvbiBkYXRhIGlzIHN0b3JlZC4gaU9TIDgrIHN0b3JlcyBhcHAgZGF0YSBpbiB0d28gcGxhY2VzLFxuICAgKiBhbmQgaU9TIDcuMSBoYXMgb25seSBvbmUgZGlyZWN0b3J5XG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBGaWxlIC0gQXBwbGljYXRpb24gbmFtZSBtaW51cyBcIi5hcHBcIi5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGFwcEJ1bmRsZUlkIC0gQnVuZGxlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNjcnViIC0gVGhlIGBCdW5kbGVgIGRpcmVjdG9yeSBoYXMgdGhlIGFjdHVhbCBhcHAgaW4gaXQuIElmIHdlIGFyZSBqdXN0IHNjcnViYmluZyxcbiAgICogICB3ZSB3YW50IHRoaXMgdG8gc3RheS4gSWYgd2UgYXJlIGNsZWFuaW5nIHdlIGRlbGV0ZS5cbiAgICogQHJldHVybiB7YXJyYXk8c3RyaW5nPn0gQXJyYXkgb2YgYXBwbGljYXRpb24gZGF0YSBwYXRocy5cbiAgICovXG4gIGFzeW5jIGdldEFwcERpcnMgKGFwcEZpbGUsIGFwcEJ1bmRsZUlkLCBzY3J1YiA9IGZhbHNlKSB7XG4gICAgbGV0IGRpcnMgPSBbXTtcbiAgICBpZiAoYXdhaXQgdGhpcy5nZXRQbGF0Zm9ybVZlcnNpb24oKSA+PSA4KSB7XG4gICAgICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZ2V0QXBwRGlyKGFwcEJ1bmRsZUlkKTtcbiAgICAgIGlmICghZGF0YSkgcmV0dXJuIGRpcnM7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcblxuICAgICAgbGV0IGJ1bmRsZSA9ICFzY3J1YiA/IGF3YWl0IHRoaXMuZ2V0QXBwRGlyKGFwcEJ1bmRsZUlkLCAnQnVuZGxlJykgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGZvciAobGV0IHNyYyBvZiBbZGF0YSwgYnVuZGxlXSkge1xuICAgICAgICBpZiAoc3JjKSB7XG4gICAgICAgICAgZGlycy5wdXNoKHNyYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmdldEFwcERpcihhcHBGaWxlKTtcbiAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgIGRpcnMucHVzaChkYXRhKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRpcnM7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSB0aGUgU2ltdWxhdG9yIGluIG9yZGVyIHRvIGhhdmUgdGhlIGluaXRpYWwgZmlsZSBzdHJ1Y3R1cmUgY3JlYXRlZCBhbmQgc2h1dGRvd24gaXQgYWZ0ZXJ3YXJkcy5cbiAgICpcbiAgICogQHBhcmFtIHtib29sZWFufSBzYWZhcmkgLSBXaGV0aGVyIHRvIGV4ZWN1dGUgbW9iaWxlIFNhZmFyaSBhZnRlciBzdGFydHVwLlxuICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnR1cFRpbWVvdXQgLSBIb3cgbG9uZyB0byB3YWl0IHVudGlsIFNpbXVsYXRvciBib290aW5nIGlzIGNvbXBsZXRlZCAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICovXG4gIGFzeW5jIGxhdW5jaEFuZFF1aXQgKHNhZmFyaSA9IGZhbHNlLCBzdGFydHVwVGltZW91dCA9IHRoaXMuc3RhcnR1cFRpbWVvdXQpIHtcbiAgICBsb2cuZGVidWcoJ0F0dGVtcHRpbmcgdG8gbGF1bmNoIGFuZCBxdWl0IHRoZSBzaW11bGF0b3IsIHRvIGNyZWF0ZSBkaXJlY3Rvcnkgc3RydWN0dXJlJyk7XG4gICAgbG9nLmRlYnVnKGBXaWxsIGxhdW5jaCB3aXRoIFNhZmFyaT8gJHtzYWZhcml9YCk7XG5cbiAgICBhd2FpdCB0aGlzLnJ1bihzdGFydHVwVGltZW91dCk7XG5cbiAgICBpZiAoc2FmYXJpKSB7XG4gICAgICBhd2FpdCB0aGlzLm9wZW5VcmwoJ2h0dHA6Ly93d3cuYXBwaXVtLmlvJyk7XG4gICAgfVxuXG4gICAgLy8gd2FpdCBmb3IgdGhlIHN5c3RlbSB0byBjcmVhdGUgdGhlIGZpbGVzIHdlIHdpbGwgbWFuaXB1bGF0ZVxuICAgIC8vIG5lZWQgcXVpdGUgYSBoaWdoIHJldHJ5IG51bWJlciwgaW4gb3JkZXIgdG8gYWNjb21tb2RhdGUgaU9TIDcuMVxuICAgIC8vIGxvY2FsbHksIDcuMSBhdmVyYWdlcyA4LjUgcmV0cmllcyAoZnJvbSA2IC0gMTIpXG4gICAgLy8gICAgICAgICAgOCBhdmVyYWdlcyAwLjYgcmV0cmllcyAoZnJvbSAwIC0gMilcbiAgICAvLyAgICAgICAgICA5IGF2ZXJhZ2VzIDE0IHJldHJpZXNcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcmV0cnlJbnRlcnZhbCg2MCwgMjUwLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChhd2FpdCB0aGlzLmlzRnJlc2goKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2ltdWxhdG9yIGZpbGVzIG5vdCBmdWxseSBjcmVhdGVkLiBXYWl0aW5nIGEgYml0Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nLndhcm4oYFRpbWVvdXQgd2FpdGluZyBmb3Igc2ltdWxhdG9yIGZpbGVzIHRvIGJlIGNyZWF0ZWQuIENvbnRpbnVpbmdgKTtcbiAgICB9XG5cbiAgICAvLyBhbmQgcXVpdFxuICAgIGF3YWl0IHRoaXMuc2h1dGRvd24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb29rcyBmb3IgbGF1bmNoZCBkYWVtb25zIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHNpbSB1ZGlkIGFuZCB0cmllcyB0byBzdG9wIHRoZW0gY2xlYW5seVxuICAgKiBUaGlzIHByZXZlbnRzIHhjcnVuIHNpbWN0bCBlcmFzZSBmcm9tIGhhbmdpbmcuXG4gICAqL1xuICBhc3luYyBlbmRTaW11bGF0b3JEYWVtb24gKCkge1xuICAgIGxvZy5kZWJ1ZyhgS2lsbGluZyBhbnkgc2ltdWxhdG9yIGRhZW1vbnMgZm9yICR7dGhpcy51ZGlkfWApO1xuXG4gICAgbGV0IGxhdW5jaGN0bENtZCA9IGBsYXVuY2hjdGwgbGlzdCB8IGdyZXAgJHt0aGlzLnVkaWR9IHwgY3V0IC1mIDMgfCB4YXJncyAtbiAxIGxhdW5jaGN0bGA7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBzdG9wQ21kID0gYCR7bGF1bmNoY3RsQ21kfSBzdG9wYDtcbiAgICAgIGF3YWl0IGV4ZWMoJ2Jhc2gnLCBbJy1jJywgc3RvcENtZF0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nLndhcm4oYENvdWxkIG5vdCBzdG9wIHNpbXVsYXRvciBkYWVtb25zOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgbG9nLmRlYnVnKCdDYXJyeWluZyBvbiBhbnl3YXkhJyk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBsZXQgcmVtb3ZlQ21kID0gYCR7bGF1bmNoY3RsQ21kfSByZW1vdmVgO1xuICAgICAgYXdhaXQgZXhlYygnYmFzaCcsIFsnLWMnLCByZW1vdmVDbWRdKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKGBDb3VsZCBub3QgcmVtb3ZlIHNpbXVsYXRvciBkYWVtb25zOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgbG9nLmRlYnVnKCdDYXJyeWluZyBvbiBhbnl3YXkhJyk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAvLyBXYWl0cyAxMCBzZWMgZm9yIHRoZSBzaW11bGF0b3IgbGF1bmNoZCBzZXJ2aWNlcyB0byBzdG9wLlxuICAgICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWMoJ2Jhc2gnLCBbJy1jJyxcbiAgICAgICAgICBgcHMgLWUgIHwgZ3JlcCAke3RoaXMudWRpZH0gfCBncmVwIGxhdW5jaGRfc2ltIHwgZ3JlcCAtdiBiYXNoIHwgZ3JlcCAtdiBncmVwIHwgYXdrIHsncHJpbnQkMSd9YF0pO1xuICAgICAgICByZXR1cm4gc3Rkb3V0LnRyaW0oKS5sZW5ndGggPT09IDA7XG4gICAgICB9LCB7d2FpdE1zOiAxMDAwMCwgaW50ZXJ2YWxNczogNTAwfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cud2FybihgQ291bGQgbm90IGVuZCBzaW11bGF0b3IgZGFlbW9uIGZvciAke3RoaXMudWRpZH06ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICBsb2cuZGVidWcoJ0NhcnJ5aW5nIG9uIGFueXdheSEnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2h1dGRvd24gYWxsIHRoZSBydW5uaW5nIFNpbXVsYXRvcnMgYW5kIHRoZSBVSSBjbGllbnQuXG4gICAqL1xuICBhc3luYyBzaHV0ZG93biAoKSB7XG4gICAgYXdhaXQga2lsbEFsbFNpbXVsYXRvcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgdGhlIHBhcnRpY3VsYXIgU2ltdWxhdG9yIGZyb20gZGV2aWNlcyBsaXN0XG4gICAqL1xuICBhc3luYyBkZWxldGUgKCkge1xuICAgIGF3YWl0IHNpbWN0bC5kZWxldGVEZXZpY2UodGhpcy51ZGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIHBhcnRpY3VsYXIgcHJlZmVyZW5jZSBmaWxlIHdpdGggdGhlIGdpdmVuIGtleS92YWx1ZSBwYWlycy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBsaXN0IC0gVGhlIHByZWZlcmVuY2VzIGZpbGUgdG8gdXBkYXRlLlxuICAgKiBAcGFyYW0ge29iamVjdH0gdXBkYXRlcyAtIFRoZSBrZXkvdmFsdWUgcGFpcnMgdG8gdXBkYXRlLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2V0dGluZ3MgKHBsaXN0LCB1cGRhdGVzKSB7XG4gICAgcmV0dXJuIGF3YWl0IHNldHRpbmdzLnVwZGF0ZVNldHRpbmdzKHRoaXMsIHBsaXN0LCB1cGRhdGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRob3JpemUvZGUtYXV0aG9yaXplIGxvY2F0aW9uIHNldHRpbmdzIGZvciBhIHBhcnRpY3VsYXIgYXBwbGljYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIFRoZSBhcHBsaWNhdGlvbiBJRCB0byB1cGRhdGUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYXV0aG9yaXplZCAtIFdoZXRoZXIgb3Igbm90IHRvIGF1dGhvcml6ZS5cbiAgICovXG4gIGFzeW5jIHVwZGF0ZUxvY2F0aW9uU2V0dGluZ3MgKGJ1bmRsZUlkLCBhdXRob3JpemVkKSB7XG4gICAgcmV0dXJuIGF3YWl0IHNldHRpbmdzLnVwZGF0ZUxvY2F0aW9uU2V0dGluZ3ModGhpcywgYnVuZGxlSWQsIGF1dGhvcml6ZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZS9EaXNhYmxlIHJlZHVjZSBtb3Rpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVkdWNlTW90aW9uIC0gV2hldGhlciBvciBub3QgdG8gZW5hYmxlIGl0LlxuICAgKi9cbiAgYXN5bmMgc2V0UmVkdWNlTW90aW9uIChyZWR1Y2VNb3Rpb24gPSB0cnVlKSB7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNGcmVzaCgpKSB7XG4gICAgICBhd2FpdCB0aGlzLmxhdW5jaEFuZFF1aXQoZmFsc2UsIFNUQVJUVVBfVElNRU9VVCk7XG4gICAgfVxuXG4gICAgYXdhaXQgc2V0dGluZ3Muc2V0UmVkdWNlTW90aW9uKHRoaXMsIHJlZHVjZU1vdGlvbik7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHNldHRpbmdzIGZvciBTYWZhcmkuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSB1cGRhdGVzIC0gVGhlIGhhc2ggb2Yga2V5L3ZhbHVlIHBhaXJzIHRvIHVwZGF0ZSBmb3IgU2FmYXJpLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2FmYXJpU2V0dGluZ3MgKHVwZGF0ZXMpIHtcbiAgICBsZXQgdXBkYXRlZCA9IGF3YWl0IHNldHRpbmdzLnVwZGF0ZVNhZmFyaVVzZXJTZXR0aW5ncyh0aGlzLCB1cGRhdGVzKTtcbiAgICByZXR1cm4gYXdhaXQgc2V0dGluZ3MudXBkYXRlU2V0dGluZ3ModGhpcywgJ21vYmlsZVNhZmFyaScsIHVwZGF0ZXMpIHx8IHVwZGF0ZWQ7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBsb2NhbGUgZm9yIHRoZSBTaW11bGF0b3IuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSAtIFRoZSBsYW5ndWFnZSBmb3IgdGhlIHNpbXVsYXRvci4gRS5nLiwgYFwiZnJfVVNcImAuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhbGUgLSBUaGUgbG9jYWxlIHRvIHNldCBmb3IgdGhlIHNpbXVsYXRvci4gRS5nLiwgYFwiZW5cImAuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjYWxlbmRhckZvcm1hdCAtIFRoZSBmb3JtYXQgb2YgdGhlIGNhbGVuZGFyLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlTG9jYWxlIChsYW5ndWFnZSwgbG9jYWxlLCBjYWxlbmRhckZvcm1hdCkge1xuICAgIHJldHVybiBhd2FpdCBzZXR0aW5ncy51cGRhdGVMb2NhbGUodGhpcywgbGFuZ3VhZ2UsIGxvY2FsZSwgY2FsZW5kYXJGb3JtYXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXBsZXRlbHkgZGVsZXRlIG1vYmlsZSBTYWZhcmkgYXBwbGljYXRpb24gZnJvbSB0aGUgY3VycmVudCBTaW11bGF0b3IuXG4gICAqL1xuICBhc3luYyBkZWxldGVTYWZhcmkgKCkge1xuICAgIGxvZy5kZWJ1ZygnRGVsZXRpbmcgU2FmYXJpIGFwcHMgZnJvbSBzaW11bGF0b3InKTtcblxuICAgIGxldCBkaXJzID0gW107XG5cbiAgICAvLyBnZXQgdGhlIGRhdGEgZGlyZWN0b3J5XG4gICAgZGlycy5wdXNoKGF3YWl0IHRoaXMuZ2V0QXBwRGlyKCdjb20uYXBwbGUubW9iaWxlc2FmYXJpJykpO1xuXG4gICAgbGV0IHB2ID0gYXdhaXQgdGhpcy5nZXRQbGF0Zm9ybVZlcnNpb24oKTtcbiAgICBpZiAocHYgPj0gOCkge1xuICAgICAgLy8gZ2V0IHRoZSBidW5kbGUgZGlyZWN0b3J5XG4gICAgICBkaXJzLnB1c2goYXdhaXQgdGhpcy5nZXRBcHBEaXIoJ2NvbS5hcHBsZS5tb2JpbGVzYWZhcmknLCAnQnVuZGxlJykpO1xuICAgIH1cblxuICAgIGxldCBkZWxldGVQcm9taXNlcyA9IFtdO1xuICAgIGZvciAobGV0IGRpciBvZiBfLmNvbXBhY3QoZGlycykpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgRGVsZXRpbmcgZGlyZWN0b3J5OiAnJHtkaXJ9J2ApO1xuICAgICAgZGVsZXRlUHJvbWlzZXMucHVzaChmcy5yaW1yYWYoZGlyKSk7XG4gICAgfVxuICAgIGF3YWl0IEIuYWxsKGRlbGV0ZVByb21pc2VzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCB0aGUgZGlyZWN0b3JpZXMgZm9yIG1vYmlsZSBTYWZhcmkuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0ga2VlcFByZWZzIC0gV2hldGhlciB0byBrZWVwIFNhZmFyaSBwcmVmZXJlbmNlcyBmcm9tIGJlaW5nIGRlbGV0ZWQuXG4gICAqL1xuICBhc3luYyBjbGVhblNhZmFyaSAoa2VlcFByZWZzID0gdHJ1ZSkge1xuICAgIGxvZy5kZWJ1ZygnQ2xlYW5pbmcgbW9iaWxlIHNhZmFyaSBkYXRhIGZpbGVzJyk7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNGcmVzaCgpKSB7XG4gICAgICBsb2cuaW5mbygnQ291bGQgbm90IGZpbmQgU2FmYXJpIHN1cHBvcnQgZGlyZWN0b3JpZXMgdG8gY2xlYW4gb3V0IG9sZCAnICtcbiAgICAgICAgICAgICAgICdkYXRhLiBQcm9iYWJseSB0aGVyZSBpcyBub3RoaW5nIHRvIGNsZWFuIG91dCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBsaWJyYXJ5RGlyID0gcGF0aC5yZXNvbHZlKHRoaXMuZ2V0RGlyKCksICdMaWJyYXJ5Jyk7XG4gICAgbGV0IHNhZmFyaVJvb3QgPSBhd2FpdCB0aGlzLmdldEFwcERpcignY29tLmFwcGxlLm1vYmlsZXNhZmFyaScpO1xuICAgIGlmICghc2FmYXJpUm9vdCkge1xuICAgICAgbG9nLmluZm8oJ0NvdWxkIG5vdCBmaW5kIFNhZmFyaSBzdXBwb3J0IGRpcmVjdG9yaWVzIHRvIGNsZWFuIG91dCBvbGQgJyArXG4gICAgICAgICAgICAgICAnZGF0YS4gUHJvYmFibHkgdGhlcmUgaXMgbm90aGluZyB0byBjbGVhbiBvdXQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IHNhZmFyaUxpYnJhcnlEaXIgPSBwYXRoLnJlc29sdmUoc2FmYXJpUm9vdCwgJ0xpYnJhcnknKTtcbiAgICBsZXQgZmlsZXNUb0RlbGV0ZSA9IFtcbiAgICAgICdDYWNoZXMvU25hcHNob3RzL2NvbS5hcHBsZS5tb2JpbGVzYWZhcmknLFxuICAgICAgJ0NhY2hlcy9jb20uYXBwbGUubW9iaWxlc2FmYXJpLyonLFxuICAgICAgJ0NhY2hlcy9jb20uYXBwbGUuV2ViQXBwQ2FjaGUvKicsXG4gICAgICAnQ2FjaGVzL2NvbS5hcHBsZS5XZWJLaXQuTmV0d29ya2luZy8qJyxcbiAgICAgICdDYWNoZXMvY29tLmFwcGxlLldlYktpdC5XZWJDb250ZW50LyonLFxuICAgICAgJ0ltYWdlIENhY2hlLyonLFxuICAgICAgJ1dlYktpdC9jb20uYXBwbGUubW9iaWxlc2FmYXJpLyonLFxuICAgICAgJ1dlYktpdC9HZW9sb2NhdGlvblNpdGVzLnBsaXN0JyxcbiAgICAgICdXZWJLaXQvTG9jYWxTdG9yYWdlLyouKicsXG4gICAgICAnU2FmYXJpLyonLFxuICAgICAgJ0Nvb2tpZXMvKi5iaW5hcnljb29raWVzJyxcbiAgICAgICdDYWNoZXMvY29tLmFwcGxlLlVJU3RhdHVzQmFyLyonLFxuICAgICAgJ0NhY2hlcy9jb20uYXBwbGUua2V5Ym9hcmRzL2ltYWdlcy8qJyxcbiAgICAgICdDYWNoZXMvY29tLmFwcGxlLlNhZmFyaS5TYWZlQnJvd3NpbmcvKicsXG4gICAgICAnLi4vdG1wL2NvbS5hcHBsZS5tb2JpbGVzYWZhcmkvKidcbiAgICBdO1xuICAgIGxldCBkZWxldGVQcm9taXNlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgZmlsZSBvZiBmaWxlc1RvRGVsZXRlKSB7XG4gICAgICBkZWxldGVQcm9taXNlcy5wdXNoKGZzLnJpbXJhZihwYXRoLnJlc29sdmUobGlicmFyeURpciwgZmlsZSkpKTtcbiAgICAgIGRlbGV0ZVByb21pc2VzLnB1c2goZnMucmltcmFmKHBhdGgucmVzb2x2ZShzYWZhcmlMaWJyYXJ5RGlyLCBmaWxlKSkpO1xuICAgIH1cblxuICAgIGlmICgha2VlcFByZWZzKSB7XG4gICAgICBkZWxldGVQcm9taXNlcy5wdXNoKGZzLnJpbXJhZihwYXRoLnJlc29sdmUoc2FmYXJpTGlicmFyeURpciwgJ1ByZWZlcmVuY2VzLyoucGxpc3QnKSkpO1xuICAgIH1cblxuICAgIGF3YWl0IEIuYWxsKGRlbGV0ZVByb21pc2VzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVbmluc3RhbGwgdGhlIGdpdmVuIGFwcGxpY2F0aW9uIGZyb20gdGhlIGN1cnJlbnQgU2ltdWxhdG9yLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVpbmRsZSBJRCBvZiB0aGUgYXBwbGljYXRpb24gdG8gYmUgcmVtb3ZlZC5cbiAgICovXG4gIGFzeW5jIHJlbW92ZUFwcCAoYnVuZGxlSWQpIHtcbiAgICBhd2FpdCBzaW1jdGwucmVtb3ZlQXBwKHRoaXMudWRpZCwgYnVuZGxlSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1vdmUgYSBidWlsdC1pbiBhcHBsaWNhdGlvbiB0byBhIG5ldyBwbGFjZSAoYWN0dWFsbHksIHJlbmFtZSBpdCkuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGFwcCB0byBiZSBtb3ZlZC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgY3VycmVudCBwYXRoIHRvIHRoZSBhcHBsaWNhdGlvbi5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5ld0FwcFBhdGggLSBUaGUgbmV3IHBhdGggdG8gdGhlIGFwcGxpY2F0aW9uLlxuICAgKiAgIElmIHNvbWUgYXBwbGljYXRpb24gYWxyZWFkeSBleGlzdHMgYnkgdGhpcyBwYXRoIHRoZW4gaXQncyBnb2luZyB0byBiZSByZW1vdmVkLlxuICAgKi9cbiAgYXN5bmMgbW92ZUJ1aWx0SW5BcHAgKGFwcE5hbWUsIGFwcFBhdGgsIG5ld0FwcFBhdGgpIHtcbiAgICBhd2FpdCBzYWZlUmltUmFmKG5ld0FwcFBhdGgpO1xuICAgIGF3YWl0IGZzLmNvcHlGaWxlKGFwcFBhdGgsIG5ld0FwcFBhdGgpO1xuICAgIGxvZy5kZWJ1ZyhgQ29waWVkICcke2FwcE5hbWV9JyB0byAnJHtuZXdBcHBQYXRofSdgKTtcblxuICAgIGF3YWl0IGZzLnJpbXJhZihhcHBQYXRoKTtcbiAgICBsb2cuZGVidWcoYFRlbXBvcmFyaWx5IGRlbGV0ZWQgb3JpZ2luYWwgYXBwIGF0ICcke2FwcFBhdGh9J2ApO1xuXG4gICAgcmV0dXJuIFtuZXdBcHBQYXRoLCBhcHBQYXRoXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIHRoZSBnaXZlbiBVUkwgaW4gbW9iaWxlIFNhZmFyaSBicm93c2VyLlxuICAgKiBUaGUgYnJvd3NlciB3aWxsIGJlIHN0YXJ0ZWQgYXV0b21hdGljYWxseSBpZiBpdCBpcyBub3QgcnVubmluZy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSBVUkwgdG8gYmUgb3BlbmVkLlxuICAgKi9cbiAgYXN5bmMgb3BlblVybCAodXJsKSB7XG4gICAgY29uc3QgU0FGQVJJX0JPT1RFRF9JTkRJQ0FUT1IgPSAnTW9iaWxlU2FmYXJpWyc7XG4gICAgY29uc3QgU0FGQVJJX1NUQVJUVVBfVElNRU9VVCA9IDE1ICogMTAwMDtcbiAgICBjb25zdCBFWFRSQV9TVEFSVFVQX1RJTUUgPSAzICogMTAwMDtcblxuICAgIGlmIChhd2FpdCB0aGlzLmlzUnVubmluZygpKSB7XG4gICAgICBhd2FpdCByZXRyeSg1MDAwLCBzaW1jdGwub3BlblVybCwgdGhpcy51ZGlkLCB1cmwpO1xuICAgICAgYXdhaXQgdGhpcy50YWlsTG9nc1VudGlsKFNBRkFSSV9CT09URURfSU5ESUNBVE9SLCBTQUZBUklfU1RBUlRVUF9USU1FT1VUKTtcbiAgICAgIC8vIFNvIHNvcnJ5LCBidXQgdGhlIGxvZ3MgaGF2ZSBub3RoaW5nIGVsc2UgZm9yIFNhZmFyaSBzdGFydGluZy4uIGp1c3QgZGVsYXkgYSBsaXR0bGUgYml0XG4gICAgICBsb2cuZGVidWcoYFNhZmFyaSBzdGFydGVkLCB3YWl0aW5nICR7RVhUUkFfU1RBUlRVUF9USU1FfW1zIGZvciBpdCB0byBmdWxseSBzdGFydGApO1xuICAgICAgYXdhaXQgQi5kZWxheShFWFRSQV9TVEFSVFVQX1RJTUUpO1xuICAgICAgbG9nLmRlYnVnKCdEb25lIHdhaXRpbmcgZm9yIFNhZmFyaScpO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyaWVkIHRvIG9wZW4gYSB1cmwsIGJ1dCB0aGUgU2ltdWxhdG9yIGlzIG5vdCBCb290ZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBTaW11bGF0b3IgY2FjaGVzIGNsZWFudXAuXG4gICAqXG4gICAqIEBwYXJhbSB7Li4uc3RyaW5nfSBmb2xkZXJOYW1lcyAtIFRoZSBuYW1lcyBvZiBDYWNoZXMgc3ViZm9sZGVycyB0byBiZSBjbGVhbmVkLlxuICAgKiAgIE5vbi1hY2Nlc3NpYmxlL25vbi1leGlzdGluZyBzdWJmb2xkZXJzIHdpbGwgYmUgc2tpcHBlZC5cbiAgICogICBBbGwgZXhpc3Rpbmcgc3ViZm9sZGVycyB1bmRlciBDYWNoZXMgd2lsbCBiZSBkZWxldGVkIGlmIHRoaXMgcGFyYW1ldGVyIGlzIG9taXR0ZWQuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBjb3VudCBvZiBjbGVhbmVkIGNhY2hlIGl0ZW1zLlxuICAgKiAgIFplcm8gaXMgcmV0dXJuZWQgaWYgbm8gaXRlbXMgd2VyZSBtYXRjaGVkIGZvciBjbGVhbnVwIChlaXRoZXIgbm90IGFjY2Vzc2libGUgb3Igbm90IGRpcmVjdG9yaWVzKS5cbiAgICovXG4gIGFzeW5jIGNsZWFyQ2FjaGVzICguLi5mb2xkZXJOYW1lcykge1xuICAgIGNvbnN0IGNhY2hlc1Jvb3QgPSBwYXRoLnJlc29sdmUodGhpcy5nZXREaXIoKSwgJ0xpYnJhcnknLCAnQ2FjaGVzJyk7XG4gICAgaWYgKCEoYXdhaXQgZnMuaGFzQWNjZXNzKGNhY2hlc1Jvb3QpKSkge1xuICAgICAgbG9nLmRlYnVnKGBDYWNoZXMgcm9vdCBhdCAnJHtjYWNoZXNSb290fScgZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGFjY2Vzc2libGUuIE5vdGhpbmcgdG8gZG8gdGhlcmVgKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGxldCBpdGVtc1RvUmVtb3ZlID0gZm9sZGVyTmFtZXMubGVuZ3RoID8gZm9sZGVyTmFtZXMgOiAoYXdhaXQgZnMucmVhZGRpcihjYWNoZXNSb290KSk7XG4gICAgaXRlbXNUb1JlbW92ZSA9IGl0ZW1zVG9SZW1vdmUubWFwKCh4KSA9PiBwYXRoLnJlc29sdmUoY2FjaGVzUm9vdCwgeCkpO1xuICAgIGlmIChmb2xkZXJOYW1lcy5sZW5ndGgpIHtcbiAgICAgIGl0ZW1zVG9SZW1vdmUgPSBhd2FpdCBCLmZpbHRlcihpdGVtc1RvUmVtb3ZlLCAoeCkgPT4gZnMuaGFzQWNjZXNzKHgpKTtcbiAgICB9XG4gICAgaXRlbXNUb1JlbW92ZSA9IGF3YWl0IEIuZmlsdGVyKGl0ZW1zVG9SZW1vdmUsIGFzeW5jICh4KSA9PiAoYXdhaXQgZnMuc3RhdCh4KSkuaXNEaXJlY3RvcnkoKSk7XG4gICAgaWYgKCFpdGVtc1RvUmVtb3ZlLmxlbmd0aCkge1xuICAgICAgbG9nLmRlYnVnKGBObyBTaW11bGF0b3IgY2FjaGUgaXRlbXMgZm9yIGNsZWFudXAgd2VyZSBtYXRjaGVkIGluICcke2NhY2hlc1Jvb3R9J2ApO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgbG9nLmRlYnVnKGBNYXRjaGVkICR7aXRlbXNUb1JlbW92ZS5sZW5ndGh9IFNpbXVsYXRvciBjYWNoZSBgICtcbiAgICAgIGBpdGVtJHtpdGVtc1RvUmVtb3ZlLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBmb3IgY2xlYW51cDogJHtpdGVtc1RvUmVtb3ZlfWApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBCLmFsbChpdGVtc1RvUmVtb3ZlLCAoeCkgPT4gZnMucmltcmFmKHgpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cud2FybihgR290IGFuIGV4Y2VwdGlvbiB3aGlsZSBjbGVhbmluZyBTaW11bGF0b3IgY2FjaGVzOiAke2UubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGl0ZW1zVG9SZW1vdmUubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIEJsb2NrcyB1bnRpbCB0aGUgZ2l2ZW4gaW5kaWNhdGVyIHN0cmluZyBhcHBlYXJzIGluIFNpbXVsYXRvciBsb2dzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYm9vdGVkSW5kaWNhdG9yIC0gVGhlIG1hZ2ljIHN0cmluZywgd2hpY2ggYXBwZWFycyBpbiBsb2dzIGFmdGVyIFNpbXVsYXRvciBib290aW5nIGlzIGNvbXBsZXRlZC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWVvdXRNcyAtIFRoZSBtYXhpbXVtbSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgZm9yIHRoZSBzdHJpbmcgaW5kaWNhdG9yIHByZXNlbmNlLlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgaW9zIHNpbXVsYXRvciBsb2dzIG91dHB1dCBhIGxpbmUgbWF0Y2hpbmcgYGJvb3RlZEluZGljYXRvcmBcbiAgICogdGltZXMgb3V0IGFmdGVyIHRpbWVvdXRNc1xuICAgKi9cbiAgYXN5bmMgdGFpbExvZ3NVbnRpbCAoYm9vdGVkSW5kaWNhdG9yLCB0aW1lb3V0TXMpIHtcbiAgICBsZXQgc2ltTG9nID0gcGF0aC5yZXNvbHZlKHRoaXMuZ2V0TG9nRGlyKCksICdzeXN0ZW0ubG9nJyk7XG5cbiAgICAvLyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSBsb2cgZmlsZSBleGlzdHMgYmVmb3JlIHdlIGNhbiB0YWlsIGl0XG4gICAgYXdhaXQgcmV0cnlJbnRlcnZhbCgyMDAsIDIwMCwgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGV4aXN0cyA9IGF3YWl0IGZzLmV4aXN0cyhzaW1Mb2cpO1xuICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBTaW11bGF0b3IgbG9nOiAnJHtzaW1Mb2d9J2ApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbG9nLmluZm8oYFNpbXVsYXRvciBsb2cgYXQgJyR7c2ltTG9nfSdgKTtcbiAgICBsb2cuaW5mbyhgVGFpbGluZyBzaW11bGF0b3IgbG9ncyB1bnRpbCB3ZSBlbmNvdW50ZXIgdGhlIHN0cmluZyBcIiR7Ym9vdGVkSW5kaWNhdG9yfVwiYCk7XG4gICAgbG9nLmluZm8oYFdlIHdpbGwgdGltZSBvdXQgYWZ0ZXIgJHt0aW1lb3V0TXN9bXNgKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGFpbFVudGlsKHNpbUxvZywgYm9vdGVkSW5kaWNhdG9yLCB0aW1lb3V0TXMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nLmRlYnVnKCdTaW11bGF0b3Igc3RhcnR1cCB0aW1lZCBvdXQuIENvbnRpbnVpbmcgYW55d2F5LicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGUgQ2FsZW5kYXIgYWNjZXNzIGZvciB0aGUgZ2l2ZW4gYXBwbGljYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJRCAtIEJ1bmRsZSBJRCBvZiB0aGUgYXBwbGljYXRpb24sIGZvciB3aGljaCB0aGUgYWNjZXNzIHNob3VsZCBiZSBncmFudGVkLlxuICAgKi9cbiAgYXN5bmMgZW5hYmxlQ2FsZW5kYXJBY2Nlc3MgKGJ1bmRsZUlEKSB7XG4gICAgYXdhaXQgdGhpcy5jYWxlbmRhci5lbmFibGVDYWxlbmRhckFjY2VzcyhidW5kbGVJRCk7XG4gIH1cblxuICAvKipcbiAgICogRGlzYWJsZSBDYWxlbmRhciBhY2Nlc3MgZm9yIHRoZSBnaXZlbiBhcHBsaWNhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlEIC0gQnVuZGxlIElEIG9mIHRoZSBhcHBsaWNhdGlvbiwgZm9yIHdoaWNoIHRoZSBhY2Nlc3Mgc2hvdWxkIGJlIGRlbmllZC5cbiAgICovXG4gIGFzeW5jIGRpc2FibGVDYWxlbmRhckFjY2VzcyAoYnVuZGxlSUQpIHtcbiAgICBhd2FpdCB0aGlzLmNhbGVuZGFyLmRpc2FibGVDYWxlbmRhckFjY2VzcyhidW5kbGVJRCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgd2hldGhlciB0aGUgZ2l2ZW4gYXBwbGljYXRpb24gaGFzIGFjY2VzcyB0byBDYWxlbmRhci5cbiAgICpcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgZ2l2ZW4gYXBwbGljYXRpb24gaGFzIHRoZSBhY2Nlc3MuXG4gICAqL1xuICBhc3luYyBoYXNDYWxlbmRhckFjY2VzcyAoYnVuZGxlSUQpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jYWxlbmRhci5oYXNDYWxlbmRhckFjY2VzcyhidW5kbGVJRCk7XG4gIH1cblxuICAvKipcbiAgICogQWN0aXZhdGVzIFNpbXVsYXRvciB3aW5kb3cuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEByZXR1cm5zIHs/c3RyaW5nfSBJZiB0aGUgbWV0aG9kIHJldHVybnMgYSBzdHJpbmcgdGhlbiBpdCBzaG91bGQgYmUgYSB2YWxpZCBBcHBsZSBTY3JpcHQgd2hpY2hcbiAgICogaXMgYXBwZW5kZWQgYmVmb3JlIGVhY2ggVUkgY2xpZW50IGNvbW1hbmQgaXMgZXhlY3V0ZWQuIE90aGVyd2lzZSB0aGUgbWV0aG9kIHNob3VsZCBhY3RpdmF0ZSB0aGUgd2luZG93XG4gICAqIGl0c2VsZiBhbmQgcmV0dXJuIG5vdGhpbmcuXG4gICAqL1xuICBhc3luYyBfYWN0aXZhdGVXaW5kb3cgKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtYXdhaXRcbiAgICByZXR1cm4gYFxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIlxuICAgICAgICB0ZWxsIHByb2Nlc3MgXCJTaW11bGF0b3JcIlxuICAgICAgICAgIHNldCBmcm9udG1vc3QgdG8gZmFsc2VcbiAgICAgICAgICBzZXQgZnJvbnRtb3N0IHRvIHRydWVcbiAgICAgICAgZW5kIHRlbGxcbiAgICAgIGVuZCB0ZWxsXG4gICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlIGdpdmVuIEFwcGxlIFNjcmlwdCBpbnNpZGUgYSBjcml0aWNhbCBzZWN0aW9uLCBzbyBvdGhlclxuICAgKiBzZXNzaW9ucyBjYW5ub3QgaW5mbHVlbmNlIHRoZSBVSSBjbGllbnQgYXQgdGhlIHNhbWUgdGltZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGFwcGxlU2NyaXB0IC0gVGhlIHZhbGlkIEFwcGxlIFNjcmlwdCBzbmlwcGV0IHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzdGRvdXQgb3V0cHV0IHByb2R1Y2VkIGJ5IHRoZSBzY3JpcHQuXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiBvc2FzY3JpcHQgdG9vbCByZXR1cm5zIG5vbi16ZXJvIGV4aXQgY29kZS5cbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVVSUNsaWVudFNjcmlwdCAoYXBwbGVTY3JpcHQpIHtcbiAgICBjb25zdCB3aW5kb3dBY3RpdmF0aW9uU2NyaXB0ID0gYXdhaXQgdGhpcy5fYWN0aXZhdGVXaW5kb3coKTtcbiAgICBjb25zdCByZXN1bHRTY3JpcHQgPSBgJHt3aW5kb3dBY3RpdmF0aW9uU2NyaXB0ID8gd2luZG93QWN0aXZhdGlvblNjcmlwdCArICdcXG4nIDogJyd9JHthcHBsZVNjcmlwdH1gO1xuICAgIGxvZy5kZWJ1ZyhgRXhlY3V0aW5nIFVJIEFwcGxlIFNjcmlwdCBvbiBTaW11bGF0b3Igd2l0aCBVRElEICR7dGhpcy51ZGlkfTogJHtyZXN1bHRTY3JpcHR9YCk7XG4gICAgcmV0dXJuIGF3YWl0IFVJX0NMSUVOVF9BQ0NFU1NfR1VBUkQuYWNxdWlyZSh0aGlzLnNpbXVsYXRvckFwcCwgYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKCdvc2FzY3JpcHQnLCBbJy1lJywgcmVzdWx0U2NyaXB0XSk7XG4gICAgICAgIHJldHVybiBzdGRvdXQ7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENvdWxkIG5vdCBjb21wbGV0ZSBvcGVyYXRpb24uIE1ha2Ugc3VyZSBTaW11bGF0b3IgVUkgaXMgcnVubmluZyBhbmQgdGhlIHBhcmVudCBBcHBpdW0gYXBwbGljYXRpb24gKGUuIGcuIEFwcGl1bS5hcHAgb3IgVGVybWluYWwuYXBwKSBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYGlzIHByZXNlbnQgaW4gU3lzdGVtIFByZWZlcmVuY2VzID4gU2VjdXJpdHkgJiBQcml2YWN5ID4gUHJpdmFjeSA+IEFjY2Vzc2liaWxpdHkgbGlzdC4gSWYgdGhlIG9wZXJhdGlvbiBpcyBzdGlsbCB1bnN1Y2Nlc3NmdWwgdGhlbiBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYGl0IGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBTaW11bGF0b3IuIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHN0YXRlIG9mIEJpb21ldHJpYyBFbnJvbGxtZW50IGZlYXR1cmUuXG4gICAqXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBFaXRoZXIgdHJ1ZSBvciBmYWxzZVxuICAgKiBAdGhyb3dzIHtFcnJvcn0gSWYgRW5yb2xsbWVudCBzdGF0ZSBjYW5ub3QgYmUgZGV0ZXJtaW5lZFxuICAgKi9cbiAgYXN5bmMgaXNCaW9tZXRyaWNFbnJvbGxlZCAoKSB7XG4gICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgdGhpcy5leGVjdXRlVUlDbGllbnRTY3JpcHQoYFxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIlxuICAgICAgICB0ZWxsIHByb2Nlc3MgXCJTaW11bGF0b3JcIlxuICAgICAgICAgIHNldCBkc3RNZW51SXRlbSB0byBtZW51IGl0ZW0gXCJUb3VjaCBJRCBFbnJvbGxlZFwiIG9mIG1lbnUgMSBvZiBtZW51IGJhciBpdGVtIFwiSGFyZHdhcmVcIiBvZiBtZW51IGJhciAxXG4gICAgICAgICAgc2V0IGlzQ2hlY2tlZCB0byAodmFsdWUgb2YgYXR0cmlidXRlIFwiQVhNZW51SXRlbU1hcmtDaGFyXCIgb2YgZHN0TWVudUl0ZW0pIGlzIFwi4pyTXCJcbiAgICAgICAgZW5kIHRlbGxcbiAgICAgIGVuZCB0ZWxsXG4gICAgYCk7XG4gICAgbG9nLmRlYnVnKGBUb3VjaCBJRCBlbnJvbGxlZCBzdGF0ZTogJHtvdXRwdXR9YCk7XG4gICAgcmV0dXJuIF8uaXNTdHJpbmcob3V0cHV0KSAmJiBvdXRwdXQudHJpbSgpID09PSAndHJ1ZSc7XG4gIH1cblxuICAvKipcbiAgICogRW5yb2xscyBiaW9tZXRyaWMgKFRvdWNoSWQsIEZhY2VJZCkgZmVhdHVyZSB0ZXN0aW5nIGluIFNpbXVsYXRvciBVSSBjbGllbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNFbmFibGVkIC0gRGVmaW5lcyB3aGV0aGVyIGJpb21ldHJpYyBzdGF0ZSBpcyBlbmFibGVkL2Rpc2FibGVkXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgZW5yb2xsZWQgc3RhdGUgY2Fubm90IGJlIGNoYW5nZWRcbiAgICovXG4gIGFzeW5jIGVucm9sbEJpb21ldHJpYyAoaXNFbmFibGVkID0gdHJ1ZSkge1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVVJQ2xpZW50U2NyaXB0KGBcbiAgICAgIHRlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCJcbiAgICAgICAgdGVsbCBwcm9jZXNzIFwiU2ltdWxhdG9yXCJcbiAgICAgICAgICBzZXQgZHN0TWVudUl0ZW0gdG8gbWVudSBpdGVtIFwiVG91Y2ggSUQgRW5yb2xsZWRcIiBvZiBtZW51IDEgb2YgbWVudSBiYXIgaXRlbSBcIkhhcmR3YXJlXCIgb2YgbWVudSBiYXIgMVxuICAgICAgICAgIHNldCBpc0NoZWNrZWQgdG8gKHZhbHVlIG9mIGF0dHJpYnV0ZSBcIkFYTWVudUl0ZW1NYXJrQ2hhclwiIG9mIGRzdE1lbnVJdGVtKSBpcyBcIuKck1wiXG4gICAgICAgICAgaWYgJHtpc0VuYWJsZWQgPyAnbm90ICcgOiAnJ31pc0NoZWNrZWQgdGhlblxuICAgICAgICAgICAgY2xpY2sgZHN0TWVudUl0ZW1cbiAgICAgICAgICBlbmQgaWZcbiAgICAgICAgZW5kIHRlbGxcbiAgICAgIGVuZCB0ZWxsXG4gICAgYCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBub3RpZmljYXRpb24gdG8gbWF0Y2gvbm90IG1hdGNoIHRoZSB0b3VjaCBpZC5cbiAgICpcbiAgICogQHBhcmFtIHs/Ym9vbGVhbn0gc2hvdWxkTWF0Y2ggW3RydWVdIC0gU2V0IGl0IHRvIHRydWUgb3IgZmFsc2UgaW4gb3JkZXIgdG8gZW11bGF0ZVxuICAgKiBtYXRjaGluZy9ub3QgbWF0Y2hpbmcgdGhlIGNvcnJlc3BvbmRpbmcgYmlvbWV0cmljXG4gICAqL1xuICBhc3luYyBzZW5kQmlvbWV0cmljTWF0Y2ggKHNob3VsZE1hdGNoID0gdHJ1ZSkge1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVVJQ2xpZW50U2NyaXB0KGBcbiAgICAgIHRlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCJcbiAgICAgICAgdGVsbCBwcm9jZXNzIFwiU2ltdWxhdG9yXCJcbiAgICAgICAgICBzZXQgZHN0TWVudUl0ZW0gdG8gbWVudSBpdGVtIFwiJHtzaG91bGRNYXRjaCA/ICdNYXRjaGluZycgOiAnTm9uLW1hdGNoaW5nJ31cIiBvZiBtZW51IDEgb2YgbWVudSBpdGVtIFwiU2ltdWxhdGUgRmluZ2VyIFRvdWNoXCIgb2YgbWVudSAxIG9mIG1lbnUgYmFyIGl0ZW0gXCJIYXJkd2FyZVwiIG9mIG1lbnUgYmFyIDFcbiAgICAgICAgICBjbGljayBkc3RNZW51SXRlbVxuICAgICAgICBlbmQgdGVsbFxuICAgICAgZW5kIHRlbGxcbiAgICBgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlIGEgc3BlY2lhbCBBcHBsZSBzY3JpcHQsIHdoaWNoIGNsaWNrcyB0aGUgcGFydGljdWxhciBidXR0b24gb24gRGF0YWJhc2UgYWxlcnQuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaW5jcmVhc2UgLSBDbGljayB0aGUgYnV0dG9uIHdpdGggJ0luY3JlYXNlJyB0aXRsZSBvbiB0aGUgYWxlcnQgaWYgdGhpc1xuICAgKiAgIHBhcmFtZXRlciBpcyB0cnVlLiBUaGUgJ0NhbmNlbCcgYnV0dG9uIHdpbGwgYmUgY2xpY2tlZCBvdGhlcndpc2UuXG4gICAqL1xuICBhc3luYyBkaXNtaXNzRGF0YWJhc2VBbGVydCAoaW5jcmVhc2UgPSB0cnVlKSB7XG4gICAgbGV0IGJ1dHRvbiA9IGluY3JlYXNlID8gJ0luY3JlYXNlJyA6ICdDYW5jZWwnO1xuICAgIGxvZy5kZWJ1ZyhgQXR0ZW1wdGluZyB0byBkaXNtaXNzIGRhdGFiYXNlIGFsZXJ0IHdpdGggJyR7YnV0dG9ufScgYnV0dG9uYCk7XG4gICAgYXdhaXQgdGhpcy5leGVjdXRlVUlDbGllbnRTY3JpcHQoYFxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIlxuICAgICAgICB0ZWxsIHByb2Nlc3MgXCJTaW11bGF0b3JcIlxuICAgICAgICAgIGNsaWNrIGJ1dHRvbiBcIiR7YnV0dG9ufVwiIG9mIHdpbmRvdyAxXG4gICAgICAgIGVuZCB0ZWxsXG4gICAgICBlbmQgdGVsbFxuICAgIGApO1xuICB9XG5cbiAgLy9yZWdpb24gS2V5Y2hhaW5zIEludGVyYWN0aW9uXG4gIC8qKlxuICAgKiBDcmVhdGUgdGhlIGJhY2t1cCBvZiBrZXljaGFpbnMgZm9sZGVyLlxuICAgKiBUaGUgcHJldmlvdXNseSBjcmVhdGVkIGJhY2t1cCB3aWxsIGJlIGF1dG9tYXRpY2FsbHlcbiAgICogZGVsZXRlZCBpZiB0aGlzIG1ldGhvZCB3YXMgY2FsbGVkIHR3aWNlIGluIGEgcm93IHdpdGhvdXRcbiAgICogYHJlc3RvcmVLZXljaGFpbnNgIGJlaW5nIGludm9rZWQuXG4gICAqXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBiYWNrdXAgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsbC5cbiAgICovXG4gIGFzeW5jIGJhY2t1cEtleWNoYWlucyAoKSB7XG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHModGhpcy5rZXljaGFpblBhdGgpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgYmFja3VwUGF0aCA9IGF3YWl0IHRlbXBEaXIucGF0aCh7XG4gICAgICBwcmVmaXg6IGBrZXljaGFpbnNfYmFja3VwXyR7TWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKX1gLFxuICAgICAgc3VmZml4OiAnLnppcCcsXG4gICAgfSk7XG4gICAgY29uc3QgemlwQXJncyA9IFtcbiAgICAgICctcicsIGJhY2t1cFBhdGgsXG4gICAgICBgJHt0aGlzLmtleWNoYWluUGF0aH0ke3BhdGguc2VwfWBcbiAgICBdO1xuICAgIGxvZy5kZWJ1ZyhgQ3JlYXRpbmcga2V5Y2hhaW5zIGJhY2t1cCB3aXRoICd6aXAgJHt6aXBBcmdzLmpvaW4oJyAnKX0nIGNvbW1hbmRgKTtcbiAgICBhd2FpdCBleGVjKCd6aXAnLCB6aXBBcmdzKTtcbiAgICBpZiAoXy5pc1N0cmluZyh0aGlzLl9rZXljaGFpbnNCYWNrdXBQYXRoKSAmJiBhd2FpdCBmcy5leGlzdHModGhpcy5fa2V5Y2hhaW5zQmFja3VwUGF0aCkpIHtcbiAgICAgIGF3YWl0IGZzLnVubGluayh0aGlzLl9rZXljaGFpbnNCYWNrdXBQYXRoKTtcbiAgICB9XG4gICAgdGhpcy5fa2V5Y2hhaW5zQmFja3VwUGF0aCA9IGJhY2t1cFBhdGg7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogUmVzdG9yZSB0aGUgcHJldmlzb3VseSBjcmVhdGVkIGtleWNoYWlucyBiYWNrdXAuXG4gICAqXG4gICAqIEBwYXJhbSB7P3N0cmluZ3xBcnJheTxzdHJpbmc+fSBleGNsdWRlUGF0dGVybnMgLSBUaGUgbGlzdFxuICAgKiBvZiBmaWxlIG5hbWUgcGF0dGVybnMgdG8gYmUgZXhjbHVkZWQgZnJvbSByZXN0b3JlLiBUaGUgZm9ybWF0XG4gICAqIG9mIGVhY2ggaXRlbSBzaG91bGQgYmUgdGhlIHNhbWUgYXMgJy14JyBvcHRpb24gZm9ybWF0IGZvclxuICAgKiAndW56aXAnIHV0aWxpdHkuIFRoaXMgY2FuIGFsc28gYmUgYSBjb21tYS1zZXBhcmF0ZWQgc3RyaW5nLFxuICAgKiB3aGljaCBpcyBnb2luZyBiZSB0cmFuc2Zvcm1lZCBpbnRvIGEgbGlzdCBhdXRvbWF0aWNhbGx5LFxuICAgKiBmb3IgZXhhbXBsZTogJyouZGIqLGJsYWJsYS5zcWxpdGUnXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBJZiB0aGUgcmVzdG9yZSBvcHJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC5cbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIGlzIG5vIGtleWNoYWlucyBiYWNrdXAgYXZhaWxhYmxlIGZvciByZXN0b3JlLlxuICAgKi9cbiAgYXN5bmMgcmVzdG9yZUtleWNoYWlucyAoZXhjbHVkZVBhdHRlcm5zID0gW10pIHtcbiAgICBpZiAoIV8uaXNTdHJpbmcodGhpcy5fa2V5Y2hhaW5zQmFja3VwUGF0aCkgfHwgIWF3YWl0IGZzLmV4aXN0cyh0aGlzLl9rZXljaGFpbnNCYWNrdXBQYXRoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUga2V5Y2hhaW5zIGJhY2t1cCBhcmNoaXZlIGRvZXMgbm90IGV4aXN0LiBgICtcbiAgICAgICAgICAgICAgICAgICAgICBgQXJlIHlvdSBzdXJlIGl0IHdhcyBjcmVhdGVkIGJlZm9yZT9gKTtcbiAgICB9XG5cbiAgICBpZiAoXy5pc1N0cmluZyhleGNsdWRlUGF0dGVybnMpKSB7XG4gICAgICBleGNsdWRlUGF0dGVybnMgPSBleGNsdWRlUGF0dGVybnMuc3BsaXQoJywnKS5tYXAoKHgpID0+IHgudHJpbSgpKTtcbiAgICB9XG4gICAgY29uc3Qge3N0YXRlfSA9IGF3YWl0IHRoaXMuc3RhdCgpO1xuICAgIGNvbnN0IGlzU2VydmVyUnVubmluZyA9IHN0YXRlID09PSAnQm9vdGVkJztcbiAgICBsZXQgcGxpc3RQYXRoO1xuICAgIGlmIChpc1NlcnZlclJ1bm5pbmcpIHtcbiAgICAgIHBsaXN0UGF0aCA9IHBhdGgucmVzb2x2ZShhd2FpdCB0aGlzLmdldExhdW5jaERhZW1vbnNSb290KCksICdjb20uYXBwbGUuc2VjdXJpdHlkLnBsaXN0Jyk7XG4gICAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyhwbGlzdFBhdGgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNsZWFyIGtleWNoYWlucyBiZWNhdXNlICcke3BsaXN0UGF0aH0nIGRvZXMgbm90IGV4aXN0YCk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzaW1jdGwuc3Bhd24odGhpcy51ZGlkLCBbJ2xhdW5jaGN0bCcsICd1bmxvYWQnLCBwbGlzdFBhdGhdKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZzLnJpbXJhZih0aGlzLmtleWNoYWluUGF0aCk7XG4gICAgICBhd2FpdCBta2RpcnAodGhpcy5rZXljaGFpblBhdGgpO1xuICAgICAgY29uc3QgdW56aXBBcmdzID0gW1xuICAgICAgICAnLW8nLCB0aGlzLl9rZXljaGFpbnNCYWNrdXBQYXRoLFxuICAgICAgICAuLi4oXy5mbGF0TWFwKGV4Y2x1ZGVQYXR0ZXJucy5tYXAoKHgpID0+IFsnLXgnLCB4XSkpKSxcbiAgICAgICAgJy1kJywgJy8nXG4gICAgICBdO1xuICAgICAgbG9nLmRlYnVnKGBSZXN0b3Jpbmcga2V5Y2hhaW5zIHdpdGggJ3VuemlwICR7dW56aXBBcmdzLmpvaW4oJyAnKX0nIGNvbW1hbmRgKTtcbiAgICAgIGF3YWl0IGV4ZWMoJ3VuemlwJywgdW56aXBBcmdzKTtcbiAgICAgIGF3YWl0IGZzLnVubGluayh0aGlzLl9rZXljaGFpbnNCYWNrdXBQYXRoKTtcbiAgICAgIHRoaXMuX2tleWNoYWluc0JhY2t1cFBhdGggPSBudWxsO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoaXNTZXJ2ZXJSdW5uaW5nICYmIHBsaXN0UGF0aCkge1xuICAgICAgICBhd2FpdCBzaW1jdGwuc3Bhd24odGhpcy51ZGlkLCBbJ2xhdW5jaGN0bCcsICdsb2FkJywgcGxpc3RQYXRoXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFycyBLZXljaGFpbnMgZm9yIHRoZSBwYXJ0aWN1bGFyIHNpbXVsYXRvciBpbiBydW50aW1lICh0aGVyZSBpcyBubyBuZWVkIHRvIHN0b3AgaXQpLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gSWYga2V5Y2hhaW4gY2xlYW51cCBoYXMgZmFpbGVkLlxuICAgKi9cbiAgYXN5bmMgY2xlYXJLZXljaGFpbnMgKCkge1xuICAgIGNvbnN0IHBsaXN0UGF0aCA9IHBhdGgucmVzb2x2ZShhd2FpdCB0aGlzLmdldExhdW5jaERhZW1vbnNSb290KCksICdjb20uYXBwbGUuc2VjdXJpdHlkLnBsaXN0Jyk7XG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHMocGxpc3RQYXRoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgY2xlYXIga2V5Y2hhaW5zIGJlY2F1c2UgJyR7cGxpc3RQYXRofScgZG9lcyBub3QgZXhpc3RgKTtcbiAgICB9XG4gICAgYXdhaXQgc2ltY3RsLnNwYXduKHRoaXMudWRpZCwgWydsYXVuY2hjdGwnLCAndW5sb2FkJywgcGxpc3RQYXRoXSk7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChhd2FpdCBmcy5leGlzdHModGhpcy5rZXljaGFpblBhdGgpKSB7XG4gICAgICAgIGF3YWl0IGZzLnJpbXJhZih0aGlzLmtleWNoYWluUGF0aCk7XG4gICAgICAgIGF3YWl0IG1rZGlycCh0aGlzLmtleWNoYWluUGF0aCk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGF3YWl0IHNpbWN0bC5zcGF3bih0aGlzLnVkaWQsIFsnbGF1bmNoY3RsJywgJ2xvYWQnLCBwbGlzdFBhdGhdKTtcbiAgICB9XG4gIH1cblxuICAvL2VuZHJlZ2lvblxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBwZXJtaXNzaW9ucyBmb3IgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb24gYnVuZGxlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBBcHBsaWNhdGlvbiBidW5kbGUgaWRlbnRpZmllci5cbiAgICogQHBhcmFtIHtPYmplY3R9IHBlcm1pc3Npb25zTWFwcGluZyAtIEEgbWFwcGluZyB3aGVyZSBrYXlzXG4gICAqIGFyZSBzZXJ2aWNlIG5hbWVzIGFuZCB2YWx1ZXMgYXJlIHRoZWlyIGNvcnJlc3BvbmRpbmcgc3RhdHVzIHZhbHVlcy5cbiAgICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93aXgvQXBwbGVTaW11bGF0b3JVdGlsc1xuICAgKiBmb3IgbW9yZSBkZXRhaWxzIG9uIGF2YWlsYWJsZSBzZXJ2aWNlIG5hbWVzIGFuZCBzdGF0dXNlcy5cbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBjaGFuZ2luZyBwZXJtaXNzaW9ucy5cbiAgICovXG4gIGFzeW5jIHNldFBlcm1pc3Npb25zIChidW5kbGVJZCwgcGVybWlzc2lvbnNNYXBwaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5wZXJtaXNzaW9ucy5zZXRBY2Nlc3MocGVybWlzc2lvbnNNYXBwaW5nLCBidW5kbGVJZCk7XG4gICAgbG9nLmRlYnVnKGBTZXQgJHtKU09OLnN0cmluZ2lmeShwZXJtaXNzaW9uc01hcHBpbmcpfSBhY2Nlc3MgZm9yICcke2J1bmRsZUlkfSdgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgY3VycmVudCBwZXJtaXNzaW9uIHN0YXR1cyBmb3IgdGhlIGdpdmVuIGFwcGxpY2F0aW9uIGJ1bmRsZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gQXBwbGljYXRpb24gYnVuZGxlIGlkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZSAtIE9uZSBvZiBhdmFpbGFibGUgc2VydmljZSBuYW1lcy5cbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSByZXRyaWV2aW5nIHBlcm1pc3Npb25zLlxuICAgKi9cbiAgYXN5bmMgZ2V0UGVybWlzc2lvbiAoYnVuZGxlSWQsIHNlcnZpY2VOYW1lKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wZXJtaXNzaW9ucy5nZXRBY2Nlc3Moc2VydmljZU5hbWUsIGJ1bmRsZUlkKTtcbiAgICBsb2cuZGVidWcoYEdvdCAke3NlcnZpY2VOYW1lfSBhY2Nlc3Mgc3RhdHVzIGZvciAnJHtidW5kbGVJZH0nOiAke3Jlc3VsdH1gKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgYXN5bmMgZ2V0TGF1bmNoRGFlbW9uc1Jvb3QgKCkge1xuICAgIGNvbnN0IGRldlJvb3QgPSBhd2FpdCBnZXREZXZlbG9wZXJSb290KCk7XG4gICAgcmV0dXJuIHBhdGgucmVzb2x2ZShkZXZSb290LFxuICAgICAgJ1BsYXRmb3Jtcy9pUGhvbmVTaW11bGF0b3IucGxhdGZvcm0vRGV2ZWxvcGVyL1NES3MvaVBob25lU2ltdWxhdG9yLnNkay9TeXN0ZW0vTGlicmFyeS9MYXVuY2hEYWVtb25zJyk7XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgX2dldERldmljZVN0cmluZ1BsYXRmb3JtVmVyc2lvbiAocGxhdGZvcm1WZXJzaW9uKSB7XG4gICAgbGV0IHJlcVZlcnNpb24gPSBwbGF0Zm9ybVZlcnNpb247XG4gICAgaWYgKCFyZXFWZXJzaW9uKSB7XG4gICAgICByZXFWZXJzaW9uID0gYXdhaXQgeGNvZGUuZ2V0TWF4SU9TU0RLKCk7XG4gICAgICBsb2cud2FybihgTm8gcGxhdGZvcm0gdmVyc2lvbiBzZXQuIFVzaW5nIG1heCBTREsgdmVyc2lvbjogJHtyZXFWZXJzaW9ufWApO1xuICAgICAgLy8gdGhpcyB3aWxsIGJlIGEgbnVtYmVyLCBhbmQgcG9zc2libHkgYW4gaW50ZWdlciAoZS5nLiwgaWYgbWF4IGlPUyBTREsgaXMgOSlcbiAgICAgIC8vIHNvIHR1cm4gaXQgaW50byBhIHN0cmluZyBhbmQgYWRkIGEgLjAgaWYgbmVjZXNzYXJ5XG4gICAgICBpZiAoIV8uaXNTdHJpbmcocmVxVmVyc2lvbikpIHtcbiAgICAgICAgcmVxVmVyc2lvbiA9IChyZXFWZXJzaW9uICUgMSkgPyBTdHJpbmcocmVxVmVyc2lvbikgOiBgJHtyZXFWZXJzaW9ufS4wYDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcVZlcnNpb247XG4gIH1cblxuICAvLyBjaGFuZ2UgdGhlIGZvcm1hdCBpbiBzdWJjbGFzc2VzLCBhcyBuZWNlc3NhcnlcbiAgc3RhdGljIGFzeW5jIF9nZXREZXZpY2VTdHJpbmdWZXJzaW9uU3RyaW5nIChwbGF0Zm9ybVZlcnNpb24pIHtcbiAgICBsZXQgcmVxVmVyc2lvbiA9IGF3YWl0IHRoaXMuX2dldERldmljZVN0cmluZ1BsYXRmb3JtVmVyc2lvbihwbGF0Zm9ybVZlcnNpb24pO1xuXG4gICAgcmV0dXJuIGAoJHtyZXFWZXJzaW9ufSBTaW11bGF0b3IpYDtcbiAgfVxuXG4gIC8vIGNoYW5nZSB0aGUgZm9ybWF0IGluIHN1YmNsYXNzZXMsIGFzIG5lY2Vzc2FyeVxuICBzdGF0aWMgX2dldERldmljZVN0cmluZ0NvbmZpZ0ZpeCAoKSB7XG4gICAgLy8gc29tZSBkZXZpY2VzIG5lZWQgdG8gYmUgdXBkYXRlZFxuICAgIHJldHVybiB7XG4gICAgICAnaVBhZCBTaW11bGF0b3IgKDcuMSBTaW11bGF0b3IpJzogJ2lQYWQgMiAoNy4xIFNpbXVsYXRvciknLFxuICAgICAgJ2lQYWQgU2ltdWxhdG9yICg4LjAgU2ltdWxhdG9yKSc6ICdpUGFkIDIgKDguMCBTaW11bGF0b3IpJyxcbiAgICAgICdpUGFkIFNpbXVsYXRvciAoOC4xIFNpbXVsYXRvciknOiAnaVBhZCAyICg4LjEgU2ltdWxhdG9yKScsXG4gICAgICAnaVBhZCBTaW11bGF0b3IgKDguMiBTaW11bGF0b3IpJzogJ2lQYWQgMiAoOC4yIFNpbXVsYXRvciknLFxuICAgICAgJ2lQYWQgU2ltdWxhdG9yICg4LjMgU2ltdWxhdG9yKSc6ICdpUGFkIDIgKDguMyBTaW11bGF0b3IpJyxcbiAgICAgICdpUGFkIFNpbXVsYXRvciAoOC40IFNpbXVsYXRvciknOiAnaVBhZCAyICg4LjQgU2ltdWxhdG9yKScsXG4gICAgICAnaVBob25lIFNpbXVsYXRvciAoNy4xIFNpbXVsYXRvciknOiAnaVBob25lIDVzICg3LjEgU2ltdWxhdG9yKScsXG4gICAgICAnaVBob25lIFNpbXVsYXRvciAoOC40IFNpbXVsYXRvciknOiAnaVBob25lIDYgKDguNCBTaW11bGF0b3IpJyxcbiAgICAgICdpUGhvbmUgU2ltdWxhdG9yICg4LjMgU2ltdWxhdG9yKSc6ICdpUGhvbmUgNiAoOC4zIFNpbXVsYXRvciknLFxuICAgICAgJ2lQaG9uZSBTaW11bGF0b3IgKDguMiBTaW11bGF0b3IpJzogJ2lQaG9uZSA2ICg4LjIgU2ltdWxhdG9yKScsXG4gICAgICAnaVBob25lIFNpbXVsYXRvciAoOC4xIFNpbXVsYXRvciknOiAnaVBob25lIDYgKDguMSBTaW11bGF0b3IpJyxcbiAgICAgICdpUGhvbmUgU2ltdWxhdG9yICg4LjAgU2ltdWxhdG9yKSc6ICdpUGhvbmUgNiAoOC4wIFNpbXVsYXRvciknXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUYWtlcyBhIHNldCBvZiBvcHRpb25zIGFuZCBmaW5kcyB0aGUgY29ycmVjdCBkZXZpY2Ugc3RyaW5nIGluIG9yZGVyIGZvciBJbnN0cnVtZW50cyB0b1xuICAgKiBpZGVudGlmeSB0aGUgY29ycmVjdCBzaW11bGF0b3IuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gVGhlIG9wdGlvbnMgYXZhaWxhYmxlIGFyZTpcbiAgICogICAtIGBkZXZpY2VOYW1lYCAtIGEgbmFtZSBmb3IgdGhlIGRldmljZS4gSWYgdGhlIGdpdmVuIGRldmljZSBuYW1lIHN0YXJ0cyB3aXRoIGA9YCwgdGhlIG5hbWUsIGxlc3MgdGhlIGVxdWFscyBzaWduLCBpcyByZXR1cm5lZC5cbiAgICogICAtIGBwbGF0Zm9ybVZlcnNpb25gIC0gdGhlIHZlcnNpb24gb2YgaU9TIHRvIHVzZS4gRGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgWGNvZGUncyBtYXhpbXVtIFNESyB2ZXJzaW9uLlxuICAgKiAgIC0gYGZvcmNlSXBob25lYCAtIGZvcmNlIHRoZSBjb25maWd1cmF0aW9uIG9mIHRoZSBkZXZpY2Ugc3RyaW5nIHRvIGlQaG9uZS4gRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAgICogICAtIGBmb3JjZUlwYWRgIC0gZm9yY2UgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhlIGRldmljZSBzdHJpbmcgdG8gaVBhZC4gRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAgICogICBJZiBib3RoIGBmb3JjZUlwaG9uZWAgYW5kIGBmb3JjZUlwYWRgIGFyZSB0cnVlLCB0aGUgZGV2aWNlIHdpbGwgYmUgZm9yY2VkIHRvIGlQaG9uZS5cbiAgICpcbiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgZm91bmQgZGV2aWNlIHN0cmluZy5cbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXREZXZpY2VTdHJpbmcgKG9wdHMpIHtcbiAgICBvcHRzID0gT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgZGV2aWNlTmFtZTogbnVsbCxcbiAgICAgIHBsYXRmb3JtVmVyc2lvbjogbnVsbCxcbiAgICAgIGZvcmNlSXBob25lOiBmYWxzZSxcbiAgICAgIGZvcmNlSXBhZDogZmFsc2VcbiAgICB9LCBvcHRzKTtcbiAgICBsZXQgbG9nT3B0cyA9IHtcbiAgICAgIGRldmljZU5hbWU6IG9wdHMuZGV2aWNlTmFtZSxcbiAgICAgIHBsYXRmb3JtVmVyc2lvbjogb3B0cy5wbGF0Zm9ybVZlcnNpb24sXG4gICAgICBmb3JjZUlwaG9uZTogb3B0cy5mb3JjZUlwaG9uZSxcbiAgICAgIGZvcmNlSXBhZDogb3B0cy5mb3JjZUlwYWRcbiAgICB9O1xuICAgIGxvZy5kZWJ1ZyhgR2V0dGluZyBkZXZpY2Ugc3RyaW5nIGZyb20gb3B0aW9uczogJHtKU09OLnN0cmluZ2lmeShsb2dPcHRzKX1gKTtcblxuICAgIC8vIHNob3J0IGNpcmN1aXQgaWYgd2UgYWxyZWFkeSBoYXZlIGEgZGV2aWNlIG5hbWVcbiAgICBpZiAoKG9wdHMuZGV2aWNlTmFtZSB8fCAnJylbMF0gPT09ICc9Jykge1xuICAgICAgcmV0dXJuIG9wdHMuZGV2aWNlTmFtZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuXG4gICAgbGV0IGlzaVBob25lID0gISFvcHRzLmZvcmNlSXBob25lIHx8ICFvcHRzLmZvcmNlSXBhZDtcblxuICAgIGlmIChvcHRzLmRldmljZU5hbWUpIHtcbiAgICAgIGxldCBkZXZpY2UgPSBvcHRzLmRldmljZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmIChkZXZpY2UuaW5kZXhPZignaXBob25lJykgIT09IC0xKSB7XG4gICAgICAgIGlzaVBob25lID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAoZGV2aWNlLmluZGV4T2YoJ2lwYWQnKSAhPT0gLTEpIHtcbiAgICAgICAgaXNpUGhvbmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgaW9zRGV2aWNlU3RyaW5nID0gb3B0cy5kZXZpY2VOYW1lIHx8IChpc2lQaG9uZSA/ICdpUGhvbmUgU2ltdWxhdG9yJyA6ICdpUGFkIFNpbXVsYXRvcicpO1xuXG4gICAgLy8gaWYgc29tZW9uZSBwYXNzZXMgaW4ganVzdCBcImlQaG9uZVwiLCBtYWtlIHRoYXQgXCJpUGhvbmUgU2ltdWxhdG9yXCIgdG9cbiAgICAvLyBjb25mb3JtIHRvIGFsbCB0aGUgbG9naWMgYmVsb3dcbiAgICBpZiAoL14oaVBob25lfGlQYWQpJC8udGVzdChpb3NEZXZpY2VTdHJpbmcpKSB7XG4gICAgICBpb3NEZXZpY2VTdHJpbmcgKz0gXCIgU2ltdWxhdG9yXCI7XG4gICAgfVxuXG4gICAgLy8gd2Ugc3VwcG9ydCBkZXZpY2VOYW1lOiBcImlQaG9uZSBTaW11bGF0b3JcIiwgYW5kIGFsc28gd2FudCB0byBzdXBwb3J0XG4gICAgLy8gXCJpUGhvbmUgWFlaIFNpbXVsYXRvclwiLCBidXQgdGhlc2Ugc3RyaW5ncyBhcmVuJ3QgaW4gdGhlIGRldmljZSBsaXN0LlxuICAgIC8vIFNvLCBpZiBzb21lb25lIHNlbnQgaW4gXCJpUGhvbmUgWFlaIFNpbXVsYXRvclwiLCBzdHJpcCBvZmYgXCIgU2ltdWxhdG9yXCJcbiAgICAvLyBpbiBvcmRlciB0byBhbGxvdyB0aGUgZGVmYXVsdCBcImlQaG9uZSBYWVpcIiBtYXRjaFxuICAgIGlmICgvW14oaVBob25lfGlQYWQpXSBTaW11bGF0b3IvLnRlc3QoaW9zRGV2aWNlU3RyaW5nKSkge1xuICAgICAgaW9zRGV2aWNlU3RyaW5nID0gaW9zRGV2aWNlU3RyaW5nLnJlcGxhY2UoXCIgU2ltdWxhdG9yXCIsIFwiXCIpO1xuICAgIH1cbiAgICBpb3NEZXZpY2VTdHJpbmcgKz0gYCAke2F3YWl0IHRoaXMuX2dldERldmljZVN0cmluZ1ZlcnNpb25TdHJpbmcob3B0cy5wbGF0Zm9ybVZlcnNpb24pfWA7XG5cbiAgICBsZXQgQ09ORklHX0ZJWCA9IHRoaXMuX2dldERldmljZVN0cmluZ0NvbmZpZ0ZpeCgpO1xuXG4gICAgbGV0IGNvbmZpZ0ZpeCA9IENPTkZJR19GSVg7XG4gICAgaWYgKGNvbmZpZ0ZpeFtpb3NEZXZpY2VTdHJpbmddKSB7XG4gICAgICBpb3NEZXZpY2VTdHJpbmcgPSBjb25maWdGaXhbaW9zRGV2aWNlU3RyaW5nXTtcbiAgICAgIGxvZy5kZWJ1ZyhgRml4aW5nIGRldmljZS4gQ2hhbmdlZCBmcm9tICcke29wdHMuZGV2aWNlTmFtZX0nIGAgK1xuICAgICAgICAgICAgICAgIGB0byAnJHtpb3NEZXZpY2VTdHJpbmd9J2ApO1xuICAgIH1cblxuICAgIGxvZy5kZWJ1ZyhgRmluYWwgZGV2aWNlIHN0cmluZyBpcyAnJHtpb3NEZXZpY2VTdHJpbmd9J2ApO1xuICAgIHJldHVybiBpb3NEZXZpY2VTdHJpbmc7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7P3N0cmluZ30gVGhlIGZ1bGwgcGF0aCB0byB0aGUgc2ltdWxhdG9yJ3MgV2ViSW5zcGVjdG9yIFVuaXggRG9tYWluIFNvY2tldFxuICAgKiAgIG9yIGBudWxsYCBpZiB0aGVyZSBpcyBubyBzb2NrZXQuXG4gICAqL1xuICBhc3luYyBnZXRXZWJJbnNwZWN0b3JTb2NrZXQgKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtYXdhaXRcbiAgICAvLyB0aGVyZSBpcyBubyBXZWJJbnNwZWN0b3Igc29ja2V0IGZvciB0aGlzIHZlcnNpb24gb2YgWGNvZGVcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5mb3IgKGxldCBbY21kLCBmbl0gb2YgXy50b1BhaXJzKGV4dGVuc2lvbnMpKSB7XG4gIFNpbXVsYXRvclhjb2RlNi5wcm90b3R5cGVbY21kXSA9IGZuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBTaW11bGF0b3JYY29kZTY7XG5leHBvcnQgeyBTaW11bGF0b3JYY29kZTYsIEJPT1RfQ09NUExFVEVEX0VWRU5ULCBTUFJJTkdCT0FSRF9CVU5ETEVfSUQgfTtcbiJdLCJmaWxlIjoibGliL3NpbXVsYXRvci14Y29kZS02LmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
