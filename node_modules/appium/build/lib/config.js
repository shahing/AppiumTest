"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getBuildInfo = getBuildInfo;
exports.validateServerArgs = validateServerArgs;
exports.checkNodeOk = checkNodeOk;
exports.showConfig = showConfig;
exports.warnNodeDeprecations = warnNodeDeprecations;
exports.validateTmpDir = validateTmpDir;
exports.getNonDefaultArgs = getNonDefaultArgs;
exports.getDeprecatedArgs = getDeprecatedArgs;
exports.getGitRev = getGitRev;
exports.checkValidPort = checkValidPort;
exports.updateBuildInfo = updateBuildInfo;
exports.APPIUM_VER = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _appiumSupport = require("appium-support");

var _requestPromise = _interopRequireDefault(require("request-promise"));

var _teen_process = require("teen_process");

var _utils = require("./utils");

var _logger = _interopRequireDefault(require("./logger"));

const APPIUM_VER = require(_path.default.resolve(_utils.rootDir, 'package.json')).version;

exports.APPIUM_VER = APPIUM_VER;
const GIT_META_ROOT = '.git';
const GIT_BINARY = `git${_appiumSupport.system.isWindows() ? '.exe' : ''}`;
const GITHUB_API = 'https://api.github.com/repos/appium/appium';
const BUILD_INFO = {
  version: APPIUM_VER
};

function getNodeVersion() {
  let version = process.version.match(/^v(\d+)\.(\d+)/);
  return [Number(version[1]), Number(version[2])];
}

async function updateBuildInfo(useGithubApiFallback = false) {
  const sha = await getGitRev(useGithubApiFallback);

  if (!sha) {
    return;
  }

  BUILD_INFO['git-sha'] = sha;
  const built = await getGitTimestamp(sha, useGithubApiFallback);

  if (!_lodash.default.isEmpty(built)) {
    BUILD_INFO.built = built;
  }
}

async function getGitRev(useGithubApiFallback = false) {
  if (await _appiumSupport.fs.exists(_path.default.resolve(_utils.rootDir, GIT_META_ROOT))) {
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)(GIT_BINARY, ['rev-parse', 'HEAD'], {
        cwd: _utils.rootDir
      });
      return stdout.trim();
    } catch (ign) {}
  }

  if (!useGithubApiFallback) {
    return null;
  }

  try {
    const response = await _requestPromise.default.get(`${GITHUB_API}/tags`, {
      headers: {
        'User-Agent': `Appium ${APPIUM_VER}`
      }
    });

    const resBodyObj = _appiumSupport.util.safeJsonParse(response);

    if (_lodash.default.isArray(resBodyObj)) {
      for (const _ref of resBodyObj) {
        const {
          name,
          commit
        } = _ref;

        if (name === `v${APPIUM_VER}` && commit && commit.sha) {
          return commit.sha;
        }
      }
    }
  } catch (ign) {}

  return null;
}

async function getGitTimestamp(commitSha, useGithubApiFallback = false) {
  if (await _appiumSupport.fs.exists(_path.default.resolve(_utils.rootDir, GIT_META_ROOT))) {
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)(GIT_BINARY, ['show', '-s', '--format=%ci', commitSha], {
        cwd: _utils.rootDir
      });
      return stdout.trim();
    } catch (ign) {}
  }

  if (!useGithubApiFallback) {
    return null;
  }

  try {
    const response = await _requestPromise.default.get(`${GITHUB_API}/commits/${commitSha}`, {
      headers: {
        'User-Agent': `Appium ${APPIUM_VER}`
      }
    });

    const resBodyObj = _appiumSupport.util.safeJsonParse(response);

    if (resBodyObj && resBodyObj.commit) {
      if (resBodyObj.commit.committer && resBodyObj.commit.committer.date) {
        return resBodyObj.commit.committer.date;
      }

      if (resBodyObj.commit.author && resBodyObj.commit.author.date) {
        return resBodyObj.commit.author.date;
      }
    }
  } catch (ign) {}

  return null;
}

function getBuildInfo() {
  return BUILD_INFO;
}

function checkNodeOk() {
  let [major, minor] = getNodeVersion();

  if (major < 6) {
    let msg = `Node version must be >= 6. Currently ${major}.${minor}`;

    _logger.default.errorAndThrow(msg);
  }
}

function warnNodeDeprecations() {
  let [major] = getNodeVersion();

  if (major < 8) {
    _logger.default.warn("Appium support for versions of node < 8 has been " + "deprecated and will be removed in a future version. Please " + "upgrade!");
  }
}

async function showConfig() {
  await updateBuildInfo(true);
  console.log(JSON.stringify(getBuildInfo()));
}

function getNonDefaultArgs(parser, args) {
  let nonDefaults = {};

  for (let rawArg of parser.rawArgs) {
    let arg = rawArg[1].dest;

    if (args[arg] && args[arg] !== rawArg[1].defaultValue) {
      nonDefaults[arg] = args[arg];
    }
  }

  return nonDefaults;
}

function getDeprecatedArgs(parser, args) {
  let deprecated = {};

  for (let rawArg of parser.rawArgs) {
    let arg = rawArg[1].dest;
    let defaultValue = rawArg[1].defaultValue;
    let isDeprecated = !!rawArg[1].deprecatedFor;

    if (args[arg] && args[arg] !== defaultValue && isDeprecated) {
      deprecated[rawArg[0]] = rawArg[1].deprecatedFor;
    }
  }

  return deprecated;
}

function checkValidPort(port, portName) {
  if (port > 0 && port < 65536) return true;

  _logger.default.error(`Port '${portName}' must be greater than 0 and less than 65536. Currently ${port}`);

  return false;
}

function validateServerArgs(parser, args) {
  let exclusives = [['noReset', 'fullReset'], ['ipa', 'safari'], ['app', 'safari'], ['forceIphone', 'forceIpad'], ['deviceName', 'defaultDevice']];

  for (let exSet of exclusives) {
    let numFoundInArgs = 0;

    for (let opt of exSet) {
      if (_lodash.default.has(args, opt) && args[opt]) {
        numFoundInArgs++;
      }
    }

    if (numFoundInArgs > 1) {
      throw new Error(`You can't pass in more than one argument from the ` + `set ${JSON.stringify(exSet)}, since they are ` + `mutually exclusive`);
    }
  }

  const validations = {
    port: checkValidPort,
    callbackPort: checkValidPort,
    bootstrapPort: checkValidPort,
    selendroidPort: checkValidPort,
    chromedriverPort: checkValidPort,
    robotPort: checkValidPort,
    backendRetries: r => {
      return r >= 0;
    }
  };
  const nonDefaultArgs = getNonDefaultArgs(parser, args);

  for (let [arg, validator] of _lodash.default.toPairs(validations)) {
    if (_lodash.default.has(nonDefaultArgs, arg)) {
      if (!validator(args[arg], arg)) {
        throw new Error(`Invalid argument for param ${arg}: ${args[arg]}`);
      }
    }
  }
}

async function validateTmpDir(tmpDir) {
  try {
    await (0, _appiumSupport.mkdirp)(tmpDir);
  } catch (e) {
    throw new Error(`We could not ensure that the temp dir you specified ` + `(${tmpDir}) exists. Please make sure it's writeable.`);
  }
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb25maWcuanMiXSwibmFtZXMiOlsiQVBQSVVNX1ZFUiIsInJlcXVpcmUiLCJwYXRoIiwicmVzb2x2ZSIsInJvb3REaXIiLCJ2ZXJzaW9uIiwiR0lUX01FVEFfUk9PVCIsIkdJVF9CSU5BUlkiLCJzeXN0ZW0iLCJpc1dpbmRvd3MiLCJHSVRIVUJfQVBJIiwiQlVJTERfSU5GTyIsImdldE5vZGVWZXJzaW9uIiwicHJvY2VzcyIsIm1hdGNoIiwiTnVtYmVyIiwidXBkYXRlQnVpbGRJbmZvIiwidXNlR2l0aHViQXBpRmFsbGJhY2siLCJzaGEiLCJnZXRHaXRSZXYiLCJidWlsdCIsImdldEdpdFRpbWVzdGFtcCIsIl8iLCJpc0VtcHR5IiwiZnMiLCJleGlzdHMiLCJzdGRvdXQiLCJjd2QiLCJ0cmltIiwiaWduIiwicmVzcG9uc2UiLCJyZXF1ZXN0IiwiZ2V0IiwiaGVhZGVycyIsInJlc0JvZHlPYmoiLCJ1dGlsIiwic2FmZUpzb25QYXJzZSIsImlzQXJyYXkiLCJuYW1lIiwiY29tbWl0IiwiY29tbWl0U2hhIiwiY29tbWl0dGVyIiwiZGF0ZSIsImF1dGhvciIsImdldEJ1aWxkSW5mbyIsImNoZWNrTm9kZU9rIiwibWFqb3IiLCJtaW5vciIsIm1zZyIsImxvZ2dlciIsImVycm9yQW5kVGhyb3ciLCJ3YXJuTm9kZURlcHJlY2F0aW9ucyIsIndhcm4iLCJzaG93Q29uZmlnIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXROb25EZWZhdWx0QXJncyIsInBhcnNlciIsImFyZ3MiLCJub25EZWZhdWx0cyIsInJhd0FyZyIsInJhd0FyZ3MiLCJhcmciLCJkZXN0IiwiZGVmYXVsdFZhbHVlIiwiZ2V0RGVwcmVjYXRlZEFyZ3MiLCJkZXByZWNhdGVkIiwiaXNEZXByZWNhdGVkIiwiZGVwcmVjYXRlZEZvciIsImNoZWNrVmFsaWRQb3J0IiwicG9ydCIsInBvcnROYW1lIiwiZXJyb3IiLCJ2YWxpZGF0ZVNlcnZlckFyZ3MiLCJleGNsdXNpdmVzIiwiZXhTZXQiLCJudW1Gb3VuZEluQXJncyIsIm9wdCIsImhhcyIsIkVycm9yIiwidmFsaWRhdGlvbnMiLCJjYWxsYmFja1BvcnQiLCJib290c3RyYXBQb3J0Iiwic2VsZW5kcm9pZFBvcnQiLCJjaHJvbWVkcml2ZXJQb3J0Iiwicm9ib3RQb3J0IiwiYmFja2VuZFJldHJpZXMiLCJyIiwibm9uRGVmYXVsdEFyZ3MiLCJ2YWxpZGF0b3IiLCJ0b1BhaXJzIiwidmFsaWRhdGVUbXBEaXIiLCJ0bXBEaXIiLCJlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUNDLGNBQUtDLE9BQUwsQ0FBYUMsY0FBYixFQUFzQixjQUF0QixDQUFELENBQVAsQ0FBK0NDLE9BQWxFOzs7QUFDQSxNQUFNQyxhQUFhLEdBQUcsTUFBdEI7QUFDQSxNQUFNQyxVQUFVLEdBQUksTUFBS0Msc0JBQU9DLFNBQVAsS0FBcUIsTUFBckIsR0FBOEIsRUFBRyxFQUExRDtBQUNBLE1BQU1DLFVBQVUsR0FBRyw0Q0FBbkI7QUFDQSxNQUFNQyxVQUFVLEdBQUc7QUFDakJOLEVBQUFBLE9BQU8sRUFBRUw7QUFEUSxDQUFuQjs7QUFJQSxTQUFTWSxjQUFULEdBQTJCO0FBR3pCLE1BQUlQLE9BQU8sR0FBR1EsT0FBTyxDQUFDUixPQUFSLENBQWdCUyxLQUFoQixDQUFzQixnQkFBdEIsQ0FBZDtBQUNBLFNBQU8sQ0FBQ0MsTUFBTSxDQUFDVixPQUFPLENBQUMsQ0FBRCxDQUFSLENBQVAsRUFBcUJVLE1BQU0sQ0FBQ1YsT0FBTyxDQUFDLENBQUQsQ0FBUixDQUEzQixDQUFQO0FBQ0Q7O0FBRUQsZUFBZVcsZUFBZixDQUFnQ0Msb0JBQW9CLEdBQUcsS0FBdkQsRUFBOEQ7QUFDNUQsUUFBTUMsR0FBRyxHQUFHLE1BQU1DLFNBQVMsQ0FBQ0Ysb0JBQUQsQ0FBM0I7O0FBQ0EsTUFBSSxDQUFDQyxHQUFMLEVB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O0FBRWxCWSxJQUFBQSxZQUFZLEVBQUVaLGNBRkk7QUFHbEJhLElBQUFBLGFBQWEsRUFBRWIsY0FIRztBQUlsQmMsSUFBQUEsY0FBYyxFQUFFZCxjQUpFO0FBS2xCZSxJQUFBQSxnQkFBZ0IsRUFBRWYsY0FMQTtBQU1sQmdCLElBQUFBLFNBQVMsRUFBRWhCLGNBTk87QUFPbEJpQixJQUFBQSxjQUFjLEVBQUdDLENBQUQsSUFBTztBQUFFLGFBQU9BLENBQUMsSUFBSSxDQUFaO0FBQWdCO0FBUHZCLEdBQXBCO0FBVUEsUUFBTUMsY0FBYyxHQUFHaEMsaUJBQWlCLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxDQUF4Qzs7QUFFQSxPQUFLLElBQUksQ0FBQ0ksR0FBRCxFQUFNMkIsU0FBTixDQUFULElBQTZCckUsZ0JBQUVzRSxPQUFGLENBQVVWLFdBQVYsQ0FBN0IsRUFBcUQ7QUFDbkQsUUFBSTVELGdCQUFFMEQsR0FBRixDQUFNVSxjQUFOLEVBQXNCMUIsR0FBdEIsQ0FBSixFQUFnQztBQUM5QixVQUFJLENBQUMyQixTQUFTLENBQUMvQixJQUFJLENBQUNJLEdBQUQsQ0FBTCxFQUFZQSxHQUFaLENBQWQsRUFBZ0M7QUFDOUIsY0FBTSxJQUFJaUIsS0FBSixDQUFXLDhCQUE2QmpCLEdBQUksS0FBSUosSUFBSSxDQUFDSSxHQUFELENBQU0sRUFBMUQsQ0FBTjtBQUNEO0FBQ0Y7QUFDRjtBQUNGOztBQUVELGVBQWU2QixjQUFmLENBQStCQyxNQUEvQixFQUF1QztBQUNyQyxNQUFJO0FBQ0YsVUFBTSwyQkFBT0EsTUFBUCxDQUFOO0FBQ0QsR0FGRCxDQUVFLE9BQU9DLENBQVAsRUFBVTtBQUNWLFVBQU0sSUFBSWQsS0FBSixDQUFXLHNEQUFELEdBQ0MsSUFBR2EsTUFBTyw0Q0FEckIsQ0FBTjtBQUVEO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBta2RpcnAsIGZzLCBzeXN0ZW0sIHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgcmVxdWVzdCBmcm9tICdyZXF1ZXN0LXByb21pc2UnO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgeyByb290RGlyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4vbG9nZ2VyJztcblxuY29uc3QgQVBQSVVNX1ZFUiA9IHJlcXVpcmUocGF0aC5yZXNvbHZlKHJvb3REaXIsICdwYWNrYWdlLmpzb24nKSkudmVyc2lvbjtcbmNvbnN0IEdJVF9NRVRBX1JPT1QgPSAnLmdpdCc7XG5jb25zdCBHSVRfQklOQVJZID0gYGdpdCR7c3lzdGVtLmlzV2luZG93cygpID8gJy5leGUnIDogJyd9YDtcbmNvbnN0IEdJVEhVQl9BUEkgPSAnaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9hcHBpdW0vYXBwaXVtJztcbmNvbnN0IEJVSUxEX0lORk8gPSB7XG4gIHZlcnNpb246IEFQUElVTV9WRVIsXG59O1xuXG5mdW5jdGlvbiBnZXROb2RlVmVyc2lvbiAoKSB7XG4gIC8vIGV4cGVjdCB2PG1ham9yPi48bWlub3I+LjxwYXRjaD5cbiAgLy8gd2Ugd2lsbCBwdWxsIG91dCBgbWFqb3JgIGFuZCBgbWlub3JgXG4gIGxldCB2ZXJzaW9uID0gcHJvY2Vzcy52ZXJzaW9uLm1hdGNoKC9edihcXGQrKVxcLihcXGQrKS8pO1xuICByZXR1cm4gW051bWJlcih2ZXJzaW9uWzFdKSwgTnVtYmVyKHZlcnNpb25bMl0pXTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlQnVpbGRJbmZvICh1c2VHaXRodWJBcGlGYWxsYmFjayA9IGZhbHNlKSB7XG4gIGNvbnN0IHNoYSA9IGF3YWl0IGdldEdpdFJldih1c2VHaXRodWJBcGlGYWxsYmFjayk7XG4gIGlmICghc2hhKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIEJVSUxEX0lORk9bJ2dpdC1zaGEnXSA9IHNoYTtcbiAgY29uc3QgYnVpbHQgPSBhd2FpdCBnZXRHaXRUaW1lc3RhbXAoc2hhLCB1c2VHaXRodWJBcGlGYWxsYmFjayk7XG4gIGlmICghXy5pc0VtcHR5KGJ1aWx0KSkge1xuICAgIEJVSUxEX0lORk8uYnVpbHQgPSBidWlsdDtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRHaXRSZXYgKHVzZUdpdGh1YkFwaUZhbGxiYWNrID0gZmFsc2UpIHtcbiAgaWYgKGF3YWl0IGZzLmV4aXN0cyhwYXRoLnJlc29sdmUocm9vdERpciwgR0lUX01FVEFfUk9PVCkpKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhHSVRfQklOQVJZLCBbJ3Jldi1wYXJzZScsICdIRUFEJ10sIHtcbiAgICAgICAgY3dkOiByb290RGlyXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzdGRvdXQudHJpbSgpO1xuICAgIH0gY2F0Y2ggKGlnbikge31cbiAgfVxuXG4gIGlmICghdXNlR2l0aHViQXBpRmFsbGJhY2spIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0LmdldChgJHtHSVRIVUJfQVBJfS90YWdzYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnVXNlci1BZ2VudCc6IGBBcHBpdW0gJHtBUFBJVU1fVkVSfWBcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCByZXNCb2R5T2JqID0gdXRpbC5zYWZlSnNvblBhcnNlKHJlc3BvbnNlKTtcbiAgICBpZiAoXy5pc0FycmF5KHJlc0JvZHlPYmopKSB7XG4gICAgICBmb3IgKGNvbnN0IHtuYW1lLCBjb21taXR9IG9mIHJlc0JvZHlPYmopIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IGB2JHtBUFBJVU1fVkVSfWAgJiYgY29tbWl0ICYmIGNvbW1pdC5zaGEpIHtcbiAgICAgICAgICByZXR1cm4gY29tbWl0LnNoYTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoaWduKSB7fVxuICByZXR1cm4gbnVsbDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0R2l0VGltZXN0YW1wIChjb21taXRTaGEsIHVzZUdpdGh1YkFwaUZhbGxiYWNrID0gZmFsc2UpIHtcbiAgaWYgKGF3YWl0IGZzLmV4aXN0cyhwYXRoLnJlc29sdmUocm9vdERpciwgR0lUX01FVEFfUk9PVCkpKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhHSVRfQklOQVJZLCBbJ3Nob3cnLCAnLXMnLCAnLS1mb3JtYXQ9JWNpJywgY29tbWl0U2hhXSwge1xuICAgICAgICBjd2Q6IHJvb3REaXJcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHN0ZG91dC50cmltKCk7XG4gICAgfSBjYXRjaCAoaWduKSB7fVxuICB9XG5cbiAgaWYgKCF1c2VHaXRodWJBcGlGYWxsYmFjaykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QuZ2V0KGAke0dJVEhVQl9BUEl9L2NvbW1pdHMvJHtjb21taXRTaGF9YCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnVXNlci1BZ2VudCc6IGBBcHBpdW0gJHtBUFBJVU1fVkVSfWBcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCByZXNCb2R5T2JqID0gdXRpbC5zYWZlSnNvblBhcnNlKHJlc3BvbnNlKTtcbiAgICBpZiAocmVzQm9keU9iaiAmJiByZXNCb2R5T2JqLmNvbW1pdCkge1xuICAgICAgaWYgKHJlc0JvZHlPYmouY29tbWl0LmNvbW1pdHRlciAmJiByZXNCb2R5T2JqLmNvbW1pdC5jb21taXR0ZXIuZGF0ZSkge1xuICAgICAgICByZXR1cm4gcmVzQm9keU9iai5jb21taXQuY29tbWl0dGVyLmRhdGU7XG4gICAgICB9XG4gICAgICBpZiAocmVzQm9keU9iai5jb21taXQuYXV0aG9yICYmIHJlc0JvZHlPYmouY29tbWl0LmF1dGhvci5kYXRlKSB7XG4gICAgICAgIHJldHVybiByZXNCb2R5T2JqLmNvbW1pdC5hdXRob3IuZGF0ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGlnbikge31cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQHJldHVybnMgTXV0YWJsZSBvYmplY3QgY29udGFpbmluZyBBcHBpdW0gYnVpbGQgaW5mb3JtYXRpb24uIEJ5IGRlZmF1bHQgaXRcbiAqIG9ubHkgY29udGFpbnMgdGhlIEFwcGl1bSB2ZXJzaW9uLCBidXQgaXMgdXBkYXRlZCB3aXRoIHRoZSBidWlsZCB0aW1lc3RhbXBcbiAqIGFuZCBnaXQgY29tbWl0IGhhc2ggYXN5bmNocm9ub3VzbHkgYXMgc29vbiBhcyBgdXBkYXRlQnVpbGRJbmZvYCBpcyBjYWxsZWRcbiAqIGFuZCBzdWNjZWVkcy5cbiAqL1xuZnVuY3Rpb24gZ2V0QnVpbGRJbmZvICgpIHtcbiAgcmV0dXJuIEJVSUxEX0lORk87XG59XG5cbmZ1bmN0aW9uIGNoZWNrTm9kZU9rICgpIHtcbiAgbGV0IFttYWpvciwgbWlub3JdID0gZ2V0Tm9kZVZlcnNpb24oKTtcbiAgaWYgKG1ham9yIDwgNikge1xuICAgIGxldCBtc2cgPSBgTm9kZSB2ZXJzaW9uIG11c3QgYmUgPj0gNi4gQ3VycmVudGx5ICR7bWFqb3J9LiR7bWlub3J9YDtcbiAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhtc2cpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHdhcm5Ob2RlRGVwcmVjYXRpb25zICgpIHtcbiAgbGV0IFttYWpvcl0gPSBnZXROb2RlVmVyc2lvbigpO1xuICBpZiAobWFqb3IgPCA4KSB7XG4gICAgbG9nZ2VyLndhcm4oXCJBcHBpdW0gc3VwcG9ydCBmb3IgdmVyc2lvbnMgb2Ygbm9kZSA8IDggaGFzIGJlZW4gXCIgK1xuICAgICAgICAgICAgICAgIFwiZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24uIFBsZWFzZSBcIiArXG4gICAgICAgICAgICAgICAgXCJ1cGdyYWRlIVwiKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBzaG93Q29uZmlnICgpIHtcbiAgYXdhaXQgdXBkYXRlQnVpbGRJbmZvKHRydWUpO1xuICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShnZXRCdWlsZEluZm8oKSkpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbn1cblxuZnVuY3Rpb24gZ2V0Tm9uRGVmYXVsdEFyZ3MgKHBhcnNlciwgYXJncykge1xuICBsZXQgbm9uRGVmYXVsdHMgPSB7fTtcbiAgZm9yIChsZXQgcmF3QXJnIG9mIHBhcnNlci5yYXdBcmdzKSB7XG4gICAgbGV0IGFyZyA9IHJhd0FyZ1sxXS5kZXN0O1xuICAgIGlmIChhcmdzW2FyZ10gJiYgYXJnc1thcmddICE9PSByYXdBcmdbMV0uZGVmYXVsdFZhbHVlKSB7XG4gICAgICBub25EZWZhdWx0c1thcmddID0gYXJnc1thcmddO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbm9uRGVmYXVsdHM7XG59XG5cbmZ1bmN0aW9uIGdldERlcHJlY2F0ZWRBcmdzIChwYXJzZXIsIGFyZ3MpIHtcbiAgLy8gZ28gdGhyb3VnaCB0aGUgc2VydmVyIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgYW5kIGZpZ3VyZVxuICAvLyBvdXQgd2hpY2ggb2YgdGhlIG9uZXMgdXNlZCBhcmUgZGVwcmVjYXRlZFxuICBsZXQgZGVwcmVjYXRlZCA9IHt9O1xuICBmb3IgKGxldCByYXdBcmcgb2YgcGFyc2VyLnJhd0FyZ3MpIHtcbiAgICBsZXQgYXJnID0gcmF3QXJnWzFdLmRlc3Q7XG4gICAgbGV0IGRlZmF1bHRWYWx1ZSA9IHJhd0FyZ1sxXS5kZWZhdWx0VmFsdWU7XG4gICAgbGV0IGlzRGVwcmVjYXRlZCA9ICEhcmF3QXJnWzFdLmRlcHJlY2F0ZWRGb3I7XG4gICAgaWYgKGFyZ3NbYXJnXSAmJiBhcmdzW2FyZ10gIT09IGRlZmF1bHRWYWx1ZSAmJiBpc0RlcHJlY2F0ZWQpIHtcbiAgICAgIGRlcHJlY2F0ZWRbcmF3QXJnWzBdXSA9IHJhd0FyZ1sxXS5kZXByZWNhdGVkRm9yO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGVwcmVjYXRlZDtcbn1cblxuZnVuY3Rpb24gY2hlY2tWYWxpZFBvcnQgKHBvcnQsIHBvcnROYW1lKSB7XG4gIGlmIChwb3J0ID4gMCAmJiBwb3J0IDwgNjU1MzYpIHJldHVybiB0cnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gIGxvZ2dlci5lcnJvcihgUG9ydCAnJHtwb3J0TmFtZX0nIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAgYW5kIGxlc3MgdGhhbiA2NTUzNi4gQ3VycmVudGx5ICR7cG9ydH1gKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVNlcnZlckFyZ3MgKHBhcnNlciwgYXJncykge1xuICAvLyBhcmd1bWVudHMgdGhhdCBjYW5ub3QgYm90aCBiZSBzZXRcbiAgbGV0IGV4Y2x1c2l2ZXMgPSBbXG4gICAgWydub1Jlc2V0JywgJ2Z1bGxSZXNldCddLFxuICAgIFsnaXBhJywgJ3NhZmFyaSddLFxuICAgIFsnYXBwJywgJ3NhZmFyaSddLFxuICAgIFsnZm9yY2VJcGhvbmUnLCAnZm9yY2VJcGFkJ10sXG4gICAgWydkZXZpY2VOYW1lJywgJ2RlZmF1bHREZXZpY2UnXVxuICBdO1xuXG4gIGZvciAobGV0IGV4U2V0IG9mIGV4Y2x1c2l2ZXMpIHtcbiAgICBsZXQgbnVtRm91bmRJbkFyZ3MgPSAwO1xuICAgIGZvciAobGV0IG9wdCBvZiBleFNldCkge1xuICAgICAgaWYgKF8uaGFzKGFyZ3MsIG9wdCkgJiYgYXJnc1tvcHRdKSB7XG4gICAgICAgIG51bUZvdW5kSW5BcmdzKys7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChudW1Gb3VuZEluQXJncyA+IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgWW91IGNhbid0IHBhc3MgaW4gbW9yZSB0aGFuIG9uZSBhcmd1bWVudCBmcm9tIHRoZSBgICtcbiAgICAgICAgICAgICAgICAgICAgICBgc2V0ICR7SlNPTi5zdHJpbmdpZnkoZXhTZXQpfSwgc2luY2UgdGhleSBhcmUgYCArXG4gICAgICAgICAgICAgICAgICAgICAgYG11dHVhbGx5IGV4Y2x1c2l2ZWApO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHZhbGlkYXRpb25zID0ge1xuICAgIHBvcnQ6IGNoZWNrVmFsaWRQb3J0LFxuICAgIGNhbGxiYWNrUG9ydDogY2hlY2tWYWxpZFBvcnQsXG4gICAgYm9vdHN0cmFwUG9ydDogY2hlY2tWYWxpZFBvcnQsXG4gICAgc2VsZW5kcm9pZFBvcnQ6IGNoZWNrVmFsaWRQb3J0LFxuICAgIGNocm9tZWRyaXZlclBvcnQ6IGNoZWNrVmFsaWRQb3J0LFxuICAgIHJvYm90UG9ydDogY2hlY2tWYWxpZFBvcnQsXG4gICAgYmFja2VuZFJldHJpZXM6IChyKSA9PiB7IHJldHVybiByID49IDA7IH1cbiAgfTtcblxuICBjb25zdCBub25EZWZhdWx0QXJncyA9IGdldE5vbkRlZmF1bHRBcmdzKHBhcnNlciwgYXJncyk7XG5cbiAgZm9yIChsZXQgW2FyZywgdmFsaWRhdG9yXSBvZiBfLnRvUGFpcnModmFsaWRhdGlvbnMpKSB7XG4gICAgaWYgKF8uaGFzKG5vbkRlZmF1bHRBcmdzLCBhcmcpKSB7XG4gICAgICBpZiAoIXZhbGlkYXRvcihhcmdzW2FyZ10sIGFyZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGFyZ3VtZW50IGZvciBwYXJhbSAke2FyZ306ICR7YXJnc1thcmddfWApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVRtcERpciAodG1wRGlyKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgbWtkaXJwKHRtcERpcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFdlIGNvdWxkIG5vdCBlbnN1cmUgdGhhdCB0aGUgdGVtcCBkaXIgeW91IHNwZWNpZmllZCBgICtcbiAgICAgICAgICAgICAgICAgICAgYCgke3RtcERpcn0pIGV4aXN0cy4gUGxlYXNlIG1ha2Ugc3VyZSBpdCdzIHdyaXRlYWJsZS5gKTtcbiAgfVxufVxuXG5leHBvcnQge1xuICBnZXRCdWlsZEluZm8sIHZhbGlkYXRlU2VydmVyQXJncywgY2hlY2tOb2RlT2ssIHNob3dDb25maWcsXG4gIHdhcm5Ob2RlRGVwcmVjYXRpb25zLCB2YWxpZGF0ZVRtcERpciwgZ2V0Tm9uRGVmYXVsdEFyZ3MsIGdldERlcHJlY2F0ZWRBcmdzLFxuICBnZXRHaXRSZXYsIGNoZWNrVmFsaWRQb3J0LCBBUFBJVU1fVkVSLCB1cGRhdGVCdWlsZEluZm8sXG59O1xuIl0sImZpbGUiOiJsaWIvY29uZmlnLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
